\documentclass[11pt]{article}

    \usepackage[breakable]{tcolorbox}
    \usepackage{parskip} % Stop auto-indenting (to mimic markdown behaviour)
    
    \usepackage{iftex}
    \ifPDFTeX
    	\usepackage[T1]{fontenc}
    	\usepackage{mathpazo}
    \else
    	\usepackage{fontspec}
    \fi

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % Maintain compatibility with old templates. Remove in nbconvert 6.0
    \let\Oldincludegraphics\includegraphics
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionFormat{nocaption}{}
    \captionsetup{format=nocaption,aboveskip=0pt,belowskip=0pt}

    \usepackage[Export]{adjustbox} % Used to constrain images to a maximum size
    \adjustboxset{max size={0.9\linewidth}{0.9\paperheight}}
    \usepackage{float}
    \floatplacement{figure}{H} % forces figures to be placed at the correct location
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range
    \makeatletter % fix for grffile with XeLaTeX
    \def\Gread@@xetex#1{%
      \IfFileExists{"\Gin@base".bb}%
      {\Gread@eps{\Gin@base.bb}}%
      {\Gread@@xetex@aux#1}%
    }
    \makeatother

    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    % The default LaTeX title has an obnoxious amount of whitespace. By default,
    % titling removes some of it. It also provides customization options.
    \usepackage{titling}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    \usepackage{mathrsfs}
    

    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}
    \definecolor{ansi-default-inverse-fg}{HTML}{FFFFFF}
    \definecolor{ansi-default-inverse-bg}{HTML}{000000}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatibility definitions
    \def\gt{>}
    \def\lt{<}
    \let\Oldtex\TeX
    \let\Oldlatex\LaTeX
    \renewcommand{\TeX}{\textrm{\Oldtex}}
    \renewcommand{\LaTeX}{\textrm{\Oldlatex}}
    % Document parameters
    % Document title
    \title{datacell\_request\_time\_final}
    
    
    
    
    
% Pygments definitions
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % For linebreaks inside Verbatim environment from package fancyvrb. 
    \makeatletter
        \newbox\Wrappedcontinuationbox 
        \newbox\Wrappedvisiblespacebox 
        \newcommand*\Wrappedvisiblespace {\textcolor{red}{\textvisiblespace}} 
        \newcommand*\Wrappedcontinuationsymbol {\textcolor{red}{\llap{\tiny$\m@th\hookrightarrow$}}} 
        \newcommand*\Wrappedcontinuationindent {3ex } 
        \newcommand*\Wrappedafterbreak {\kern\Wrappedcontinuationindent\copy\Wrappedcontinuationbox} 
        % Take advantage of the already applied Pygments mark-up to insert 
        % potential linebreaks for TeX processing. 
        %        {, <, #, %, $, ' and ": go to next line. 
        %        _, }, ^, &, >, - and ~: stay at end of broken line. 
        % Use of \textquotesingle for straight quote. 
        \newcommand*\Wrappedbreaksatspecials {% 
            \def\PYGZus{\discretionary{\char`\_}{\Wrappedafterbreak}{\char`\_}}% 
            \def\PYGZob{\discretionary{}{\Wrappedafterbreak\char`\{}{\char`\{}}% 
            \def\PYGZcb{\discretionary{\char`\}}{\Wrappedafterbreak}{\char`\}}}% 
            \def\PYGZca{\discretionary{\char`\^}{\Wrappedafterbreak}{\char`\^}}% 
            \def\PYGZam{\discretionary{\char`\&}{\Wrappedafterbreak}{\char`\&}}% 
            \def\PYGZlt{\discretionary{}{\Wrappedafterbreak\char`\<}{\char`\<}}% 
            \def\PYGZgt{\discretionary{\char`\>}{\Wrappedafterbreak}{\char`\>}}% 
            \def\PYGZsh{\discretionary{}{\Wrappedafterbreak\char`\#}{\char`\#}}% 
            \def\PYGZpc{\discretionary{}{\Wrappedafterbreak\char`\%}{\char`\%}}% 
            \def\PYGZdl{\discretionary{}{\Wrappedafterbreak\char`\$}{\char`\$}}% 
            \def\PYGZhy{\discretionary{\char`\-}{\Wrappedafterbreak}{\char`\-}}% 
            \def\PYGZsq{\discretionary{}{\Wrappedafterbreak\textquotesingle}{\textquotesingle}}% 
            \def\PYGZdq{\discretionary{}{\Wrappedafterbreak\char`\"}{\char`\"}}% 
            \def\PYGZti{\discretionary{\char`\~}{\Wrappedafterbreak}{\char`\~}}% 
        } 
        % Some characters . , ; ? ! / are not pygmentized. 
        % This macro makes them "active" and they will insert potential linebreaks 
        \newcommand*\Wrappedbreaksatpunct {% 
            \lccode`\~`\.\lowercase{\def~}{\discretionary{\hbox{\char`\.}}{\Wrappedafterbreak}{\hbox{\char`\.}}}% 
            \lccode`\~`\,\lowercase{\def~}{\discretionary{\hbox{\char`\,}}{\Wrappedafterbreak}{\hbox{\char`\,}}}% 
            \lccode`\~`\;\lowercase{\def~}{\discretionary{\hbox{\char`\;}}{\Wrappedafterbreak}{\hbox{\char`\;}}}% 
            \lccode`\~`\:\lowercase{\def~}{\discretionary{\hbox{\char`\:}}{\Wrappedafterbreak}{\hbox{\char`\:}}}% 
            \lccode`\~`\?\lowercase{\def~}{\discretionary{\hbox{\char`\?}}{\Wrappedafterbreak}{\hbox{\char`\?}}}% 
            \lccode`\~`\!\lowercase{\def~}{\discretionary{\hbox{\char`\!}}{\Wrappedafterbreak}{\hbox{\char`\!}}}% 
            \lccode`\~`\/\lowercase{\def~}{\discretionary{\hbox{\char`\/}}{\Wrappedafterbreak}{\hbox{\char`\/}}}% 
            \catcode`\.\active
            \catcode`\,\active 
            \catcode`\;\active
            \catcode`\:\active
            \catcode`\?\active
            \catcode`\!\active
            \catcode`\/\active 
            \lccode`\~`\~ 	
        }
    \makeatother

    \let\OriginalVerbatim=\Verbatim
    \makeatletter
    \renewcommand{\Verbatim}[1][1]{%
        %\parskip\z@skip
        \sbox\Wrappedcontinuationbox {\Wrappedcontinuationsymbol}%
        \sbox\Wrappedvisiblespacebox {\FV@SetupFont\Wrappedvisiblespace}%
        \def\FancyVerbFormatLine ##1{\hsize\linewidth
            \vtop{\raggedright\hyphenpenalty\z@\exhyphenpenalty\z@
                \doublehyphendemerits\z@\finalhyphendemerits\z@
                \strut ##1\strut}%
        }%
        % If the linebreak is at a space, the latter will be displayed as visible
        % space at end of first line, and a continuation symbol starts next line.
        % Stretch/shrink are however usually zero for typewriter font.
        \def\FV@Space {%
            \nobreak\hskip\z@ plus\fontdimen3\font minus\fontdimen4\font
            \discretionary{\copy\Wrappedvisiblespacebox}{\Wrappedafterbreak}
            {\kern\fontdimen2\font}%
        }%
        
        % Allow breaks at special characters using \PYG... macros.
        \Wrappedbreaksatspecials
        % Breaks at punctuation characters . , ; ? ! and / need catcode=\active 	
        \OriginalVerbatim[#1,codes*=\Wrappedbreaksatpunct]%
    }
    \makeatother

    % Exact colors from NB
    \definecolor{incolor}{HTML}{303F9F}
    \definecolor{outcolor}{HTML}{D84315}
    \definecolor{cellborder}{HTML}{CFCFCF}
    \definecolor{cellbackground}{HTML}{F7F7F7}
    
    % prompt
    \makeatletter
    \newcommand{\boxspacing}{\kern\kvtcb@left@rule\kern\kvtcb@boxsep}
    \makeatother
    \newcommand{\prompt}[4]{
        \ttfamily\llap{{\color{#2}[#3]:\hspace{3pt}#4}}\vspace{-\baselineskip}
    }
    

    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

\begin{document}
    
    \maketitle
    
    

    
    \section{Navigating This Notebook}\label{navigating-this-notebook}

    The following text stylings applied to cell descriptions indicate what
you should do with the corresponding code cells.

Execute Cell:

Markdown cells in \textbf{bold text and default size} indicate that you
should execute the cell below it. EXAMPLE:

~~~~~~\textbf{Rerun this cell with a new date range/s to RESET DATA:}

Many other cells should be run, but the most important and ones most
likely to be rerun will be denoted with a bold title cell as shown
above.

The notebook will be broken up into \textbf{definitions cells} and
\textbf{execution cells}. Definiton cells can be run once at the start
of each new kernel session, execution cells must be reloaded each time
you want to reset a dataframe or a figure. Execution cells will be
indicated by the above notation.

    \section{Initial Setup}\label{initial-setup}

    \emph{Developer NOTE:} you can experiment with turning matplotlib inline
on and off, it doesn't seem to have an effect as I think Seaborn is
automatically running show() on each of the plots. But turning it on
won't hurt.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{58}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} Turn on inline display of plots in the notebook. (We should work on a more}
\PY{c+c1}{\PYZsh{} portable solution such as saving the plots to files down the road.)}
\PY{o}{\PYZpc{}}\PY{k}{matplotlib} inline
\end{Verbatim}
\end{tcolorbox}

    \subsection{Create a connection
function}\label{create-a-connection-function}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{2}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import} \PY{n+nn}{pyodbc}

\PY{c+c1}{\PYZsh{} Connect via Windows authentication:}
\PY{c+c1}{\PYZsh{} conn\PYZus{}specs = (\PYZsq{}DRIVER=\PYZob{}ODBC Driver 17 for SQL Server\PYZcb{};\PYZsq{}}
\PY{c+c1}{\PYZsh{}                                     + \PYZsq{}SERVER=scotty\PYZhy{}test;\PYZsq{}}
\PY{c+c1}{\PYZsh{}                                     + \PYZsq{}DATABASE=Interject\PYZus{}Reporting;\PYZsq{}}
\PY{c+c1}{\PYZsh{}                                    + \PYZsq{}trusted\PYZus{}connection=yes;\PYZsq{})}
\PY{c+c1}{\PYZsh{} conn\PYZus{}str = \PYZsq{}mssql+pyodbc:///?odbc\PYZus{}connect=\PYZob{}\PYZcb{}\PYZsq{}.format(conn\PYZus{}specs)}
\PY{c+c1}{\PYZsh{} engine = sqla.create\PYZus{}engine(conn\PYZus{}str)}

\PY{c+c1}{\PYZsh{} Define a function that we can use to connect to a db on the fly:}
\PY{k}{def} \PY{n+nf}{pyodbc\PYZus{}connect\PYZus{}scotty\PYZus{}test}\PY{p}{(}\PY{n}{db\PYZus{}name}\PY{p}{)}\PY{p}{:}
    \PY{k}{try}\PY{p}{:}
        \PY{n}{connection} \PY{o}{=} \PY{n}{pyodbc}\PY{o}{.}\PY{n}{connect}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DRIVER=}\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{ODBC Driver 17 for SQL Server\PYZcb{};}\PY{l+s+s1}{\PYZsq{}}
                                        \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SERVER=scotty\PYZhy{}test;}\PY{l+s+s1}{\PYZsq{}}
                                        \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DATABASE=}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n}{db\PYZus{}name} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{;}\PY{l+s+s1}{\PYZsq{}}
                                       \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{trusted\PYZus{}connection=yes;}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{} Windows auth}
        \PY{k}{return} \PY{n}{connection}
    \PY{k}{except}\PY{p}{:}
        \PY{k}{return} \PY{l+m+mi}{1} \PY{c+c1}{\PYZsh{} could not connect}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{3}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
\end{Verbatim}
\end{tcolorbox}

    \subsection{Create a function to load requests data for specific years
from SQL
DB}\label{create-a-function-to-load-requests-data-for-specific-years-from-sql-db}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{4}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
\PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
\end{Verbatim}
\end{tcolorbox}

    Filter years to select data:

    \emph{Developer NOTE:} performance may be improved accross the entire
notebook by first importing the data from the SQL DB into "pure python"
(instead of directly into a pandas dataframe) using pyodbc and putting
the data first in a numpy matrix (or possibly JSON obj), then using the
numpy matrix to create pandas dataframes later as they are needed. This
would help because Numpy is written in C and it highly optimized for
large amounts of data.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{13}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{read\PYZus{}sql\PYZus{}requests\PYZus{}by\PYZus{}year}\PY{p}{(}\PY{n}{start\PYZus{}year}\PY{p}{:} \PY{n+nb}{int}\PY{p}{,} \PY{n}{end\PYZus{}year}\PY{p}{:} \PY{n+nb}{int}\PY{p}{,} \PY{n}{schema\PYZus{}name}\PY{p}{:} \PY{n+nb}{str}\PY{p}{,} \PY{n}{table\PYZus{}name\PYZus{}1}\PY{p}{:} \PY{n+nb}{str}\PY{p}{,} \PY{n}{table\PYZus{}name\PYZus{}2}\PY{p}{:} \PY{n+nb}{str}\PY{p}{)} \PY{o}{\PYZhy{}}\PY{o}{\PYZgt{}} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{:}

    \PY{n}{sql} \PY{o}{=} \PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SELECT}\PY{l+s+s1}{\PYZsq{}}
                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ [StartTimeStamp]}\PY{l+s+s1}{\PYZsq{}}
                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ ,DATEDIFF(second, [StartTimeStamp], [EndTimeStamp]) AS Duration}\PY{l+s+s1}{\PYZsq{}}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ FROM [}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n}{schema\PYZus{}name} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{].[}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n}{table\PYZus{}name\PYZus{}1} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{]}\PY{l+s+s1}{\PYZsq{}}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ UNION ALL}\PY{l+s+s1}{\PYZsq{}}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ SELECT}\PY{l+s+s1}{\PYZsq{}}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ [StartTimeStamp]}\PY{l+s+s1}{\PYZsq{}}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ ,DATEDIFF(second, [StartTimeStamp], [EndTimeStamp]) AS Duration}\PY{l+s+s1}{\PYZsq{}}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ FROM [}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n}{schema\PYZus{}name} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{].[}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n}{table\PYZus{}name\PYZus{}2} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{]}\PY{l+s+s1}{\PYZsq{}}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ WHERE (SUBSTRING(CONVERT(NVARCHAR(10), [StartTimeStamp], 102), 1, 4) BETWEEN }\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{start\PYZus{}year}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ AND }\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{end\PYZus{}year}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{)}\PY{l+s+s1}{\PYZsq{}}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ AND ([StartTimeStamp] \PYZlt{} [EndTimeStamp])}\PY{l+s+s1}{\PYZsq{}}  \PY{c+c1}{\PYZsh{} Eliminate the possibility of negative durations}
          \PY{p}{)}

    \PY{n}{requests} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}sql}\PY{p}{(}\PY{n}{sql}\PY{p}{,} \PY{n}{reporting\PYZus{}conn}\PY{p}{,} \PY{n}{index\PYZus{}col}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{StartTimeStamp}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{c+c1}{\PYZsh{}requests.t}
    \PY{k}{return} \PY{n}{requests}
\end{Verbatim}
\end{tcolorbox}

    \textbf{Set the following variables to the location (database, schema,
tables) of your DataCell request data:}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{14}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{reporting\PYZus{}conn} \PY{o}{=} \PY{n}{pyodbc\PYZus{}connect\PYZus{}scotty\PYZus{}test}\PY{p}{(}
    \PY{n}{db\PYZus{}name} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Interject\PYZus{}Reporting}\PY{l+s+s1}{\PYZsq{}}
\PY{p}{)}

\PY{n}{schema} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{test}\PY{l+s+s1}{\PYZsq{}}
\PY{c+c1}{\PYZsh{} Set this to the name of the table containing recent DataCell request data:}
\PY{n}{table\PYZus{}recent} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Request}\PY{l+s+s1}{\PYZsq{}}
\PY{c+c1}{\PYZsh{} Set this to the name of the table containing historical DataCell request data:}
\PY{n}{table\PYZus{}hist} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Request\PYZus{}History}\PY{l+s+s1}{\PYZsq{}}
\end{Verbatim}
\end{tcolorbox}

    \subsection{Create functions to create the 2 basis
DataFrames}\label{create-functions-to-create-the-2-basis-dataframes}

    The following two functions work together to bring the data from the SQL
database connection to the dataframes. The first brings only the raw
request data (Duration and a StartTimeStamp index) into a pandas
DataFrame, and the second brings in this plus some extra DF columns with
integers representing Year, Month, Day, Week and a string containing
Weekday name.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{15}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{get\PYZus{}df\PYZus{}requests\PYZus{}from\PYZus{}db}\PY{p}{(}\PY{n}{start\PYZus{}year}\PY{p}{:} \PY{n+nb}{int}\PY{p}{,} \PY{n}{end\PYZus{}year}\PY{p}{:} \PY{n+nb}{int}\PY{p}{)} \PY{o}{\PYZhy{}}\PY{o}{\PYZgt{}} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{:}
    \PY{l+s+sd}{\PYZsq{}\PYZsq{}\PYZsq{} Reload the raw request data (StartTimeStamp (DF index) and Duration) from SQL DB into a}
\PY{l+s+sd}{        DataFrame, for a given year range. \PYZsq{}\PYZsq{}\PYZsq{}}
    
    \PY{n}{requests} \PY{o}{=} \PY{n}{read\PYZus{}sql\PYZus{}requests\PYZus{}by\PYZus{}year}\PY{p}{(}\PY{n}{start\PYZus{}year}\PY{p}{,} \PY{n}{end\PYZus{}year}\PY{p}{,} \PY{n}{schema}\PY{p}{,} \PY{n}{table\PYZus{}recent}\PY{p}{,} \PY{n}{table\PYZus{}hist}\PY{p}{)}
    \PY{n}{requests}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}  \PY{c+c1}{\PYZsh{} Make sure this is what we want}
    
    \PY{c+c1}{\PYZsh{} Decrease memory usage for requests:}
    \PY{n}{requests}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{requests}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{float32}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    
    \PY{k}{return} \PY{n}{requests}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{16}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{get\PYZus{}df\PYZus{}requests\PYZus{}with\PYZus{}date\PYZus{}cols\PYZus{}from\PYZus{}db}\PY{p}{(}\PY{n}{start\PYZus{}year}\PY{p}{:} \PY{n+nb}{int}\PY{p}{,} \PY{n}{end\PYZus{}year}\PY{p}{:} \PY{n+nb}{int}\PY{p}{)} \PY{o}{\PYZhy{}}\PY{o}{\PYZgt{}} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{:}
    \PY{l+s+sd}{\PYZsq{}\PYZsq{}\PYZsq{} Reload the request data (StartTimeStamp (DF index) and Duration) from SQL DB into a}
\PY{l+s+sd}{        DataFrame, and add useful date columns Year, Month, Week, Weekday. Within a specified}
\PY{l+s+sd}{        year range. \PYZsq{}\PYZsq{}\PYZsq{}}
    
    \PY{c+c1}{\PYZsh{} docstring possible addition (ignore):}
\PY{c+c1}{\PYZsh{}     Gives the option of passing}
\PY{c+c1}{\PYZsh{}     in an existing instance of requests DF (must be from a call to get\PYZus{}df\PYZus{}requests\PYZus{}from\PYZus{}db())}
\PY{c+c1}{\PYZsh{}     or, if dataframe=None, this function will instantiate a new basis requests DF.}
    
    \PY{c+c1}{\PYZsh{} BUGGGY:}
\PY{c+c1}{\PYZsh{}     if (dataframe is None):}
\PY{c+c1}{\PYZsh{}         requests\PYZus{}base = get\PYZus{}df\PYZus{}requests\PYZus{}from\PYZus{}db(start\PYZus{}year, end\PYZus{}year)}
\PY{c+c1}{\PYZsh{}         \PYZsh{} Decrease memory usage for requests\PYZus{}base:}
\PY{c+c1}{\PYZsh{}         requests\PYZus{}base[\PYZsq{}Duration\PYZsq{}] = requests\PYZus{}base[\PYZsq{}Duration\PYZsq{}].astype(\PYZsq{}float32\PYZsq{})}
\PY{c+c1}{\PYZsh{}     else:}
\PY{c+c1}{\PYZsh{}         requests\PYZus{}base = dataframe}

    \PY{n}{requests\PYZus{}base} \PY{o}{=} \PY{n}{get\PYZus{}df\PYZus{}requests\PYZus{}from\PYZus{}db}\PY{p}{(}\PY{n}{start\PYZus{}year}\PY{p}{,} \PY{n}{end\PYZus{}year}\PY{p}{)}
    
    \PY{c+c1}{\PYZsh{} Create DF of requests with useful dates columns:}
    \PY{n}{requests\PYZus{}dates} \PY{o}{=} \PY{n}{requests\PYZus{}base}
    \PY{n}{requests\PYZus{}dates}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{requests\PYZus{}base}\PY{o}{.}\PY{n}{index}\PY{o}{.}\PY{n}{year}
    \PY{n}{requests\PYZus{}dates}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{requests\PYZus{}base}\PY{o}{.}\PY{n}{index}\PY{o}{.}\PY{n}{month}
    \PY{n}{requests\PYZus{}dates}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{requests\PYZus{}base}\PY{o}{.}\PY{n}{index}\PY{o}{.}\PY{n}{week}
    \PY{n}{requests\PYZus{}dates}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Weekday}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{requests\PYZus{}base}\PY{o}{.}\PY{n}{index}\PY{o}{.}\PY{n}{weekday\PYZus{}name}
    \PY{n}{requests\PYZus{}dates}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{requests\PYZus{}base}\PY{o}{.}\PY{n}{index}\PY{o}{.}\PY{n}{day}
\PY{c+c1}{\PYZsh{}     requests\PYZus{}dates.dropna(inplace=True)}
    
    \PY{c+c1}{\PYZsh{} Decrease memory usage for requests\PYZus{}dates:}
    \PY{n}{requests\PYZus{}dates}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]} \PY{o}{=} \PY{n}{requests\PYZus{}dates}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{int16}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    
    \PY{k}{return} \PY{n}{requests\PYZus{}dates}
\end{Verbatim}
\end{tcolorbox}

    \subsection{Load intial data}\label{load-intial-data}

    The following section will show what the base DataFrames being loaded in
from SQL will look like.

    \textbf{Rerun this cell with a new date range/s to reset the sample
data:}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{17}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{requests} \PY{o}{=} \PY{n}{get\PYZus{}df\PYZus{}requests\PYZus{}from\PYZus{}db}\PY{p}{(}\PY{l+m+mi}{2018}\PY{p}{,} \PY{l+m+mi}{2019}\PY{p}{)}
\PY{n}{requests\PYZus{}dates} \PY{o}{=} \PY{n}{get\PYZus{}df\PYZus{}requests\PYZus{}with\PYZus{}date\PYZus{}cols\PYZus{}from\PYZus{}db}\PY{p}{(}\PY{l+m+mi}{2018}\PY{p}{,} \PY{l+m+mi}{2019}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \paragraph{First look at requests DF:}\label{first-look-at-requests-df}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{17}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{requests}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{17}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
                         Duration
StartTimeStamp
2019-08-01 17:00:00.947       1.0
2019-08-01 17:00:21.560      18.0
2019-08-01 17:00:49.377       0.0
2019-08-01 17:01:07.030      15.0
2019-08-01 17:03:34.497       0.0
\end{Verbatim}
\end{tcolorbox}
        
    \textbf{Get some basic facts about the data:}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{29}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{requests}\PY{o}{.}\PY{n}{describe}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{29}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
           Duration
count  1.608252e+06
mean   1.891486e+00
std    1.314368e+01
min    0.000000e+00
25\%    0.000000e+00
50\%    1.000000e+00
75\%    2.000000e+00
max    1.343400e+04
\end{Verbatim}
\end{tcolorbox}
        
    \textbf{Analize NANs in data:}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{34}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{requests}\PY{o}{.}\PY{n}{isna}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{34}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
Duration    2
dtype: int64
\end{Verbatim}
\end{tcolorbox}
        
    Verify types are small, as intended:

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{35}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n+nb}{print}\PY{p}{(}\PY{n+nb}{type}\PY{p}{(}\PY{n}{requests}\PY{o}{.}\PY{n}{index}\PY{p}{)}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n+nb}{type}\PY{p}{(}\PY{n}{requests}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
<class 'pandas.core.indexes.datetimes.DatetimeIndex'>
<class 'numpy.float32'>
    \end{Verbatim}

    \paragraph{First look at requests\_dates
DF}\label{first-look-at-requests_dates-df}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{36}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{requests\PYZus{}dates}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{36}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
                         Duration  Year  Month  Week   Weekday  Day
StartTimeStamp
2019-08-01 17:00:00.947       1.0  2019      8    31  Thursday    1
2019-08-01 17:00:21.560      18.0  2019      8    31  Thursday    1
2019-08-01 17:00:49.377       0.0  2019      8    31  Thursday    1
2019-08-01 17:01:07.030      15.0  2019      8    31  Thursday    1
2019-08-01 17:03:34.497       0.0  2019      8    31  Thursday    1
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{66}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{requests\PYZus{}dates}\PY{o}{.}\PY{n}{describe}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{66}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
           Duration          Year         Month          Week           Day
count  1.608257e+06  1.608257e+06  1.608257e+06  1.608257e+06  1.608257e+06
mean   1.891479e+00  2.018331e+03  5.626664e+00  2.217515e+01  1.134353e+01
std    1.314366e+01  4.706673e-01  3.317209e+00  1.443448e+01  7.608449e+00
min   -1.000000e+00  2.018000e+03  1.000000e+00  1.000000e+00  1.000000e+00
25\%    0.000000e+00  2.018000e+03  3.000000e+00  1.000000e+01  5.000000e+00
50\%    1.000000e+00  2.018000e+03  5.000000e+00  2.000000e+01  9.000000e+00
75\%    2.000000e+00  2.019000e+03  8.000000e+00  3.400000e+01  1.600000e+01
max    1.343400e+04  2.019000e+03  1.200000e+01  5.200000e+01  3.100000e+01
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{37}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{requests\PYZus{}dates}\PY{o}{.}\PY{n}{isna}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{37}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
Duration    2
Year        0
Month       0
Week        0
Weekday     0
Day         0
dtype: int64
\end{Verbatim}
\end{tcolorbox}
        
    Verify types are small, as intended:

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{14}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n+nb}{print}\PY{p}{(}\PY{n+nb}{type}\PY{p}{(}\PY{n}{requests\PYZus{}dates}\PY{o}{.}\PY{n}{index}\PY{p}{)}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n+nb}{type}\PY{p}{(}\PY{n}{requests\PYZus{}dates}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n+nb}{type}\PY{p}{(}\PY{n}{requests\PYZus{}dates}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n+nb}{type}\PY{p}{(}\PY{n}{requests\PYZus{}dates}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n+nb}{type}\PY{p}{(}\PY{n}{requests\PYZus{}dates}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n+nb}{type}\PY{p}{(}\PY{n}{requests\PYZus{}dates}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Weekday}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n+nb}{type}\PY{p}{(}\PY{n}{requests\PYZus{}dates}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
<class 'pandas.core.indexes.datetimes.DatetimeIndex'>
<class 'numpy.float32'>
<class 'numpy.int16'>
<class 'numpy.int16'>
<class 'numpy.int16'>
<class 'str'>
<class 'numpy.int16'>
    \end{Verbatim}

    \section{Create some useful plotting helper
functions}\label{create-some-useful-plotting-helper-functions}

    \subsection{Formatting functions:}\label{formatting-functions}

    \paragraph{Month name-number mapping for subplot (Axes)
names}\label{month-name-number-mapping-for-subplot-axes-names}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{67}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{place\PYZus{}month\PYZus{}names\PYZus{}on\PYZus{}axes}\PY{p}{(}\PY{n}{is\PYZus{}single\PYZus{}axes}\PY{p}{:} \PY{n+nb}{bool}\PY{p}{,} \PY{n}{loc\PYZus{}str}\PY{p}{:} \PY{n+nb}{str}\PY{p}{,} \PY{n}{font\PYZus{}size}\PY{p}{:} \PY{n+nb}{int}\PY{p}{,} \PY{n}{dataframe}\PY{p}{:} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame} \PY{o}{=}\PY{k+kc}{None}\PY{p}{,} \PY{n}{axes\PYZus{}arr}\PY{p}{:} \PY{n+nb}{list} \PY{o}{=}\PY{k+kc}{None}\PY{p}{,} \PY{n}{ax}\PY{p}{:} \PY{n}{plt}\PY{o}{.}\PY{n}{Axes} \PY{o}{=}\PY{k+kc}{None}\PY{p}{,} \PY{n}{df\PYZus{}month\PYZus{}col\PYZus{}name}\PY{p}{:} \PY{n+nb}{str} \PY{o}{=}\PY{k+kc}{None}\PY{p}{)} \PY{o}{\PYZhy{}}\PY{o}{\PYZgt{}} \PY{k+kc}{None}\PY{p}{:}
    \PY{l+s+sd}{\PYZsq{}\PYZsq{}\PYZsq{} Based on whether is\PYZus{}single\PYZus{}axes is T/F, this function takes either:}
\PY{l+s+sd}{            }
\PY{l+s+sd}{            if is\PYZus{}single\PYZus{}axes True:}
\PY{l+s+sd}{            A matplotlib Axes object (ax), the DataFrame being plotted (dataframe), and the name}
\PY{l+s+sd}{            of the DF col containing an integer representing month of the year (df\PYZus{}month\PYZus{}col\PYZus{}name).}
\PY{l+s+sd}{            }
\PY{l+s+sd}{            OR}
\PY{l+s+sd}{            }
\PY{l+s+sd}{            if is\PYZus{}single\PYZus{}axes False:}
\PY{l+s+sd}{            A matplotlib Axes ARRAY (axes\PYZus{}arr).}
\PY{l+s+sd}{            }
\PY{l+s+sd}{        The first case will place the month name on the single Axes object it is passed,}
\PY{l+s+sd}{        based on the contents of dataframe[df\PYZus{}month\PYZus{}col\PYZus{}name].}

\PY{l+s+sd}{        The second case will iterate through the array of Axes, and place the month name on each}
\PY{l+s+sd}{        Axes based on the default name that matplotlib gives each axes when it is created in a}
\PY{l+s+sd}{        Seaborn FacetGrid.}

\PY{l+s+sd}{        The other, required, args are:}
\PY{l+s+sd}{        is\PYZus{}single\PYZus{}axes: True if passing a single Axes object,}
\PY{l+s+sd}{        loc\PYZus{}str: location (\PYZsq{}left\PYZsq{}, \PYZsq{}right\PYZsq{} or \PYZsq{}center\PYZsq{}) on the Axes object to place the month name),}
\PY{l+s+sd}{        font\PYZus{}size: font size of the month name title being placed on the Axes/axis. \PYZsq{}\PYZsq{}\PYZsq{}}
    
    \PY{c+c1}{\PYZsh{} Create a dict of name\PYZhy{}number pairs for month labeling:}
    \PY{n}{month\PYZus{}num\PYZus{}name} \PY{o}{=} \PY{p}{\PYZob{}}
        \PY{l+m+mi}{1}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{January}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
        \PY{l+m+mi}{2}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{February}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
        \PY{l+m+mi}{3}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{March}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
        \PY{l+m+mi}{4}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{April}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
        \PY{l+m+mi}{5}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{May}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
        \PY{l+m+mi}{6}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{June}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
        \PY{l+m+mi}{7}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{July}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
        \PY{l+m+mi}{8}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{August}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
        \PY{l+m+mi}{9}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{September}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
        \PY{l+m+mi}{10}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{October}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
        \PY{l+m+mi}{11}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{November}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
        \PY{l+m+mi}{12}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{December}\PY{l+s+s1}{\PYZsq{}}
    \PY{p}{\PYZcb{}}

    \PY{k}{if} \PY{p}{(}\PY{n}{is\PYZus{}single\PYZus{}axes}\PY{p}{)}\PY{p}{:}
        \PY{n}{month\PYZus{}number} \PY{o}{=} \PY{n}{dataframe}\PY{p}{[}\PY{n}{df\PYZus{}month\PYZus{}col\PYZus{}name}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{int}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
        \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{n}{month\PYZus{}num\PYZus{}name}\PY{p}{[}\PY{n}{month\PYZus{}number}\PY{p}{]}\PY{p}{,} \PY{n}{loc}\PY{o}{=}\PY{n}{loc\PYZus{}str}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{n}{font\PYZus{}size}\PY{p}{,} \PY{n}{pad}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}
    \PY{k}{else}\PY{p}{:}
        \PY{k}{for} \PY{n}{month} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{axes\PYZus{}arr}\PY{p}{)}\PY{p}{)}\PY{p}{:}
            \PY{c+c1}{\PYZsh{} Extract the two characters that will contain the number:}
            \PY{n}{this\PYZus{}month\PYZus{}str} \PY{o}{=} \PY{p}{(}\PY{n}{axes}\PY{p}{[}\PY{n}{month}\PY{p}{]}\PY{o}{.}\PY{n}{get\PYZus{}title}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{2}\PY{p}{]} \PY{o}{+} \PY{p}{(}\PY{n}{axes}\PY{p}{[}\PY{n}{month}\PY{p}{]}\PY{o}{.}\PY{n}{get\PYZus{}title}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
            \PY{c+c1}{\PYZsh{} If the letter at position \PYZhy{}4 from get\PYZus{}title() is a space, then it must have been a single\PYZhy{}digit number in the name,}
            \PY{c+c1}{\PYZsh{} so extract it:}
            \PY{k}{if} \PY{n}{this\PYZus{}month\PYZus{}str}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ }\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                \PY{n}{this\PYZus{}month\PYZus{}num} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(}\PY{n}{this\PYZus{}month\PYZus{}str}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
            \PY{k}{else}\PY{p}{:}
                \PY{n}{this\PYZus{}month\PYZus{}num} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(}\PY{n}{this\PYZus{}month\PYZus{}str}\PY{p}{)}
            \PY{c+c1}{\PYZsh{} Change the title to the correct month name from the dict:}
            \PY{n}{axes}\PY{p}{[}\PY{n}{month}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{n}{month\PYZus{}num\PYZus{}name}\PY{p}{[}\PY{n}{this\PYZus{}month\PYZus{}num}\PY{p}{]}\PY{p}{,} \PY{n}{loc}\PY{o}{=}\PY{n}{loc\PYZus{}str}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{n}{font\PYZus{}size}\PY{p}{)} \PY{c+c1}{\PYZsh{} KNOWN BUG: sometimes this call will leave the old title in place.}
\end{Verbatim}
\end{tcolorbox}

    \paragraph{Year title formatter for subplots (Axes)
titles}\label{year-title-formatter-for-subplots-axes-titles}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{68}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{set\PYZus{}year\PYZus{}name\PYZus{}axes\PYZus{}titles}\PY{p}{(}\PY{n}{axes\PYZus{}arr}\PY{p}{:} \PY{n}{plt}\PY{o}{.}\PY{n}{Axes}\PY{p}{,} \PY{n}{dataframe}\PY{p}{:} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{,} \PY{n}{loc\PYZus{}str}\PY{p}{:} \PY{n+nb}{str}\PY{p}{,} \PY{n}{df\PYZus{}year\PYZus{}name\PYZus{}col}\PY{p}{:} \PY{n+nb}{str}\PY{p}{)} \PY{o}{\PYZhy{}}\PY{o}{\PYZgt{}} \PY{k+kc}{None}\PY{p}{:}
    \PY{l+s+sd}{\PYZsq{}\PYZsq{}\PYZsq{} This function takes an array of matplotlib Axes objects and places a year title on each of them. }
\PY{l+s+sd}{    }
\PY{l+s+sd}{        dataframe: dataframe being plotted.}
\PY{l+s+sd}{        df\PYZus{}year\PYZus{}name\PYZus{}col: the name of the column containing the year integer. DF col must contain the full,}
\PY{l+s+sd}{            4\PYZhy{}digit year idetifier.\PYZsq{}\PYZsq{}\PYZsq{}}
    
    \PY{k}{for} \PY{n}{year} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{dataframe}\PY{p}{[}\PY{n}{df\PYZus{}year\PYZus{}name\PYZus{}col}\PY{p}{]}\PY{o}{.}\PY{n}{nunique}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{:}
        \PY{n}{current\PYZus{}title} \PY{o}{=} \PY{n}{axes}\PY{p}{[}\PY{n}{year}\PY{p}{]}\PY{o}{.}\PY{n}{get\PYZus{}title}\PY{p}{(}\PY{p}{)}
\PY{c+c1}{\PYZsh{}         axes[year].set\PYZus{}title(\PYZsq{} \PYZsq{})}
        \PY{n}{new\PYZus{}title} \PY{o}{=} \PY{n}{current\PYZus{}title}\PY{p}{[}\PY{l+m+mi}{7}\PY{p}{:}\PY{l+m+mi}{11}\PY{p}{]}
        \PY{n}{axes}\PY{p}{[}\PY{n}{year}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{n}{new\PYZus{}title}\PY{p}{,} \PY{n}{loc}\PY{o}{=}\PY{n}{loc}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{16}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \subsection{DataFrame generator
functions:}\label{dataframe-generator-functions}

    The following functions generate new DFs by either filtering another DF
being passed in or creating a new DF using
get\_df\_requests\_with\_date\_cols\_from\_db(), then filtering the
resulting dataframe further.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{69}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{get\PYZus{}df\PYZus{}no\PYZus{}weekends}\PY{p}{(}\PY{n}{dataframe}\PY{p}{:} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{,} \PY{n}{df\PYZus{}weekday\PYZus{}name\PYZus{}col}\PY{p}{:} \PY{n+nb}{str}\PY{p}{)} \PY{o}{\PYZhy{}}\PY{o}{\PYZgt{}} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{:}
    \PY{l+s+sd}{\PYZsq{}\PYZsq{}\PYZsq{} Takes a dataframe and returns a copy of that dataframe without any records observed on a weekend.}
\PY{l+s+sd}{        }
\PY{l+s+sd}{        dataframe: the basis dataframe to remove weekends from in returned copy.}
\PY{l+s+sd}{        df\PYZus{}weekday\PYZus{}name\PYZus{}col: the name of the column containing the Weekday name. DF col must contain strings}
\PY{l+s+sd}{            with no extra spaces, first letter capitalized. \PYZsq{}\PYZsq{}\PYZsq{}}
    
    \PY{n}{weekday\PYZus{}filter} \PY{o}{=} \PY{p}{(} \PY{p}{(}\PY{n}{dataframe}\PY{p}{[}\PY{n}{df\PYZus{}weekday\PYZus{}name\PYZus{}col}\PY{p}{]} \PY{o}{!=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Saturday}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{o}{\PYZam{}} \PY{p}{(}\PY{n}{dataframe}\PY{p}{[}\PY{n}{df\PYZus{}weekday\PYZus{}name\PYZus{}col}\PY{p}{]} \PY{o}{!=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sunday}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{p}{)}
    \PY{n}{dataframe\PYZus{}no\PYZus{}weekends} \PY{o}{=} \PY{n}{dataframe}\PY{o}{.}\PY{n}{where}\PY{p}{(}\PY{n}{weekday\PYZus{}filter}\PY{p}{)}
    \PY{n}{dataframe\PYZus{}no\PYZus{}weekends} \PY{o}{=} \PY{n}{dataframe\PYZus{}no\PYZus{}weekends}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{p}{)}
    \PY{k}{return} \PY{n}{dataframe\PYZus{}no\PYZus{}weekends}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{387}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{get\PYZus{}df\PYZus{}requests\PYZus{}1\PYZus{}month}\PY{p}{(}\PY{n}{year}\PY{p}{:} \PY{n+nb}{int}\PY{p}{,} \PY{n}{month}\PY{p}{:} \PY{n+nb}{int}\PY{p}{,} \PY{n}{df\PYZus{}month\PYZus{}name\PYZus{}col}\PY{p}{:} \PY{n+nb}{str}\PY{p}{)} \PY{o}{\PYZhy{}}\PY{o}{\PYZgt{}} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{:}
    \PY{l+s+sd}{\PYZsq{}\PYZsq{}\PYZsq{} Utilizes get\PYZus{}df\PYZus{}requests\PYZus{}with\PYZus{}date\PYZus{}cols\PYZus{}from\PYZus{}db() to pull in data from DB for a specific year,}
\PY{l+s+sd}{        then further filters this DF by month.}
\PY{l+s+sd}{        }
\PY{l+s+sd}{        year: year to filter by.}
\PY{l+s+sd}{        month: month to filter by.}
\PY{l+s+sd}{        df\PYZus{}month\PYZus{}name\PYZus{}col: the name of the column containing the month identifier, where the month}
\PY{l+s+sd}{            identifier is an integer. \PYZsq{}\PYZsq{}\PYZsq{}}

    \PY{n}{requests\PYZus{}dates\PYZus{}year} \PY{o}{=} \PY{n}{get\PYZus{}df\PYZus{}requests\PYZus{}with\PYZus{}date\PYZus{}cols\PYZus{}from\PYZus{}db}\PY{p}{(}\PY{n}{year}\PY{p}{,} \PY{n}{year}\PY{p}{)}
    
    \PY{n}{single\PYZus{}month\PYZus{}filter} \PY{o}{=} \PY{p}{(} \PY{n}{requests\PYZus{}dates\PYZus{}year}\PY{p}{[}\PY{n}{df\PYZus{}month\PYZus{}name\PYZus{}col}\PY{p}{]} \PY{o}{==} \PY{n}{month} \PY{p}{)}
    \PY{n}{requests\PYZus{}dates\PYZus{}month} \PY{o}{=} \PY{n}{requests\PYZus{}dates\PYZus{}year}\PY{o}{.}\PY{n}{where}\PY{p}{(}\PY{n}{single\PYZus{}month\PYZus{}filter}\PY{p}{)}
    \PY{n}{requests\PYZus{}dates\PYZus{}month}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
    
    \PY{k}{return} \PY{n}{requests\PYZus{}dates\PYZus{}month}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{388}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{get\PYZus{}df\PYZus{}requests\PYZus{}month\PYZus{}range}\PY{p}{(}\PY{n}{year}\PY{p}{:} \PY{n+nb}{int}\PY{p}{,} \PY{n}{start\PYZus{}month}\PY{p}{:} \PY{n+nb}{int}\PY{p}{,} \PY{n}{end\PYZus{}month}\PY{p}{:} \PY{n+nb}{int}\PY{p}{,} \PY{n}{df\PYZus{}month\PYZus{}name\PYZus{}col}\PY{p}{:} \PY{n+nb}{str}\PY{p}{)} \PY{o}{\PYZhy{}}\PY{o}{\PYZgt{}} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{:}
    \PY{l+s+sd}{\PYZsq{}\PYZsq{}\PYZsq{} Utilizes get\PYZus{}df\PYZus{}requests\PYZus{}with\PYZus{}date\PYZus{}cols\PYZus{}from\PYZus{}db() to pull in data from DB for a specific year,}
\PY{l+s+sd}{        then further filters this DF by the specified month range.}

\PY{l+s+sd}{        year: year to filter by.}
\PY{l+s+sd}{        start\PYZus{}month: first month in range to filter by, inclusive.}
\PY{l+s+sd}{        end\PYZus{}month: last month to filter by, inclusive.}
\PY{l+s+sd}{        df\PYZus{}month\PYZus{}name\PYZus{}col: the name of the column containing the month identifier, where the month}
\PY{l+s+sd}{            identifier is an integer. \PYZsq{}\PYZsq{}\PYZsq{}}
    
    \PY{n}{requests\PYZus{}dates\PYZus{}year} \PY{o}{=} \PY{n}{get\PYZus{}df\PYZus{}requests\PYZus{}with\PYZus{}date\PYZus{}cols\PYZus{}from\PYZus{}db}\PY{p}{(}\PY{n}{year}\PY{p}{,} \PY{n}{year}\PY{p}{)}
    
    \PY{n}{month\PYZus{}filter} \PY{o}{=} \PY{p}{(} \PY{p}{(}\PY{n}{requests\PYZus{}dates\PYZus{}year}\PY{p}{[}\PY{n}{df\PYZus{}month\PYZus{}name\PYZus{}col}\PY{p}{]} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{n}{start\PYZus{}month}\PY{p}{)} \PY{o}{\PYZam{}} \PY{p}{(}\PY{n}{requests\PYZus{}dates\PYZus{}year}\PY{p}{[}\PY{n}{df\PYZus{}month\PYZus{}name\PYZus{}col}\PY{p}{]} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{n}{end\PYZus{}month}\PY{p}{)} \PY{p}{)} \PY{c+c1}{\PYZsh{} Boolean series}
    \PY{n}{requests\PYZus{}3\PYZus{}months} \PY{o}{=} \PY{n}{requests\PYZus{}dates\PYZus{}year}\PY{o}{.}\PY{n}{where}\PY{p}{(}\PY{n}{month\PYZus{}filter}\PY{p}{)}
    \PY{n}{requests\PYZus{}3\PYZus{}months}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
    
    \PY{k}{return} \PY{n}{requests\PYZus{}3\PYZus{}months}
\end{Verbatim}
\end{tcolorbox}

    \section{Analyses}\label{analyses}

    Within this section, multiple different analyses of the DataCell request
data will be constructed. There are subsections which are numbered based
on the data story being told.

\subsubsection{Section numbering:}\label{section-numbering}

Format of titles: \textbf{\#.\#.\# - Title}

\textbf{Analysis Level (\#.x.x)} - The first number in section titles
(\#.x.x) defines the overarching type of analysis being done throughout
the whole section, e.g. analysis over 1 year of data, and will be
indicated in a title first by markdown heading 2 (h2). For example,
subsection 1. contains multiple different analyses of request data over
1 year. Sometimes, a base DataFrame that will be used in all subsections
will be defined by a function prep\_base\_data\_\#() in first
subsections.

\textbf{Dataframe Level (x.\#.x)} - The second subsection (x.\#.x) in
the title indicates the DataFrame-level subsection. This means that each
distinct subsection at this level (e.g. 1.1, 1.2, 3.4, etc.) has it's
own DataFrame defined for it, and the analyses/visualizations within
this subsection are all being done on that DataFrame. The DataFrames for
these subsections will be created by a function named
some\_data\_prep\_description\_\#\_\#() for each subsection, which will
be defined and called right after the title of the subsection. The
titles for second subsections will be in markdown header 4 (h4).

\textbf{Figure Level (x.x.\#)} - The third and final subsection defines
an individual figure/plot. All third subsections will belong to a second
subsection that defines the DataFrame that the figure uses. Each
figure/plot will have a "Figure definitions" section right before the
figure source code where you can modify variables that effect the look
or execution of the figure, and they will be labeled
figure\_defintion\_variable\_\#\emph{\#}\#. The titles for third
subsections will be in markdown header 5 (h5).

\subsubsection{Notes}\label{notes}

\paragraph{"prep\_data\_\#()" and similar data prep functions used in
these
sections:}\label{prep_data_-and-similar-data-prep-functions-used-in-these-sections}

Most of the data prep functions used herein (\#.x.x) are just wrapper
functions that call get\_df\_requests\_with\_date\_cols\_from\_db() for
a specified year period, or one of the month-filtering get\_df functions
defined above. They then give the user the choice to exclude weekends or
not. They are used as an information-hiding mechanism, and to keep
everything in once place. Some of these data prep functions, however,
also do aggregation and other DataFrame manipulation and then return a
new modified DF. These functions will be more interesting to read.

\paragraph{"clear\_df\_from\_mem\_\#\_\#\_\#"
variable:}\label{clear_df_from_mem___-variable}

This variable is in the "Figure definitions" section for each individual
figure. It is there to save memory by deleting the DataFrame that is
being plotted after the figure is rendered. It should be set to
\textbf{True} when you just want to render the figure and keep it up for
looking at. However, if you want to edit the figure and reload it as you
make changes to the figure source code or the figure definitions
variables, you should set clear\_df\_from\_mem\_\#\_\#\_\# to
\textbf{False} so that your DataFrame will be kept in memory and you
don't have to constantly go back to the data prep function and reload
the DataFrame every time you make a change to the figure.

    \emph{Developer NOTE:} More user-control variables could be added to the
"Figure definitions" sections on all of these plots.

    \subsection{1 - Data over 1 year, by
month}\label{data-over-1-year-by-month}

    \paragraph{1.1 - Mean estimation of all requests, 1
year}\label{mean-estimation-of-all-requests-1-year}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{111}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} Known bugs:}
    \PY{c+c1}{\PYZsh{} \PYZhy{}With fewer Axes, the figure looks bad (figure title overlaps first Axes, etc.). Need to make it dynamically styled. See fig.subplots\PYZus{}adjust() call.}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{2}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} Ideas/notes:}
    \PY{c+c1}{\PYZsh{} Exclude weekends. Exclude holidays? Make if very obvious that we are excluding thesedays, make this reversible.}
\end{Verbatim}
\end{tcolorbox}

    DataFrame prep:

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{72}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{prep\PYZus{}data\PYZus{}1\PYZus{}1}\PY{p}{(}\PY{n}{year}\PY{p}{:} \PY{n+nb}{int}\PY{p}{,} \PY{n}{exclude\PYZus{}weekends}\PY{p}{:} \PY{n+nb}{bool}\PY{p}{)} \PY{o}{\PYZhy{}}\PY{o}{\PYZgt{}} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{:}

    \PY{n}{df\PYZus{}1\PYZus{}1} \PY{o}{=} \PY{n}{get\PYZus{}df\PYZus{}requests\PYZus{}with\PYZus{}date\PYZus{}cols\PYZus{}from\PYZus{}db}\PY{p}{(}\PY{l+m+mi}{2019}\PY{p}{,} \PY{l+m+mi}{2019}\PY{p}{)}
    
    \PY{k}{if} \PY{p}{(}\PY{n}{exclude\PYZus{}weekends}\PY{p}{)}\PY{p}{:}
        \PY{n}{df\PYZus{}1\PYZus{}1} \PY{o}{=} \PY{n}{drop\PYZus{}weekends}\PY{p}{(}\PY{n}{df\PYZus{}1\PYZus{}1}\PY{p}{)}
        
    \PY{k}{return} \PY{n}{df\PYZus{}1\PYZus{}1}
\end{Verbatim}
\end{tcolorbox}

    \textbf{Load or reload data:}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{73}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{requests\PYZus{}1yr} \PY{o}{=} \PY{n}{prep\PYZus{}data\PYZus{}1\PYZus{}1}\PY{p}{(}
    \PY{n}{year}\PY{o}{=}\PY{l+m+mi}{2019}\PY{p}{,}
    \PY{n}{exclude\PYZus{}weekends}\PY{o}{=}\PY{k+kc}{False}
\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{74}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{requests\PYZus{}1yr}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{74}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
                         Duration  Year  Month  Week   Weekday  Day
StartTimeStamp
2019-08-01 17:00:00.947       1.0  2019      8    31  Thursday    1
2019-08-01 17:00:21.560      18.0  2019      8    31  Thursday    1
2019-08-01 17:00:49.377       0.0  2019      8    31  Thursday    1
2019-08-01 17:01:07.030      15.0  2019      8    31  Thursday    1
2019-08-01 17:03:34.497       0.0  2019      8    31  Thursday    1
\end{Verbatim}
\end{tcolorbox}
        
    \subparagraph{1.1.1 - Plot of mean estimation of all request durations
over 1 year, with subplots/Axes for each
month}\label{plot-of-mean-estimation-of-all-request-durations-over-1-year-with-subplotsaxes-for-each-month}

    \textbf{Alter figure definitions:}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{75}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} all\PYZus{}data\PYZus{}line\PYZus{}color\PYZus{}1\PYZus{}1\PYZus{}1 = \PYZsq{}steelblue\PYZsq{}}
\PY{n}{mean\PYZus{}data\PYZus{}line\PYZus{}color\PYZus{}1\PYZus{}1\PYZus{}1} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lightcoral}\PY{l+s+s1}{\PYZsq{}}

\PY{c+c1}{\PYZsh{} Set this to True if you would like the DataFrame to be deleted from memory after the figure is rendered:}
\PY{n}{clear\PYZus{}df\PYZus{}from\PYZus{}mem\PYZus{}1\PYZus{}1\PYZus{}1} \PY{o}{=} \PY{k+kc}{True}
\end{Verbatim}
\end{tcolorbox}

    \textbf{Run cell below to render the figure:}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{76}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import} \PY{n+nn}{seaborn} \PY{k}{as} \PY{n+nn}{sns}

\PY{n}{sns}\PY{o}{.}\PY{n}{set}\PY{p}{(}\PY{n}{style}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{darkgrid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{n}{month\PYZus{}grid} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{FacetGrid}\PY{p}{(}\PY{n}{requests\PYZus{}1yr}\PY{p}{,} \PY{n}{row}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{height}\PY{o}{=}\PY{l+m+mf}{3.5}\PY{p}{,} \PY{n}{aspect}\PY{o}{=}\PY{l+m+mi}{4}\PY{p}{,} \PY{n}{legend\PYZus{}out}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}

\PY{c+c1}{\PYZsh{} All observations:}
\PY{c+c1}{\PYZsh{} month\PYZus{}grid.map(sns.lineplot, \PYZsq{}Day\PYZsq{}, \PYZsq{}Duration\PYZsq{}, color=all\PYZus{}data\PYZus{}line\PYZus{}color\PYZus{}1\PYZus{}1\PYZus{}1)}
\PY{c+c1}{\PYZsh{} Mean for each day:}
\PY{n}{month\PYZus{}grid}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{n}{sns}\PY{o}{.}\PY{n}{lineplot}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{estimator}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{n}{mean\PYZus{}data\PYZus{}line\PYZus{}color\PYZus{}1\PYZus{}1\PYZus{}1}\PY{p}{)}

\PY{c+c1}{\PYZsh{} Set figure aesthetics:}

\PY{n}{month\PYZus{}grid}\PY{o}{.}\PY{n}{fig}\PY{o}{.}\PY{n}{suptitle}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{All Request Durations by Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{25}\PY{p}{)}

\PY{n}{month\PYZus{}grid}\PY{o}{.}\PY{n}{set\PYZus{}ylabels}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{20}\PY{p}{,} \PY{n}{labelpad}\PY{o}{=}\PY{l+m+mi}{15}\PY{p}{)}
\PY{n}{month\PYZus{}grid}\PY{o}{.}\PY{n}{set\PYZus{}xlabels}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{20}\PY{p}{,} \PY{n}{labelpad}\PY{o}{=}\PY{l+m+mi}{15}\PY{p}{)}

\PY{n}{axes} \PY{o}{=} \PY{n}{month\PYZus{}grid}\PY{o}{.}\PY{n}{axes}\PY{o}{.}\PY{n}{flatten}\PY{p}{(}\PY{p}{)} \PY{c+c1}{\PYZsh{} Numpy flatten 2D array of axes to array or 1D rows.}
\PY{n}{place\PYZus{}month\PYZus{}names\PYZus{}on\PYZus{}axes}\PY{p}{(}\PY{n}{is\PYZus{}single\PYZus{}axes}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,} \PY{n}{axes\PYZus{}arr}\PY{o}{=}\PY{n}{axes}\PY{p}{,} \PY{n}{loc\PYZus{}str}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{center}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{font\PYZus{}size}\PY{o}{=}\PY{l+m+mi}{18}\PY{p}{)}

\PY{n}{month\PYZus{}grid}\PY{o}{.}\PY{n}{set}\PY{p}{(}\PY{n}{yscale}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{symlog}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}  \PY{c+c1}{\PYZsh{} Retain zero values}
\PY{c+c1}{\PYZsh{} ax.set\PYZus{}ylim(bottom=\PYZhy{}0.25)  \PYZsh{} 0 doesn\PYZsq{}t work... }

\PY{c+c1}{\PYZsh{} Settings that need to be applied to each axis:}
\PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{axes}\PY{p}{)}\PY{p}{)}\PY{p}{:}
    \PY{n}{axes}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{.}\PY{n}{tick\PYZus{}params}\PY{p}{(}\PY{n}{axis}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{which}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{major}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{labelsize}\PY{o}{=}\PY{l+m+mi}{15}\PY{p}{)}

\PY{c+c1}{\PYZsh{} Set a figure\PYZhy{}level legend with the lines (0 and 1) from the first ([0]) Axes (can do this b/c because all Axes have the same two lines):}
\PY{c+c1}{\PYZsh{} month\PYZus{}grid.fig.legend(handles=(axes[0].lines[0], axes[0].lines[1]), labels=(\PYZsq{}All Request Durations\PYZsq{}, \PYZsq{}Mean Request Dur. per Day\PYZsq{}), borderpad=0.5, labelspacing=0.8, fontsize=15, loc=\PYZsq{}upper right\PYZsq{})}

\PY{n}{month\PYZus{}grid}\PY{o}{.}\PY{n}{fig}\PY{o}{.}\PY{n}{subplots\PYZus{}adjust}\PY{p}{(}\PY{n}{top}\PY{o}{=}\PY{l+m+mf}{0.939}\PY{p}{,} \PY{n}{left}\PY{o}{=}\PY{l+m+mf}{0.125}\PY{p}{,} \PY{n}{right}\PY{o}{=}\PY{l+m+mf}{0.9}\PY{p}{,} \PY{n}{hspace}\PY{o}{=}\PY{l+m+mf}{0.2}\PY{p}{,} \PY{n}{wspace}\PY{o}{=}\PY{l+m+mf}{0.2}\PY{p}{)}  \PY{c+c1}{\PYZsh{} These are magic numbers, do not adjust.}

\PY{c+c1}{\PYZsh{} month\PYZus{}grid.add\PYZus{}legend([\PYZsq{}All Request Durations\PYZsq{}, \PYZsq{}Mean Request Dur. per Day\PYZsq{}])}

\PY{c+c1}{\PYZsh{} month\PYZus{}grid.set\PYZus{}xticklabels(\PYZsq{}\PYZsq{})}

\PY{k}{if} \PY{p}{(}\PY{n}{clear\PYZus{}df\PYZus{}from\PYZus{}mem\PYZus{}1\PYZus{}1\PYZus{}1}\PY{p}{)}\PY{p}{:}
    \PY{k}{del} \PY{n}{requests\PYZus{}1yr}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{datacell_request_time_final_files/datacell_request_time_final_64_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \paragraph{1.2 - Daily request load vs. mean and max request durations
by month for 1
year}\label{daily-request-load-vs.-mean-and-max-request-durations-by-month-for-1-year}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{79}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{prep\PYZus{}data\PYZus{}1\PYZus{}2}\PY{p}{(}\PY{n}{year}\PY{p}{:} \PY{n+nb}{int}\PY{p}{,} \PY{n}{exclude\PYZus{}weekends}\PY{p}{:} \PY{n+nb}{bool}\PY{p}{)} \PY{o}{\PYZhy{}}\PY{o}{\PYZgt{}} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{:}

    \PY{n}{base\PYZus{}data\PYZus{}yr} \PY{o}{=} \PY{n}{get\PYZus{}df\PYZus{}requests\PYZus{}with\PYZus{}date\PYZus{}cols\PYZus{}from\PYZus{}db}\PY{p}{(}\PY{n}{year}\PY{p}{,} \PY{n}{year}\PY{p}{)}
    
    \PY{k}{if} \PY{p}{(}\PY{n}{exclude\PYZus{}weekends}\PY{p}{)}\PY{p}{:}
        \PY{n}{base\PYZus{}data\PYZus{}yr} \PY{o}{=} \PY{n}{get\PYZus{}df\PYZus{}no\PYZus{}weekends}\PY{p}{(}\PY{n}{base\PYZus{}data\PYZus{}yr}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Weekday}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
    \PY{n}{df\PYZus{}1\PYZus{}2} \PY{o}{=} \PY{n}{base\PYZus{}data\PYZus{}yr}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{n}{pd}\PY{o}{.}\PY{n}{Grouper}\PY{p}{(}\PY{n}{freq}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{D}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{agg}\PY{p}{(}
    \PY{n}{Mean\PYZus{}Duration}\PY{o}{=}\PY{n}{pd}\PY{o}{.}\PY{n}{NamedAgg}\PY{p}{(}\PY{n}{column}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{aggfunc}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{)}\PY{p}{,}
    \PY{n}{Max\PYZus{}Duration}\PY{o}{=}\PY{n}{pd}\PY{o}{.}\PY{n}{NamedAgg}\PY{p}{(}\PY{n}{column}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{aggfunc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
    \PY{n}{Count\PYZus{}Durations}\PY{o}{=}\PY{n}{pd}\PY{o}{.}\PY{n}{NamedAgg}\PY{p}{(}\PY{n}{column}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{aggfunc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{count}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
    \PY{n}{Day}\PY{o}{=}\PY{n}{pd}\PY{o}{.}\PY{n}{NamedAgg}\PY{p}{(}\PY{n}{column}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{aggfunc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
    \PY{n}{Month}\PY{o}{=}\PY{n}{pd}\PY{o}{.}\PY{n}{NamedAgg}\PY{p}{(}\PY{n}{column}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{aggfunc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{p}{)}
    
    \PY{n}{df\PYZus{}1\PYZus{}2}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
    
    \PY{n}{df\PYZus{}1\PYZus{}2}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]} \PY{o}{=} \PY{n}{df\PYZus{}1\PYZus{}2}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{int16}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    
    \PY{n}{df\PYZus{}1\PYZus{}2}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{n}{by}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
        
    \PY{k}{return} \PY{n}{df\PYZus{}1\PYZus{}2}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{80}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{daily\PYZus{}stats\PYZus{}1yr} \PY{o}{=} \PY{n}{prep\PYZus{}data\PYZus{}1\PYZus{}2}\PY{p}{(}
    \PY{n}{year}\PY{o}{=}\PY{l+m+mi}{2019}\PY{p}{,}
    \PY{n}{exclude\PYZus{}weekends}\PY{o}{=}\PY{k+kc}{True}
\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{81}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{daily\PYZus{}stats\PYZus{}1yr}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{81}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
                Mean\_Duration  Max\_Duration  Count\_Durations  Day  Month
StartTimeStamp
2019-01-01           2.627397          69.0              365    1      1
2019-01-02           1.868545         187.0             3834    2      1
2019-01-03           1.751369          99.0             6210    3      1
2019-01-04           1.541320         120.0             9124    4      1
2019-01-07           1.745326         112.0            10056    7      1
\end{Verbatim}
\end{tcolorbox}
        
    \subparagraph{1.2.1 - Plot of daily mean and max request duration vs.
request count/load, subplots by month, 1 year of
data}\label{plot-of-daily-mean-and-max-request-duration-vs.-request-countload-subplots-by-month-1-year-of-data}

    \textbf{Alter figure definitions:}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{84}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{mean\PYZus{}line\PYZus{}color\PYZus{}1\PYZus{}2\PYZus{}1} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}ffcf4e}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{max\PYZus{}line\PYZus{}color\PYZus{}1\PYZus{}2\PYZus{}1} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}FFA098}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{count\PYZus{}line\PYZus{}color\PYZus{}1\PYZus{}2\PYZus{}1} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}386E43}\PY{l+s+s1}{\PYZsq{}}

\PY{n}{estimator\PYZus{}1\PYZus{}2\PYZus{}1} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean}\PY{l+s+s1}{\PYZsq{}}

\PY{c+c1}{\PYZsh{} Set this to True if you would like the DataFrame to be deleted from memory after the figure is rendered:}
\PY{n}{clear\PYZus{}df\PYZus{}from\PYZus{}mem\PYZus{}1\PYZus{}2\PYZus{}1} \PY{o}{=} \PY{k+kc}{True}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{85}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import} \PY{n+nn}{seaborn} \PY{k}{as} \PY{n+nn}{sns}

\PY{n}{sns}\PY{o}{.}\PY{n}{set}\PY{p}{(}\PY{n}{style}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{darkgrid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{n}{month\PYZus{}grid} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{FacetGrid}\PY{p}{(}\PY{n}{daily\PYZus{}stats\PYZus{}1yr}\PY{p}{,} \PY{n}{row}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{height}\PY{o}{=}\PY{l+m+mf}{3.5}\PY{p}{,} \PY{n}{aspect}\PY{o}{=}\PY{l+m+mi}{4}\PY{p}{,} \PY{n}{legend\PYZus{}out}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}

\PY{c+c1}{\PYZsh{} All observations:}
\PY{n}{month\PYZus{}grid}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{n}{sns}\PY{o}{.}\PY{n}{lineplot}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mean\PYZus{}Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{estimator}\PY{o}{=}\PY{n}{estimator\PYZus{}1\PYZus{}2\PYZus{}1}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{n}{mean\PYZus{}line\PYZus{}color\PYZus{}1\PYZus{}2\PYZus{}1}\PY{p}{)}
\PY{n}{month\PYZus{}grid}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{n}{sns}\PY{o}{.}\PY{n}{lineplot}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Max\PYZus{}Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{estimator}\PY{o}{=}\PY{n}{estimator\PYZus{}1\PYZus{}2\PYZus{}1}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{n}{max\PYZus{}line\PYZus{}color\PYZus{}1\PYZus{}2\PYZus{}1}\PY{p}{)}
\PY{n}{month\PYZus{}grid}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{n}{sns}\PY{o}{.}\PY{n}{lineplot}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Count\PYZus{}Durations}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{estimator}\PY{o}{=}\PY{n}{estimator\PYZus{}1\PYZus{}2\PYZus{}1}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{n}{count\PYZus{}line\PYZus{}color\PYZus{}1\PYZus{}2\PYZus{}1}\PY{p}{)}

\PY{c+c1}{\PYZsh{} Set figure aesthetics:}

\PY{n}{month\PYZus{}grid}\PY{o}{.}\PY{n}{fig}\PY{o}{.}\PY{n}{suptitle}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{All Request Durations by Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{25}\PY{p}{)}

\PY{n}{month\PYZus{}grid}\PY{o}{.}\PY{n}{set\PYZus{}ylabels}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{20}\PY{p}{,} \PY{n}{labelpad}\PY{o}{=}\PY{l+m+mi}{15}\PY{p}{)}
\PY{n}{month\PYZus{}grid}\PY{o}{.}\PY{n}{set\PYZus{}xlabels}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{20}\PY{p}{,} \PY{n}{labelpad}\PY{o}{=}\PY{l+m+mi}{15}\PY{p}{)}

\PY{n}{axes} \PY{o}{=} \PY{n}{month\PYZus{}grid}\PY{o}{.}\PY{n}{axes}\PY{o}{.}\PY{n}{flatten}\PY{p}{(}\PY{p}{)} \PY{c+c1}{\PYZsh{} Numpy flatten 2D array of axes to array or 1D rows.}
\PY{n}{place\PYZus{}month\PYZus{}names\PYZus{}on\PYZus{}axes}\PY{p}{(}\PY{n}{is\PYZus{}single\PYZus{}axes}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,} \PY{n}{axes\PYZus{}arr}\PY{o}{=}\PY{n}{axes}\PY{p}{,} \PY{n}{loc\PYZus{}str}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{center}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{font\PYZus{}size}\PY{o}{=}\PY{l+m+mi}{18}\PY{p}{)}

\PY{n}{month\PYZus{}grid}\PY{o}{.}\PY{n}{set}\PY{p}{(}\PY{n}{yscale}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{symlog}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}  \PY{c+c1}{\PYZsh{} Retain zero values}
\PY{c+c1}{\PYZsh{} ax.set\PYZus{}ylim(bottom=\PYZhy{}0.25)  \PYZsh{} 0 doesn\PYZsq{}t work... }

\PY{c+c1}{\PYZsh{} Settings that need to be applied to each axis:}
\PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{axes}\PY{p}{)}\PY{p}{)}\PY{p}{:}
    \PY{n}{axes}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{.}\PY{n}{tick\PYZus{}params}\PY{p}{(}\PY{n}{axis}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{which}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{major}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{labelsize}\PY{o}{=}\PY{l+m+mi}{15}\PY{p}{)}

\PY{c+c1}{\PYZsh{} Set a figure\PYZhy{}level legend with the lines (0 and 1) from the first ([0]) Axes (can do this b/c because all Axes have the same two lines):}
\PY{n}{month\PYZus{}grid}\PY{o}{.}\PY{n}{fig}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{handles}\PY{o}{=}\PY{p}{(}\PY{n}{axes}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{lines}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{axes}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{lines}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{axes}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{lines}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n}{labels}\PY{o}{=}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Request Load}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Max Request Dur.}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mean Request Dur.}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,} \PY{n}{borderpad}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{labelspacing}\PY{o}{=}\PY{l+m+mf}{0.8}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{15}\PY{p}{,} \PY{n}{loc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{upper right}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{n}{month\PYZus{}grid}\PY{o}{.}\PY{n}{fig}\PY{o}{.}\PY{n}{subplots\PYZus{}adjust}\PY{p}{(}\PY{n}{top}\PY{o}{=}\PY{l+m+mf}{0.939}\PY{p}{,} \PY{n}{left}\PY{o}{=}\PY{l+m+mf}{0.125}\PY{p}{,} \PY{n}{right}\PY{o}{=}\PY{l+m+mf}{0.9}\PY{p}{,} \PY{n}{hspace}\PY{o}{=}\PY{l+m+mf}{0.2}\PY{p}{,} \PY{n}{wspace}\PY{o}{=}\PY{l+m+mf}{0.2}\PY{p}{)}  \PY{c+c1}{\PYZsh{} These are magic numbers, do not adjust.}

\PY{c+c1}{\PYZsh{} month\PYZus{}grid.add\PYZus{}legend([\PYZsq{}All Request Durations\PYZsq{}, \PYZsq{}Mean Request Dur. per Day\PYZsq{}])}

\PY{c+c1}{\PYZsh{} month\PYZus{}grid.set\PYZus{}xticklabels(\PYZsq{}\PYZsq{})}

\PY{k}{if} \PY{p}{(}\PY{n}{clear\PYZus{}df\PYZus{}from\PYZus{}mem\PYZus{}1\PYZus{}2\PYZus{}1}\PY{p}{)}\PY{p}{:}
    \PY{k}{del} \PY{n}{daily\PYZus{}stats\PYZus{}1yr}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{datacell_request_time_final_files/datacell_request_time_final_72_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    As opposed to \textbf{this}:

    The following was my initial attempt to solve the problem of making a
separate subplot for each month of data, where I had broken the
DataFrame up into 12 seperate DataFrames. This, however, requires much
unecessary data manipulation in pandas. I then discovered Seaborn's
FacetGrid (unsed to make the above plot), which is specifically designed
to take a DataFrame and use the values in one of it's columns to break
up the data into subplots.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{grouped\PYZus{}months} \PY{o}{=} \PY{n}{all\PYZus{}requests}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{c+c1}{\PYZsh{} for name, group in grouped\PYZus{}months:}
\PY{c+c1}{\PYZsh{}     print(name)}
\PY{c+c1}{\PYZsh{}     print(group)}

\PY{c+c1}{\PYZsh{} Some months have no data, exclude these:}
\PY{n}{all\PYZus{}requests\PYZus{}jan} \PY{o}{=} \PY{n}{grouped\PYZus{}months}\PY{o}{.}\PY{n}{get\PYZus{}group}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{all\PYZus{}requests\PYZus{}feb} \PY{o}{=} \PY{n}{grouped\PYZus{}months}\PY{o}{.}\PY{n}{get\PYZus{}group}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{)}
\PY{n}{all\PYZus{}requests\PYZus{}mar} \PY{o}{=} \PY{n}{grouped\PYZus{}months}\PY{o}{.}\PY{n}{get\PYZus{}group}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{)}
\PY{n}{all\PYZus{}requests\PYZus{}apr} \PY{o}{=} \PY{n}{grouped\PYZus{}months}\PY{o}{.}\PY{n}{get\PYZus{}group}\PY{p}{(}\PY{l+m+mi}{4}\PY{p}{)}
\PY{n}{all\PYZus{}requests\PYZus{}may} \PY{o}{=} \PY{n}{grouped\PYZus{}months}\PY{o}{.}\PY{n}{get\PYZus{}group}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{)}
\PY{n}{all\PYZus{}requests\PYZus{}jun} \PY{o}{=} \PY{n}{grouped\PYZus{}months}\PY{o}{.}\PY{n}{get\PYZus{}group}\PY{p}{(}\PY{l+m+mi}{6}\PY{p}{)}
\PY{n}{all\PYZus{}requests\PYZus{}jul} \PY{o}{=} \PY{n}{grouped\PYZus{}months}\PY{o}{.}\PY{n}{get\PYZus{}group}\PY{p}{(}\PY{l+m+mi}{7}\PY{p}{)}
\PY{c+c1}{\PYZsh{}all\PYZus{}requests\PYZus{}aug = grouped\PYZus{}months.get\PYZus{}group(8)}
\PY{c+c1}{\PYZsh{} all\PYZus{}requests\PYZus{}sep = grouped\PYZus{}months.get\PYZus{}group(9)}
\PY{n}{all\PYZus{}requests\PYZus{}oct} \PY{o}{=} \PY{n}{grouped\PYZus{}months}\PY{o}{.}\PY{n}{get\PYZus{}group}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}
\PY{c+c1}{\PYZsh{} all\PYZus{}requests\PYZus{}nov = grouped\PYZus{}months.get\PYZus{}group(11)}
\PY{c+c1}{\PYZsh{} all\PYZus{}requests\PYZus{}dec = grouped\PYZus{}months.get\PYZus{}group(12)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{} Make this more concise?}
\PY{n}{fig\PYZus{}months}\PY{p}{,} \PY{n}{axes} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{l+m+mi}{12}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{25}\PY{p}{,}\PY{l+m+mi}{30}\PY{p}{)}\PY{p}{,} \PY{n}{sharex}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{all}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{sns}\PY{o}{.}\PY{n}{lineplot}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{y}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{data}\PY{o}{=}\PY{n}{all\PYZus{}requests\PYZus{}jan}\PY{p}{,} \PY{n}{ax}\PY{o}{=}\PY{n}{axes}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{set}\PY{p}{(}\PY{n}{title}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{January}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{sns}\PY{o}{.}\PY{n}{lineplot}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{y}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{data}\PY{o}{=}\PY{n}{all\PYZus{}requests\PYZus{}feb}\PY{p}{,} \PY{n}{ax}\PY{o}{=}\PY{n}{axes}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
\PY{n}{sns}\PY{o}{.}\PY{n}{lineplot}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{y}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{data}\PY{o}{=}\PY{n}{all\PYZus{}requests\PYZus{}mar}\PY{p}{,} \PY{n}{ax}\PY{o}{=}\PY{n}{axes}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{)}
\PY{n}{sns}\PY{o}{.}\PY{n}{lineplot}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{y}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{data}\PY{o}{=}\PY{n}{all\PYZus{}requests\PYZus{}apr}\PY{p}{,} \PY{n}{ax}\PY{o}{=}\PY{n}{axes}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{)}
\PY{n}{sns}\PY{o}{.}\PY{n}{lineplot}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{y}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{data}\PY{o}{=}\PY{n}{all\PYZus{}requests\PYZus{}may}\PY{p}{,} \PY{n}{ax}\PY{o}{=}\PY{n}{axes}\PY{p}{[}\PY{l+m+mi}{4}\PY{p}{]}\PY{p}{)}
\PY{n}{sns}\PY{o}{.}\PY{n}{lineplot}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{y}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{data}\PY{o}{=}\PY{n}{all\PYZus{}requests\PYZus{}jun}\PY{p}{,} \PY{n}{ax}\PY{o}{=}\PY{n}{axes}\PY{p}{[}\PY{l+m+mi}{5}\PY{p}{]}\PY{p}{)}
\PY{n}{sns}\PY{o}{.}\PY{n}{lineplot}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{y}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{data}\PY{o}{=}\PY{n}{all\PYZus{}requests\PYZus{}jul}\PY{p}{,} \PY{n}{ax}\PY{o}{=}\PY{n}{axes}\PY{p}{[}\PY{l+m+mi}{6}\PY{p}{]}\PY{p}{)}
\PY{c+c1}{\PYZsh{}sns.lineplot(x=\PYZsq{}Day\PYZsq{}, y=\PYZsq{}Duration\PYZsq{}, data=all\PYZus{}requests\PYZus{}aug, ax=axes[7])}
\PY{c+c1}{\PYZsh{}sns.lineplot(x=\PYZsq{}Day\PYZsq{}, y=\PYZsq{}Duration\PYZsq{}, data=all\PYZus{}requests\PYZus{}sep, ax=axes[8])}
\PY{n}{sns}\PY{o}{.}\PY{n}{lineplot}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{y}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{data}\PY{o}{=}\PY{n}{all\PYZus{}requests\PYZus{}oct}\PY{p}{,} \PY{n}{ax}\PY{o}{=}\PY{n}{axes}\PY{p}{[}\PY{l+m+mi}{9}\PY{p}{]}\PY{p}{)}
\PY{c+c1}{\PYZsh{}sns.lineplot(x=\PYZsq{}Day\PYZsq{}, y=\PYZsq{}Duration\PYZsq{}, data=all\PYZus{}requests\PYZus{}nov, ax=axes[10])}
\PY{c+c1}{\PYZsh{}sns.lineplot(x=\PYZsq{}Day\PYZsq{}, y=\PYZsq{}Duration\PYZsq{}, data=all\PYZus{}requests\PYZus{}dec, ax=axes[11])`}
\end{Verbatim}
\end{tcolorbox}

    \subsection{2 - Microscopic view of a single
month}\label{microscopic-view-of-a-single-month}

    \paragraph{2.1 - All request durations for a single
month}\label{all-request-durations-for-a-single-month}

    DataFrame prep:

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{389}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{prep\PYZus{}data\PYZus{}2\PYZus{}1}\PY{p}{(}\PY{n}{month}\PY{p}{:} \PY{n+nb}{int}\PY{p}{,} \PY{n}{year}\PY{p}{:} \PY{n+nb}{int}\PY{p}{,} \PY{n}{exclude\PYZus{}weekends}\PY{p}{:} \PY{n+nb}{bool}\PY{p}{)} \PY{o}{\PYZhy{}}\PY{o}{\PYZgt{}} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{:}
    \PY{n}{df\PYZus{}2\PYZus{}1} \PY{o}{=} \PY{n}{get\PYZus{}df\PYZus{}requests\PYZus{}1\PYZus{}month}\PY{p}{(}\PY{n}{year}\PY{p}{,} \PY{n}{month}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    
    \PY{c+c1}{\PYZsh{} Exclude weekends:}
    \PY{k}{if} \PY{p}{(}\PY{n}{exclude\PYZus{}weekends}\PY{p}{)}\PY{p}{:}
        \PY{n}{df\PYZus{}2\PYZus{}1} \PY{o}{=} \PY{n}{get\PYZus{}df\PYZus{}no\PYZus{}weekends}\PY{p}{(}\PY{n}{df\PYZus{}2\PYZus{}1}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Weekday}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
\PY{c+c1}{\PYZsh{}     df\PYZus{}2\PYZus{}1.reset\PYZus{}index(inplace=True)}
    
    \PY{k}{return} \PY{n}{df\PYZus{}2\PYZus{}1}
\end{Verbatim}
\end{tcolorbox}

    \textbf{Load or reload data:}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{390}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{requests\PYZus{}single\PYZus{}month} \PY{o}{=} \PY{n}{prep\PYZus{}data\PYZus{}2\PYZus{}1}\PY{p}{(}
    \PY{n}{month}\PY{o}{=}\PY{l+m+mi}{7}\PY{p}{,}
    \PY{n}{year}\PY{o}{=}\PY{l+m+mi}{2019}\PY{p}{,}
    \PY{n}{exclude\PYZus{}weekends}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{391}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{requests\PYZus{}single\PYZus{}month}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{391}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
                         Duration    Year  Month  Week    Weekday  Day
StartTimeStamp
2019-07-03 16:21:26.300       0.0  2019.0    7.0  27.0  Wednesday  3.0
2019-07-03 16:21:32.103       0.0  2019.0    7.0  27.0  Wednesday  3.0
2019-07-03 16:21:40.863       1.0  2019.0    7.0  27.0  Wednesday  3.0
2019-07-03 16:21:43.840       1.0  2019.0    7.0  27.0  Wednesday  3.0
2019-07-03 16:21:52.540       0.0  2019.0    7.0  27.0  Wednesday  3.0
\end{Verbatim}
\end{tcolorbox}
        
    \subparagraph{2.1.1 - Plot of daily mean estimation of request duration,
1 month of
data}\label{plot-of-daily-mean-estimation-of-request-duration-1-month-of-data}

    \emph{Developer NOTE:} here, I changed the line on the plot that showed
all requests with the estimator=None variable from a sns.lineplot() to
an sns.scatterplot(). The line version was supposed to show all requests
by day but the data just looked like a soundwave, all over the place...
this was because it was grouping all the request data by day, since I
set the x-axis to 'Day', then drawing a line through all the
observations. Because there are many observations each day, ranging from
0 seconds to 100s of seconds or more, it was drawing a line from zero up
to very high on the y axis \emph{each day} and it looked very odd.
Showing the individual dots for each observation helps see why it looks
like this, and now we get an idea of how many observations are occuring
different times for each day. You can change the scatterplot back to a
line by replacing "sns.scatterplot" with "sns.lineplot".

We could also put the scatterplot on the year graphs above, but it would
probably look messy and just take longer to run.

    \textbf{Alter figure definitions:}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{375}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} all\PYZus{}req\PYZus{}line\PYZus{}color\PYZus{}2\PYZus{}1\PYZus{}1 = \PYZsq{}steelblue\PYZsq{}}
\PY{n}{mean\PYZus{}line\PYZus{}color\PYZus{}2\PYZus{}1\PYZus{}1} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lightcoral}\PY{l+s+s1}{\PYZsq{}}

\PY{c+c1}{\PYZsh{} Use this as a padding below 0 (we should not have any values under 0):}
\PY{n}{lower\PYZus{}y\PYZus{}lim\PYZus{}2\PYZus{}1\PYZus{}1} \PY{o}{=} \PY{o}{\PYZhy{}}\PY{l+m+mf}{0.15}

\PY{c+c1}{\PYZsh{} Use this as the max request time that will be shown on the plot (as to not skew the plot toward ridiculously high values):}
\PY{n}{upper\PYZus{}y\PYZus{}lim\PYZus{}2\PYZus{}1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{1000}

\PY{c+c1}{\PYZsh{} Set this to True if you would like the DataFrame to be deleted from memory after the figure is rendered:}
\PY{n}{clear\PYZus{}df\PYZus{}from\PYZus{}mem\PYZus{}2\PYZus{}1\PYZus{}1} \PY{o}{=} \PY{k+kc}{False}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{376}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{fig}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{15}\PY{p}{,}\PY{l+m+mi}{8}\PY{p}{)}\PY{p}{)}
\PY{n}{sns}\PY{o}{.}\PY{n}{set}\PY{p}{(}\PY{n}{style}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{darkgrid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{c+c1}{\PYZsh{} sns.scatterplot(x=\PYZsq{}StartTimeStamp\PYZsq{}, y=\PYZsq{}Duration\PYZsq{}, data=all\PYZus{}requests\PYZus{}single\PYZus{}month.reset\PYZus{}index())}
\PY{n}{sns}\PY{o}{.}\PY{n}{scatterplot}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{y}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{data}\PY{o}{=}\PY{n}{requests\PYZus{}single\PYZus{}month}\PY{p}{,} \PY{n}{estimator}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{n}{all\PYZus{}req\PYZus{}line\PYZus{}color\PYZus{}2\PYZus{}1\PYZus{}1}\PY{p}{,} \PY{n}{ax}\PY{o}{=}\PY{n}{ax}\PY{p}{)}
\PY{n}{sns}\PY{o}{.}\PY{n}{lineplot}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{y}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{data}\PY{o}{=}\PY{n}{requests\PYZus{}single\PYZus{}month}\PY{p}{,} \PY{n}{estimator}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{n}{mean\PYZus{}line\PYZus{}color\PYZus{}2\PYZus{}1\PYZus{}1}\PY{p}{,} \PY{n}{ax}\PY{o}{=}\PY{n}{ax}\PY{p}{)}

\PY{n}{place\PYZus{}month\PYZus{}names\PYZus{}on\PYZus{}axes}\PY{p}{(}\PY{n}{dataframe}\PY{o}{=}\PY{n}{requests\PYZus{}single\PYZus{}month}\PY{p}{,} \PY{n}{loc\PYZus{}str}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{left}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{font\PYZus{}size}\PY{o}{=}\PY{l+m+mi}{18}\PY{p}{,} \PY{n}{is\PYZus{}single\PYZus{}axes}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{ax}\PY{o}{=}\PY{n}{ax}\PY{p}{,} \PY{n}{df\PYZus{}month\PYZus{}col\PYZus{}name}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Monthly Mean Est. of Request Durations by Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{23}\PY{p}{)} \PY{c+c1}{\PYZsh{} Change to \PYZdq{}\PYZsq{}January\PYZsq{} Requests by Day\PYZdq{}}

\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{20}\PY{p}{)}
\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{20}\PY{p}{)}

\PY{c+c1}{\PYZsh{} If you would like to add back the \PYZdq{}all\PYZus{}req\PYZdq{} line, uncomment the line below: }
\PY{c+c1}{\PYZsh{} ax.legend(handles=(ax.lines[0], ax.lines[1]), labels=(\PYZsq{}All Request Durations\PYZsq{}, \PYZsq{}Mean Request Dur. per Day\PYZsq{}), borderpad=0.5, labelspacing=0.8, fontsize=15, loc=\PYZsq{}upper right\PYZsq{})}


\PY{n}{ax}\PY{o}{.}\PY{n}{tick\PYZus{}params}\PY{p}{(}\PY{n}{axis}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{which}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{major}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{labelsize}\PY{o}{=}\PY{l+m+mi}{15}\PY{p}{)}
\PY{c+c1}{\PYZsh{} ax.set\PYZus{}xticklabels(all\PYZus{}requests\PYZus{}single\PYZus{}month[\PYZsq{}Day\PYZsq{}])  \PYZsh{} Can\PYZsq{}t use this because it\PYZsq{}s taking it as a list of EACH day entry in the DF, and lineplot is aggregating day values.}
\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}yscale}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{symlog}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}ylim}\PY{p}{(}\PY{p}{[}\PY{n}{lower\PYZus{}y\PYZus{}lim\PYZus{}2\PYZus{}1\PYZus{}1}\PY{p}{,} \PY{n}{upper\PYZus{}y\PYZus{}lim\PYZus{}2\PYZus{}1\PYZus{}1}\PY{p}{]}\PY{p}{)}

\PY{k}{if} \PY{p}{(}\PY{n}{clear\PYZus{}df\PYZus{}from\PYZus{}mem\PYZus{}2\PYZus{}1\PYZus{}1}\PY{p}{)}\PY{p}{:}
    \PY{k}{del} \PY{n}{requests\PYZus{}single\PYZus{}month}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{datacell_request_time_final_files/datacell_request_time_final_88_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subparagraph{2.1.2 - Distribution of mean request time per
day}\label{distribution-of-mean-request-time-per-day}

    \textbf{Alter figure definitions:}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{392}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{all\PYZus{}req\PYZus{}line\PYZus{}color\PYZus{}2\PYZus{}1\PYZus{}2} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{steelblue}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{mean\PYZus{}line\PYZus{}color\PYZus{}2\PYZus{}1\PYZus{}2} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lightcoral}\PY{l+s+s1}{\PYZsq{}}

\PY{c+c1}{\PYZsh{} Use this as a padding below 0 (we should not have any values under 0):}
\PY{n}{lower\PYZus{}y\PYZus{}lim\PYZus{}2\PYZus{}1\PYZus{}2} \PY{o}{=} \PY{o}{\PYZhy{}}\PY{l+m+mf}{0.15}

\PY{c+c1}{\PYZsh{} Use this as the max request time that will be shown on the plot (as to not skew the plot toward ridiculously high values):}
\PY{n}{upper\PYZus{}y\PYZus{}lim\PYZus{}2\PYZus{}1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{1000}

\PY{c+c1}{\PYZsh{} Set this to True if you would like the DataFrame to be deleted from memory after the figure is rendered:}
\PY{n}{clear\PYZus{}df\PYZus{}from\PYZus{}mem\PYZus{}2\PYZus{}1\PYZus{}2} \PY{o}{=} \PY{k+kc}{False}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{397}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{fig}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{15}\PY{p}{,}\PY{l+m+mi}{8}\PY{p}{)}\PY{p}{)}
\PY{n}{sns}\PY{o}{.}\PY{n}{set}\PY{p}{(}\PY{n}{style}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{darkgrid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{sns}\PY{o}{.}\PY{n}{barplot}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{y}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{data}\PY{o}{=}\PY{n}{requests\PYZus{}single\PYZus{}month}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{n}{all\PYZus{}req\PYZus{}line\PYZus{}color\PYZus{}2\PYZus{}1\PYZus{}2}\PY{p}{,} \PY{n}{ax}\PY{o}{=}\PY{n}{ax}\PY{p}{)}

\PY{n}{place\PYZus{}month\PYZus{}names\PYZus{}on\PYZus{}axes}\PY{p}{(}\PY{n}{dataframe}\PY{o}{=}\PY{n}{requests\PYZus{}single\PYZus{}month}\PY{p}{,} \PY{n}{loc\PYZus{}str}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{left}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{font\PYZus{}size}\PY{o}{=}\PY{l+m+mi}{18}\PY{p}{,} \PY{n}{is\PYZus{}single\PYZus{}axes}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{ax}\PY{o}{=}\PY{n}{ax}\PY{p}{,} \PY{n}{df\PYZus{}month\PYZus{}col\PYZus{}name}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Distribution of Daily Mean Est. of Request Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{23}\PY{p}{)} \PY{c+c1}{\PYZsh{} Change to \PYZdq{}\PYZsq{}January\PYZsq{} Requests by Day\PYZdq{}}

\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{20}\PY{p}{)}
\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{20}\PY{p}{)}

\PY{n}{ax}\PY{o}{.}\PY{n}{tick\PYZus{}params}\PY{p}{(}\PY{n}{axis}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{which}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{major}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{labelsize}\PY{o}{=}\PY{l+m+mi}{15}\PY{p}{)}

\PY{k}{if} \PY{p}{(}\PY{n}{clear\PYZus{}df\PYZus{}from\PYZus{}mem\PYZus{}2\PYZus{}1\PYZus{}2}\PY{p}{)}\PY{p}{:}
    \PY{k}{del} \PY{n}{requests\PYZus{}single\PYZus{}month}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{datacell_request_time_final_files/datacell_request_time_final_92_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \paragraph{2.2 - Monthly stats aggregated per
day}\label{monthly-stats-aggregated-per-day}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{107}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{prep\PYZus{}data\PYZus{}daily\PYZus{}stats\PYZus{}2\PYZus{}2}\PY{p}{(}\PY{n}{month}\PY{p}{:} \PY{n+nb}{int}\PY{p}{,} \PY{n}{year}\PY{p}{:} \PY{n+nb}{int}\PY{p}{,} \PY{n}{exclude\PYZus{}weekends}\PY{p}{:} \PY{n+nb}{bool}\PY{p}{)}\PY{p}{:}
    \PY{n}{base\PYZus{}data\PYZus{}month} \PY{o}{=} \PY{n}{get\PYZus{}df\PYZus{}requests\PYZus{}1\PYZus{}month}\PY{p}{(}\PY{n}{year}\PY{p}{,} \PY{n}{month}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    
    \PY{c+c1}{\PYZsh{} Exclude weekends:}
    \PY{k}{if} \PY{p}{(}\PY{n}{exclude\PYZus{}weekends}\PY{p}{)}\PY{p}{:}
        \PY{n}{base\PYZus{}data\PYZus{}month} \PY{o}{=} \PY{n}{get\PYZus{}df\PYZus{}no\PYZus{}weekends}\PY{p}{(}\PY{n}{base\PYZus{}data\PYZus{}month}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Weekday}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
    \PY{n}{df\PYZus{}2\PYZus{}2} \PY{o}{=} \PY{n}{base\PYZus{}data\PYZus{}month}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{n}{pd}\PY{o}{.}\PY{n}{Grouper}\PY{p}{(}\PY{n}{freq}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{D}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{agg}\PY{p}{(}
    \PY{n}{Min\PYZus{}Duration}\PY{o}{=}\PY{n}{pd}\PY{o}{.}\PY{n}{NamedAgg}\PY{p}{(}\PY{n}{column}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{aggfunc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{min}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
    \PY{n}{Max\PYZus{}Duration}\PY{o}{=}\PY{n}{pd}\PY{o}{.}\PY{n}{NamedAgg}\PY{p}{(}\PY{n}{column}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{aggfunc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
    \PY{n}{Mean\PYZus{}Duration}\PY{o}{=}\PY{n}{pd}\PY{o}{.}\PY{n}{NamedAgg}\PY{p}{(}\PY{n}{column}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{aggfunc}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{)}\PY{p}{,}
    \PY{n}{Count\PYZus{}Durations}\PY{o}{=}\PY{n}{pd}\PY{o}{.}\PY{n}{NamedAgg}\PY{p}{(}\PY{n}{column}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{aggfunc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{count}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
    \PY{n}{Day}\PY{o}{=}\PY{n}{pd}\PY{o}{.}\PY{n}{NamedAgg}\PY{p}{(}\PY{n}{column}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{aggfunc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
    \PY{n}{Month}\PY{o}{=}\PY{n}{pd}\PY{o}{.}\PY{n}{NamedAgg}\PY{p}{(}\PY{n}{column}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{aggfunc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{c+c1}{\PYZsh{}     Weekday=pd.NamedAgg(column=\PYZsq{}Duration\PYZsq{}, aggfunc=np.first)}
    \PY{p}{)}
    
    \PY{n}{df\PYZus{}2\PYZus{}2}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
    
    \PY{c+c1}{\PYZsh{} Convert date columns to integers so that a) they take up less space and b) so that they work with \PYZdq{}place\PYZus{}month\PYZus{}names\PYZus{}on\PYZus{}axes()\PYZdq{}}
    \PY{n}{df\PYZus{}2\PYZus{}2}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]} \PY{o}{=} \PY{n}{df\PYZus{}2\PYZus{}2}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{int16}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

    \PY{k}{return} \PY{n}{df\PYZus{}2\PYZus{}2}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{108}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{daily\PYZus{}stats\PYZus{}month} \PY{o}{=} \PY{n}{prep\PYZus{}data\PYZus{}daily\PYZus{}stats\PYZus{}2\PYZus{}2}\PY{p}{(}
    \PY{n}{month}\PY{o}{=}\PY{l+m+mi}{4}\PY{p}{,}
    \PY{n}{year}\PY{o}{=}\PY{l+m+mi}{2018}\PY{p}{,}
    \PY{n}{exclude\PYZus{}weekends}\PY{o}{=}\PY{k+kc}{True}
\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{109}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{daily\PYZus{}stats\PYZus{}month}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{109}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
                Min\_Duration  Max\_Duration  Mean\_Duration  Count\_Durations  \textbackslash{}
StartTimeStamp
2018-04-02               0.0          76.0       1.514843             3638
2018-04-03               0.0          46.0       1.425372             6653
2018-04-04               0.0         164.0       1.569870             8430
2018-04-05               0.0          46.0       1.478043            11386
2018-04-06               0.0          91.0       1.641034            11912

                Day  Month
StartTimeStamp
2018-04-02        2      4
2018-04-03        3      4
2018-04-04        4      4
2018-04-05        5      4
2018-04-06        6      4
\end{Verbatim}
\end{tcolorbox}
        
    \subparagraph{2.2.1 - Plot of daily mean, max, and min of req. durations
and req. load, for 1
month}\label{plot-of-daily-mean-max-and-min-of-req.-durations-and-req.-load-for-1-month}

    \textbf{Alter figure definitions:}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{111}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{marker\PYZus{}size\PYZus{}2\PYZus{}2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{60}

\PY{n}{mean\PYZus{}line\PYZus{}color\PYZus{}2\PYZus{}2\PYZus{}1} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}ffaa00}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{max\PYZus{}line\PYZus{}color\PYZus{}2\PYZus{}2\PYZus{}1} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}bb311b}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{min\PYZus{}line\PYZus{}color\PYZus{}2\PYZus{}2\PYZus{}1} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}54b536}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{count\PYZus{}line\PYZus{}color\PYZus{}2\PYZus{}2\PYZus{}1} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}224B8B}\PY{l+s+s1}{\PYZsq{}}

\PY{c+c1}{\PYZsh{} Use this as a padding below 0 (we should not have any values under 0):}
\PY{n}{lower\PYZus{}y\PYZus{}lim} \PY{o}{=} \PY{o}{\PYZhy{}}\PY{l+m+mf}{0.15}

\PY{c+c1}{\PYZsh{} Use this as the max request time that will be shown on the plot (as to not skew the plot toward ridiculously high values):}
\PY{n}{upper\PYZus{}y\PYZus{}lim} \PY{o}{=} \PY{l+m+mi}{100000}

\PY{c+c1}{\PYZsh{} Set this to True if you would like the DataFrame to be deleted from memory after the figure is rendered:}
\PY{n}{clear\PYZus{}df\PYZus{}from\PYZus{}mem\PYZus{}2\PYZus{}2\PYZus{}1} \PY{o}{=} \PY{k+kc}{True}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{112}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{fig}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{15}\PY{p}{,}\PY{l+m+mi}{8}\PY{p}{)}\PY{p}{)}
\PY{n}{sns}\PY{o}{.}\PY{n}{set}\PY{p}{(}\PY{n}{style}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{darkgrid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{c+c1}{\PYZsh{} sns.scatterplot(x=\PYZsq{}StartTimeStamp\PYZsq{}, y=\PYZsq{}Duration\PYZsq{}, data=all\PYZus{}requests\PYZus{}single\PYZus{}month.reset\PYZus{}index())}
\PY{n}{sns}\PY{o}{.}\PY{n}{lineplot}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{y}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mean\PYZus{}Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{data}\PY{o}{=}\PY{n}{daily\PYZus{}stats\PYZus{}month}\PY{p}{,} \PY{n}{estimator}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{n}{mean\PYZus{}line\PYZus{}color\PYZus{}2\PYZus{}2\PYZus{}1}\PY{p}{)}
\PY{n}{sns}\PY{o}{.}\PY{n}{lineplot}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{y}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Max\PYZus{}Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{data}\PY{o}{=}\PY{n}{daily\PYZus{}stats\PYZus{}month}\PY{p}{,} \PY{n}{estimator}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{n}{max\PYZus{}line\PYZus{}color\PYZus{}2\PYZus{}2\PYZus{}1}\PY{p}{)}
\PY{n}{sns}\PY{o}{.}\PY{n}{lineplot}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{y}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Min\PYZus{}Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{data}\PY{o}{=}\PY{n}{daily\PYZus{}stats\PYZus{}month}\PY{p}{,} \PY{n}{estimator}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{n}{min\PYZus{}line\PYZus{}color\PYZus{}2\PYZus{}2\PYZus{}1}\PY{p}{)}
\PY{n}{sns}\PY{o}{.}\PY{n}{lineplot}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{y}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Count\PYZus{}Durations}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{data}\PY{o}{=}\PY{n}{daily\PYZus{}stats\PYZus{}month}\PY{p}{,} \PY{n}{estimator}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{n}{count\PYZus{}line\PYZus{}color\PYZus{}2\PYZus{}2\PYZus{}1}\PY{p}{)}

\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Monthly Requests by Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{23}\PY{p}{)} \PY{c+c1}{\PYZsh{} Change to \PYZdq{}\PYZsq{}January\PYZsq{} Requests by Day\PYZdq{}}

\PY{n}{place\PYZus{}month\PYZus{}names\PYZus{}on\PYZus{}axes}\PY{p}{(}\PY{n}{dataframe}\PY{o}{=}\PY{n}{daily\PYZus{}stats\PYZus{}month}\PY{p}{,} \PY{n}{loc\PYZus{}str}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{left}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{font\PYZus{}size}\PY{o}{=}\PY{l+m+mi}{18}\PY{p}{,} \PY{n}{is\PYZus{}single\PYZus{}axes}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{ax}\PY{o}{=}\PY{n}{ax}\PY{p}{,} \PY{n}{df\PYZus{}month\PYZus{}col\PYZus{}name}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{20}\PY{p}{)}
\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{20}\PY{p}{)}

\PY{n}{fig}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{handles}\PY{o}{=}\PY{p}{(}\PY{n}{ax}\PY{o}{.}\PY{n}{lines}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{ax}\PY{o}{.}\PY{n}{lines}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{ax}\PY{o}{.}\PY{n}{lines}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,} \PY{n}{ax}\PY{o}{.}\PY{n}{lines}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n}{labels}\PY{o}{=}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mean Req. Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Max Req. Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Min Req. Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Count/Load of Requests}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{p}{)}\PY{p}{,} \PY{n}{borderpad}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{labelspacing}\PY{o}{=}\PY{l+m+mf}{0.8}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{15}\PY{p}{,} \PY{n}{loc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{upper right}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{n}{ax}\PY{o}{.}\PY{n}{tick\PYZus{}params}\PY{p}{(}\PY{n}{axis}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{which}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{major}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{labelsize}\PY{o}{=}\PY{l+m+mi}{15}\PY{p}{)}
\PY{c+c1}{\PYZsh{} ax.set\PYZus{}xticklabels(all\PYZus{}requests\PYZus{}single\PYZus{}month[\PYZsq{}Day\PYZsq{}])  \PYZsh{} Can\PYZsq{}t use this because it\PYZsq{}s taking it as a list of EACH day entry in the DF, and lineplot is aggregating day values.}
\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}yscale}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{symlog}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}ylim}\PY{p}{(}\PY{p}{[}\PY{n}{lower\PYZus{}y\PYZus{}lim}\PY{p}{,} \PY{n}{upper\PYZus{}y\PYZus{}lim}\PY{p}{]}\PY{p}{)}

\PY{n}{fig}\PY{o}{.}\PY{n}{subplots\PYZus{}adjust}\PY{p}{(}\PY{n}{top}\PY{o}{=}\PY{l+m+mf}{0.8}\PY{p}{,} \PY{n}{left}\PY{o}{=}\PY{l+m+mf}{0.125}\PY{p}{,} \PY{n}{right}\PY{o}{=}\PY{l+m+mf}{0.96}\PY{p}{,} \PY{n}{hspace}\PY{o}{=}\PY{l+m+mf}{0.2}\PY{p}{,} \PY{n}{wspace}\PY{o}{=}\PY{l+m+mf}{0.2}\PY{p}{)}  \PY{c+c1}{\PYZsh{} These are magic numbers, do not adjust.}

\PY{k}{if} \PY{p}{(}\PY{n}{clear\PYZus{}df\PYZus{}from\PYZus{}mem\PYZus{}2\PYZus{}2\PYZus{}1}\PY{p}{)}\PY{p}{:}
    \PY{k}{del} \PY{n}{daily\PYZus{}stats\PYZus{}month}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{datacell_request_time_final_files/datacell_request_time_final_100_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsection{3. Analyses of request durations and load over 3
months}\label{analyses-of-request-durations-and-load-over-3-months}

    \emph{Developer NOTE:} Consider eliminating months that we don't need
directly in sql...

    DataFrame prep:

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{243}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{prep\PYZus{}base\PYZus{}data\PYZus{}3}\PY{p}{(}\PY{n}{start\PYZus{}month}\PY{p}{:} \PY{n+nb}{int}\PY{p}{,} \PY{n}{end\PYZus{}month}\PY{p}{:} \PY{n+nb}{int}\PY{p}{,} \PY{n}{year}\PY{p}{:} \PY{n+nb}{int}\PY{p}{,} \PY{n}{exclude\PYZus{}weekends}\PY{p}{:} \PY{n+nb}{bool}\PY{p}{)} \PY{o}{\PYZhy{}}\PY{o}{\PYZgt{}} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{:}
   
    \PY{c+c1}{\PYZsh{} Select only month and year specified:}
    \PY{n}{base\PYZus{}df\PYZus{}3} \PY{o}{=} \PY{n}{get\PYZus{}df\PYZus{}requests\PYZus{}month\PYZus{}range}\PY{p}{(}\PY{n}{year}\PY{p}{,} \PY{n}{start\PYZus{}month}\PY{p}{,} \PY{n}{end\PYZus{}month}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    
    \PY{c+c1}{\PYZsh{} Exclude weekends:}
    \PY{k}{if} \PY{p}{(}\PY{n}{exclude\PYZus{}weekends}\PY{p}{)}\PY{p}{:}
        \PY{n}{base\PYZus{}df\PYZus{}3} \PY{o}{=} \PY{n}{get\PYZus{}df\PYZus{}no\PYZus{}weekends}\PY{p}{(}\PY{n}{base\PYZus{}df\PYZus{}3}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Weekday}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

    \PY{k}{return} \PY{n}{base\PYZus{}df\PYZus{}3}
\end{Verbatim}
\end{tcolorbox}

    \paragraph{\texorpdfstring{3.1 - Lineplots of \emph{weekly} request
data, over 3
months}{3.1 - Lineplots of weekly request data, over 3 months}}\label{lineplots-of-weekly-request-data-over-3-months}

    Function to aggregate the weekly data:

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{244}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{prep\PYZus{}weekly\PYZus{}data\PYZus{}3\PYZus{}1}\PY{p}{(}\PY{n}{start\PYZus{}month}\PY{p}{:} \PY{n+nb}{int}\PY{p}{,} \PY{n}{end\PYZus{}month}\PY{p}{:} \PY{n+nb}{int}\PY{p}{,} \PY{n}{year}\PY{p}{:} \PY{n+nb}{int}\PY{p}{,} \PY{n}{exclude\PYZus{}weekends}\PY{p}{:} \PY{n+nb}{bool}\PY{p}{)} \PY{o}{\PYZhy{}}\PY{o}{\PYZgt{}} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{:}
    
    \PY{n}{base\PYZus{}df\PYZus{}3} \PY{o}{=} \PY{n}{prep\PYZus{}base\PYZus{}data\PYZus{}3}\PY{p}{(}\PY{n}{start\PYZus{}month}\PY{p}{,} \PY{n}{end\PYZus{}month}\PY{p}{,} \PY{n}{year}\PY{p}{,} \PY{n}{exclude\PYZus{}weekends}\PY{p}{)}
    
    \PY{c+c1}{\PYZsh{} Aggregate Duration for min, max and count over each week (using named aggregation, which drops all non\PYZhy{}aggregated, non\PYZhy{}index cols):}
    \PY{n}{week\PYZus{}aggs} \PY{o}{=} \PY{n}{base\PYZus{}df\PYZus{}3}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{n}{pd}\PY{o}{.}\PY{n}{Grouper}\PY{p}{(}\PY{n}{freq}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{W}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{agg}\PY{p}{(}
    \PY{n}{Min\PYZus{}Duration}\PY{o}{=}\PY{n}{pd}\PY{o}{.}\PY{n}{NamedAgg}\PY{p}{(}\PY{n}{column}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{aggfunc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{min}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
    \PY{n}{Max\PYZus{}Duration}\PY{o}{=}\PY{n}{pd}\PY{o}{.}\PY{n}{NamedAgg}\PY{p}{(}\PY{n}{column}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{aggfunc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
\PY{c+c1}{\PYZsh{}     Mean\PYZus{}Duration=pd.NamedAgg(column=\PYZsq{}Duration\PYZsq{}, aggfunc=np.mean),}
    \PY{n}{Count\PYZus{}Durations}\PY{o}{=}\PY{n}{pd}\PY{o}{.}\PY{n}{NamedAgg}\PY{p}{(}\PY{n}{column}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{aggfunc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{count}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
    \PY{n}{Week}\PY{o}{=}\PY{n}{pd}\PY{o}{.}\PY{n}{NamedAgg}\PY{p}{(}\PY{n}{column}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{aggfunc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
    \PY{n}{First\PYZus{}Day}\PY{o}{=}\PY{n}{pd}\PY{o}{.}\PY{n}{NamedAgg}\PY{p}{(}\PY{n}{column}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{aggfunc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{min}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
    \PY{n}{Last\PYZus{}Day}\PY{o}{=}\PY{n}{pd}\PY{o}{.}\PY{n}{NamedAgg}\PY{p}{(}\PY{n}{column}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{aggfunc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{c+c1}{\PYZsh{}     Weekday=pd.NamedAgg(column=\PYZsq{}Duration\PYZsq{}, aggfunc=np.first)}
    \PY{p}{)}
    
    \PY{c+c1}{\PYZsh{} Do the last aggregation that was left out above with a simple groupby() and save in a second dataframe:}
    \PY{n}{week\PYZus{}agg\PYZus{}mean} \PY{o}{=} \PY{n}{base\PYZus{}df\PYZus{}3}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{n}{pd}\PY{o}{.}\PY{n}{Grouper}\PY{p}{(}\PY{n}{freq}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{W}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}
    \PY{n}{week\PYZus{}agg\PYZus{}mean} \PY{o}{=} \PY{n}{week\PYZus{}agg\PYZus{}mean}\PY{o}{.}\PY{n}{rename}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mean\PYZus{}Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{)}
    \PY{n}{week\PYZus{}agg\PYZus{}mean}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
    \PY{n}{week\PYZus{}agg\PYZus{}mean}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)} \PY{c+c1}{\PYZsh{} use this form elsewhere!}
    
    \PY{c+c1}{\PYZsh{} Now there are 2 DFs that need to merge:}
    \PY{n}{df\PYZus{}3\PYZus{}1} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{merge}\PY{p}{(}\PY{n}{week\PYZus{}aggs}\PY{p}{,} \PY{n}{week\PYZus{}agg\PYZus{}mean}\PY{p}{,} \PY{n}{on}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{c+c1}{\PYZsh{} Add a \PYZdq{}Week\PYZus{}Label\PYZdq{} column that can be used as a label for the plot, describing the month and the day\PYZhy{}range of the given week:}
    \PY{n}{df\PYZus{}3\PYZus{}1}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Week\PYZus{}Label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df\PYZus{}3\PYZus{}1}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{int}\PY{p}{)}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{str}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n}{df\PYZus{}3\PYZus{}1}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{int}\PY{p}{)}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{str}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ days: }\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n}{df\PYZus{}3\PYZus{}1}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{First\PYZus{}Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{int}\PY{p}{)}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{str}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n}{df\PYZus{}3\PYZus{}1}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Last\PYZus{}Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{int}\PY{p}{)}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{str}\PY{p}{)}
    \PY{c+c1}{\PYZsh{} Drop columns that we only needed temporarily, to create the Week\PYZus{}Label above:}
    \PY{n}{df\PYZus{}3\PYZus{}1}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{First\PYZus{}Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Last\PYZus{}Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}

    \PY{c+c1}{\PYZsh{} Lastly, reset the indexes for both final DFs back to the default integer index, so that the \PYZsq{}Week\PYZsq{} column can be used by plotting functions without complaints:}
    \PY{n}{df\PYZus{}3\PYZus{}1}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\PY{c+c1}{\PYZsh{}     longform\PYZus{}dur\PYZus{}stats\PYZus{}3\PYZus{}mon\PYZus{}by\PYZus{}wk.reset\PYZus{}index(inplace=True)}
        
    \PY{k}{return} \PY{n}{df\PYZus{}3\PYZus{}1}
\end{Verbatim}
\end{tcolorbox}

    \textbf{Load or reload data:}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{246}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} RUN THIS CELL TO RESET DATA:}
\PY{n}{request\PYZus{}stats\PYZus{}3\PYZus{}mo\PYZus{}wk} \PY{o}{=} \PY{n}{prep\PYZus{}weekly\PYZus{}data\PYZus{}3\PYZus{}1}\PY{p}{(}
    \PY{n}{start\PYZus{}month}\PY{o}{=}\PY{l+m+mi}{6}\PY{p}{,}
    \PY{n}{end\PYZus{}month}\PY{o}{=}\PY{l+m+mi}{8}\PY{p}{,}
    \PY{n}{year}\PY{o}{=}\PY{l+m+mi}{2019}\PY{p}{,}
    \PY{n}{exclude\PYZus{}weekends}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    View the DataFrame that will be plotted:

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{349}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{request\PYZus{}stats\PYZus{}3\PYZus{}mo\PYZus{}wk}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{349}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
   index  Min\_Duration  Max\_Duration  Count\_Durations  Week  Mean\_Duration  \textbackslash{}
0      0           0.0         588.0            39789  23.0       1.775290
1      1           0.0         412.0            18557  24.0       1.674301
2      2           0.0         353.0             9937  25.0       2.144611
3      3           0.0         407.0             5121  26.0       2.539348
4      4           0.0         621.0             6939  27.0       2.014844
5      5           0.0         587.0             7229  28.0       6.263660
6      6           0.0         436.0             5520  29.0       5.178080
7      7           0.0         349.0             4851  30.0       3.168419
8      8           0.0         369.0             5118  31.0       2.198710

           Week\_Label
0    2019/6 days: 3-7
1  2019/6 days: 10-14
2  2019/6 days: 17-21
3  2019/6 days: 24-28
4    2019/7 days: 1-5
5   2019/7 days: 8-12
6  2019/7 days: 15-19
7  2019/7 days: 22-26
8   2019/7 days: 1-31
\end{Verbatim}
\end{tcolorbox}
        
    \subparagraph{3.1.1 - Lineplot of mean request time vs. request
load/count for each
week}\label{lineplot-of-mean-request-time-vs.-request-loadcount-for-each-week}

    \textbf{Alter figure definitions:}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{249}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{marker\PYZus{}size\PYZus{}3\PYZus{}1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{150}

\PY{n}{mean\PYZus{}line\PYZus{}color\PYZus{}3\PYZus{}1\PYZus{}1} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}3FAA75}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{count\PYZus{}line\PYZus{}color\PYZus{}3\PYZus{}1\PYZus{}1} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}AB1B53}\PY{l+s+s1}{\PYZsq{}}

\PY{c+c1}{\PYZsh{} Set this to True if you would like the DataFrame to be deleted from memory after the figure is rendered:}
\PY{n}{clear\PYZus{}df\PYZus{}from\PYZus{}mem\PYZus{}3\PYZus{}1\PYZus{}1} \PY{o}{=} \PY{k+kc}{False}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{250}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{sns}\PY{o}{.}\PY{n}{set\PYZus{}style}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{darkgrid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{n}{fig}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{20}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{)}

\PY{c+c1}{\PYZsh{} nice green: \PYZsh{}3FAA75}
\PY{n}{sns}\PY{o}{.}\PY{n}{lineplot}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{y}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mean\PYZus{}Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{data}\PY{o}{=}\PY{n}{request\PYZus{}stats\PYZus{}3\PYZus{}mo\PYZus{}wk}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{n}{mean\PYZus{}line\PYZus{}color\PYZus{}3\PYZus{}1\PYZus{}1}\PY{p}{,} \PY{n}{ax}\PY{o}{=}\PY{n}{ax}\PY{p}{)}
\PY{n}{sns}\PY{o}{.}\PY{n}{scatterplot}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{y}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mean\PYZus{}Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{data}\PY{o}{=}\PY{n}{request\PYZus{}stats\PYZus{}3\PYZus{}mo\PYZus{}wk}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{n}{mean\PYZus{}line\PYZus{}color\PYZus{}3\PYZus{}1\PYZus{}1}\PY{p}{,} \PY{n}{s}\PY{o}{=}\PY{n}{marker\PYZus{}size\PYZus{}3\PYZus{}1\PYZus{}1}\PY{p}{,} \PY{n}{ax}\PY{o}{=}\PY{n}{ax}\PY{p}{)}
\PY{n}{sns}\PY{o}{.}\PY{n}{lineplot}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{y}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Count\PYZus{}Durations}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{data}\PY{o}{=}\PY{n}{request\PYZus{}stats\PYZus{}3\PYZus{}mo\PYZus{}wk}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{n}{count\PYZus{}line\PYZus{}color\PYZus{}3\PYZus{}1\PYZus{}1}\PY{p}{,} \PY{n}{ax}\PY{o}{=}\PY{n}{ax}\PY{p}{)}
\PY{n}{sns}\PY{o}{.}\PY{n}{scatterplot}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{y}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Count\PYZus{}Durations}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{data}\PY{o}{=}\PY{n}{request\PYZus{}stats\PYZus{}3\PYZus{}mo\PYZus{}wk}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{n}{count\PYZus{}line\PYZus{}color\PYZus{}3\PYZus{}1\PYZus{}1}\PY{p}{,} \PY{n}{s}\PY{o}{=}\PY{n}{marker\PYZus{}size\PYZus{}3\PYZus{}1\PYZus{}1}\PY{p}{,} \PY{n}{ax}\PY{o}{=}\PY{n}{ax}\PY{p}{)}

\PY{n}{fig}\PY{o}{.}\PY{n}{subplots\PYZus{}adjust}\PY{p}{(}\PY{n}{top}\PY{o}{=}\PY{l+m+mf}{0.9}\PY{p}{,} \PY{n}{bottom}\PY{o}{=}\PY{l+m+mf}{0.1}\PY{p}{,} \PY{n}{left}\PY{o}{=}\PY{l+m+mf}{0.125}\PY{p}{,} \PY{n}{right}\PY{o}{=}\PY{l+m+mf}{0.9}\PY{p}{,} \PY{n}{hspace}\PY{o}{=}\PY{l+m+mf}{0.2}\PY{p}{,} \PY{n}{wspace}\PY{o}{=}\PY{l+m+mf}{0.2}\PY{p}{)} \PY{c+c1}{\PYZsh{} This is magic code...}

\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}yscale}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{symlog}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}  \PY{c+c1}{\PYZsh{} Retain zero values}
\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}ylim}\PY{p}{(}\PY{n}{bottom}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.25}\PY{p}{)}  \PY{c+c1}{\PYZsh{} 0 doesn\PYZsq{}t work... }

\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Request Duration Stats}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{20}\PY{p}{,} \PY{n}{labelpad}\PY{o}{=}\PY{l+m+mi}{15}\PY{p}{)}
\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{20}\PY{p}{,} \PY{n}{labelpad}\PY{o}{=}\PY{l+m+mi}{20}\PY{p}{)}

\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mean Request Durations and Request Load by Week (3 mo.)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{loc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{center}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{25}\PY{p}{)}

\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xticks}\PY{p}{(}\PY{n}{request\PYZus{}stats\PYZus{}3\PYZus{}mo\PYZus{}wk}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xticklabels}\PY{p}{(}\PY{n}{request\PYZus{}stats\PYZus{}3\PYZus{}mo\PYZus{}wk}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Week\PYZus{}Label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{rotation}\PY{o}{=}\PY{l+m+mi}{45}\PY{p}{)}
\PY{n}{ax}\PY{o}{.}\PY{n}{tick\PYZus{}params}\PY{p}{(}\PY{n}{axis}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{which}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{major}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{labelsize}\PY{o}{=}\PY{l+m+mi}{20}\PY{p}{)}

\PY{n}{ax}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Load}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,} \PY{n}{borderpad}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{labelspacing}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{18}\PY{p}{,} \PY{n}{shadow}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}

\PY{k}{if} \PY{p}{(}\PY{n}{clear\PYZus{}df\PYZus{}from\PYZus{}mem\PYZus{}3\PYZus{}1\PYZus{}1}\PY{p}{)}\PY{p}{:}
    \PY{k}{del} \PY{n}{request\PYZus{}stats\PYZus{}3\PYZus{}mo\PYZus{}wk}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{datacell_request_time_final_files/datacell_request_time_final_115_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subparagraph{3.1.2 - Lineplot of all weekly stats, over 3
months}\label{lineplot-of-all-weekly-stats-over-3-months}

    \textbf{Alter figure definitions:}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{251}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{marker\PYZus{}size\PYZus{}3\PYZus{}1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{150}

\PY{n}{mean\PYZus{}line\PYZus{}color\PYZus{}3\PYZus{}1\PYZus{}2} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}F7941D}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{max\PYZus{}line\PYZus{}color\PYZus{}3\PYZus{}1\PYZus{}2} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}DE3354}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{min\PYZus{}line\PYZus{}color\PYZus{}3\PYZus{}1\PYZus{}2} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}36B449}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{count\PYZus{}line\PYZus{}color\PYZus{}3\PYZus{}1\PYZus{}2} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}135A8E}\PY{l+s+s1}{\PYZsq{}}

\PY{c+c1}{\PYZsh{} Set this to True if you would like the DataFrame to be deleted from memory after the figure is rendered:}
\PY{n}{clear\PYZus{}df\PYZus{}from\PYZus{}mem\PYZus{}3\PYZus{}1\PYZus{}2} \PY{o}{=} \PY{k+kc}{False}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{252}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{sns}\PY{o}{.}\PY{n}{set\PYZus{}style}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{darkgrid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{n}{fig}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{20}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{)}

\PY{c+c1}{\PYZsh{} nice green: \PYZsh{}3FAA75}
\PY{n}{sns}\PY{o}{.}\PY{n}{lineplot}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{y}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mean\PYZus{}Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{data}\PY{o}{=}\PY{n}{request\PYZus{}stats\PYZus{}3\PYZus{}mo\PYZus{}wk}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{n}{mean\PYZus{}line\PYZus{}color\PYZus{}3\PYZus{}1\PYZus{}2}\PY{p}{,} \PY{n}{ax}\PY{o}{=}\PY{n}{ax}\PY{p}{)}
\PY{n}{sns}\PY{o}{.}\PY{n}{scatterplot}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{y}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mean\PYZus{}Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{data}\PY{o}{=}\PY{n}{request\PYZus{}stats\PYZus{}3\PYZus{}mo\PYZus{}wk}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{n}{mean\PYZus{}line\PYZus{}color\PYZus{}3\PYZus{}1\PYZus{}2}\PY{p}{,} \PY{n}{s}\PY{o}{=}\PY{n}{marker\PYZus{}size\PYZus{}3\PYZus{}1\PYZus{}2}\PY{p}{,} \PY{n}{ax}\PY{o}{=}\PY{n}{ax}\PY{p}{)}

\PY{n}{sns}\PY{o}{.}\PY{n}{lineplot}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{y}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Max\PYZus{}Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{data}\PY{o}{=}\PY{n}{request\PYZus{}stats\PYZus{}3\PYZus{}mo\PYZus{}wk}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{n}{max\PYZus{}line\PYZus{}color\PYZus{}3\PYZus{}1\PYZus{}2}\PY{p}{,} \PY{n}{ax}\PY{o}{=}\PY{n}{ax}\PY{p}{)}
\PY{n}{sns}\PY{o}{.}\PY{n}{scatterplot}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{y}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Max\PYZus{}Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{data}\PY{o}{=}\PY{n}{request\PYZus{}stats\PYZus{}3\PYZus{}mo\PYZus{}wk}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{n}{max\PYZus{}line\PYZus{}color\PYZus{}3\PYZus{}1\PYZus{}2}\PY{p}{,} \PY{n}{s}\PY{o}{=}\PY{n}{marker\PYZus{}size\PYZus{}3\PYZus{}1\PYZus{}2}\PY{p}{,} \PY{n}{ax}\PY{o}{=}\PY{n}{ax}\PY{p}{)}

\PY{n}{sns}\PY{o}{.}\PY{n}{lineplot}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{y}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Min\PYZus{}Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{data}\PY{o}{=}\PY{n}{request\PYZus{}stats\PYZus{}3\PYZus{}mo\PYZus{}wk}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{n}{min\PYZus{}line\PYZus{}color\PYZus{}3\PYZus{}1\PYZus{}2}\PY{p}{,} \PY{n}{ax}\PY{o}{=}\PY{n}{ax}\PY{p}{)}
\PY{n}{sns}\PY{o}{.}\PY{n}{scatterplot}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{y}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Min\PYZus{}Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{data}\PY{o}{=}\PY{n}{request\PYZus{}stats\PYZus{}3\PYZus{}mo\PYZus{}wk}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{n}{min\PYZus{}line\PYZus{}color\PYZus{}3\PYZus{}1\PYZus{}2}\PY{p}{,} \PY{n}{s}\PY{o}{=}\PY{n}{marker\PYZus{}size\PYZus{}3\PYZus{}1\PYZus{}2}\PY{p}{,} \PY{n}{ax}\PY{o}{=}\PY{n}{ax}\PY{p}{)}

\PY{n}{sns}\PY{o}{.}\PY{n}{lineplot}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{y}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Count\PYZus{}Durations}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{data}\PY{o}{=}\PY{n}{request\PYZus{}stats\PYZus{}3\PYZus{}mo\PYZus{}wk}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{n}{count\PYZus{}line\PYZus{}color\PYZus{}3\PYZus{}1\PYZus{}2}\PY{p}{,} \PY{n}{ax}\PY{o}{=}\PY{n}{ax}\PY{p}{)}
\PY{n}{sns}\PY{o}{.}\PY{n}{scatterplot}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{y}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Count\PYZus{}Durations}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{data}\PY{o}{=}\PY{n}{request\PYZus{}stats\PYZus{}3\PYZus{}mo\PYZus{}wk}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{n}{count\PYZus{}line\PYZus{}color\PYZus{}3\PYZus{}1\PYZus{}2}\PY{p}{,} \PY{n}{s}\PY{o}{=}\PY{n}{marker\PYZus{}size\PYZus{}3\PYZus{}1\PYZus{}2}\PY{p}{,} \PY{n}{ax}\PY{o}{=}\PY{n}{ax}\PY{p}{)}

\PY{n}{fig}\PY{o}{.}\PY{n}{subplots\PYZus{}adjust}\PY{p}{(}\PY{n}{top}\PY{o}{=}\PY{l+m+mf}{0.9}\PY{p}{,} \PY{n}{bottom}\PY{o}{=}\PY{l+m+mf}{0.1}\PY{p}{,} \PY{n}{left}\PY{o}{=}\PY{l+m+mf}{0.1}\PY{p}{,} \PY{n}{right}\PY{o}{=}\PY{l+m+mf}{0.9}\PY{p}{,} \PY{n}{hspace}\PY{o}{=}\PY{l+m+mf}{0.2}\PY{p}{,} \PY{n}{wspace}\PY{o}{=}\PY{l+m+mf}{0.2}\PY{p}{)} \PY{c+c1}{\PYZsh{} This is magic code...}

\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}yscale}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{symlog}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}  \PY{c+c1}{\PYZsh{} Retain zero values}
\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}ylim}\PY{p}{(}\PY{n}{bottom}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.25}\PY{p}{)}  \PY{c+c1}{\PYZsh{} 0 doesn\PYZsq{}t work... }

\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Request Duration Stats}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{20}\PY{p}{,} \PY{n}{labelpad}\PY{o}{=}\PY{l+m+mi}{15}\PY{p}{)}
\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{20}\PY{p}{,} \PY{n}{labelpad}\PY{o}{=}\PY{l+m+mi}{20}\PY{p}{)}

\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mean, Max, Min Request Durations and Request Load by Week (3 mo.)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{loc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{center}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{25}\PY{p}{)}

\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xticks}\PY{p}{(}\PY{n}{request\PYZus{}stats\PYZus{}3\PYZus{}mo\PYZus{}wk}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xticklabels}\PY{p}{(}\PY{n}{request\PYZus{}stats\PYZus{}3\PYZus{}mo\PYZus{}wk}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Week\PYZus{}Label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{rotation}\PY{o}{=}\PY{l+m+mi}{45}\PY{p}{)}
\PY{n}{ax}\PY{o}{.}\PY{n}{tick\PYZus{}params}\PY{p}{(}\PY{n}{axis}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{which}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{major}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{labelsize}\PY{o}{=}\PY{l+m+mi}{20}\PY{p}{)}

\PY{n}{fig}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{(}\PY{n}{ax}\PY{o}{.}\PY{n}{lines}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{ax}\PY{o}{.}\PY{n}{lines}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{ax}\PY{o}{.}\PY{n}{lines}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,} \PY{n}{ax}\PY{o}{.}\PY{n}{lines}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Max}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Min}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Load/Count}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,} \PY{n}{borderpad}\PY{o}{=}\PY{l+m+mf}{0.8}\PY{p}{,} \PY{n}{labelspacing}\PY{o}{=}\PY{l+m+mf}{0.8}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{18}\PY{p}{,} \PY{n}{shadow}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\PY{c+c1}{\PYZsh{} ax.get\PYZus{}legend().set\PYZus{}visible(False)}

\PY{k}{if} \PY{p}{(}\PY{n}{clear\PYZus{}df\PYZus{}from\PYZus{}mem\PYZus{}3\PYZus{}1\PYZus{}2}\PY{p}{)}\PY{p}{:}
    \PY{k}{del} \PY{n}{request\PYZus{}stats\PYZus{}3\PYZus{}mo\PYZus{}wk}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{datacell_request_time_final_files/datacell_request_time_final_119_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \paragraph{3.2 - Comparison of individual weekly stats, over 3
months}\label{comparison-of-individual-weekly-stats-over-3-months}

    Data prep:

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{253}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{prep\PYZus{}longform\PYZus{}weekly\PYZus{}data\PYZus{}3\PYZus{}2}\PY{p}{(}\PY{n}{start\PYZus{}month}\PY{p}{:} \PY{n+nb}{int}\PY{p}{,} \PY{n}{end\PYZus{}month}\PY{p}{:} \PY{n+nb}{int}\PY{p}{,} \PY{n}{year}\PY{p}{:} \PY{n+nb}{int}\PY{p}{,} \PY{n}{exclude\PYZus{}weekends}\PY{p}{:} \PY{n+nb}{bool}\PY{p}{)} \PY{o}{\PYZhy{}}\PY{o}{\PYZgt{}} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{:}
    
    \PY{n}{base\PYZus{}data\PYZus{}agged\PYZus{}wk} \PY{o}{=} \PY{n}{prep\PYZus{}weekly\PYZus{}data\PYZus{}3\PYZus{}1}\PY{p}{(}\PY{n}{start\PYZus{}month}\PY{p}{,} \PY{n}{end\PYZus{}month}\PY{p}{,} \PY{n}{year}\PY{p}{,} \PY{n}{exclude\PYZus{}weekends}\PY{p}{)}
    
    \PY{c+c1}{\PYZsh{} Create a long\PYZhy{}form/unpivoted version of dur\PYZus{}stats\PYZus{}3\PYZus{}mon\PYZus{}by\PYZus{}wk that can be used with Seaborn\PYZsq{}s swarmplot:}
    \PY{n}{df\PYZus{}3\PYZus{}2} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{melt}\PY{p}{(}\PY{n}{base\PYZus{}data\PYZus{}agged\PYZus{}wk}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{id\PYZus{}vars}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{value\PYZus{}vars}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Min\PYZus{}Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Max\PYZus{}Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mean\PYZus{}Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Count\PYZus{}Durations}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{var\PYZus{}name}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Dur\PYZus{}Stat\PYZus{}Type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{value\PYZus{}name}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Dur\PYZus{}Stat\PYZus{}Value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{df\PYZus{}3\PYZus{}2} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{merge}\PY{p}{(}\PY{n}{df\PYZus{}3\PYZus{}2}\PY{p}{,} \PY{n}{base\PYZus{}data\PYZus{}agged\PYZus{}wk}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Week\PYZus{}Label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{n}{how}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{left}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{on}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{c+c1}{\PYZsh{} longform\PYZus{}dur\PYZus{}stats\PYZus{}3\PYZus{}mon\PYZus{}by\PYZus{}wk.drop(axis=1, columns=[\PYZsq{}Min\PYZus{}Duration\PYZsq{}, \PYZsq{}Max\PYZus{}Duration\PYZsq{}, \PYZsq{}Mean\PYZus{}Duration\PYZsq{}, \PYZsq{}Count\PYZus{}Durations\PYZsq{}, \PYZsq{}Year\PYZsq{}, \PYZsq{}Month\PYZsq{}, \PYZsq{}Day\PYZsq{}], inplace=True)}
    
        \PY{c+c1}{\PYZsh{} Convert date columns to integers so that a) they take up less space and b) so that they work with \PYZdq{}place\PYZus{}month\PYZus{}names\PYZus{}on\PYZus{}axes()\PYZdq{}}
    \PY{n}{df\PYZus{}3\PYZus{}2}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]} \PY{o}{=} \PY{n}{df\PYZus{}3\PYZus{}2}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{int16}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    
    \PY{k}{return} \PY{n}{df\PYZus{}3\PYZus{}2}
\end{Verbatim}
\end{tcolorbox}

    \textbf{Load/reload data:}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{254}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} RUN THIS CELL TO RESET DATA:}
\PY{n}{lf\PYZus{}request\PYZus{}stats\PYZus{}3\PYZus{}mo\PYZus{}wk} \PY{o}{=} \PY{n}{prep\PYZus{}longform\PYZus{}weekly\PYZus{}data\PYZus{}3\PYZus{}2}\PY{p}{(}
    \PY{n}{start\PYZus{}month}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,}
    \PY{n}{end\PYZus{}month}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,}
    \PY{n}{year}\PY{o}{=}\PY{l+m+mi}{2019}\PY{p}{,}
    \PY{n}{exclude\PYZus{}weekends}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    View the DataFrame that will be plotted:

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{347}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{lf\PYZus{}request\PYZus{}stats\PYZus{}3\PYZus{}mo\PYZus{}wk}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{347}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
   Week Dur\_Stat\_Type  Dur\_Stat\_Value          Week\_Label
0     1  Min\_Duration             0.0    2019/1 days: 1-4
1     2  Min\_Duration             0.0   2019/1 days: 7-11
2     3  Min\_Duration             0.0  2019/1 days: 14-18
3     4  Min\_Duration             0.0  2019/1 days: 21-25
4     5  Min\_Duration             0.0   2019/1 days: 1-31
\end{Verbatim}
\end{tcolorbox}
        
    \subparagraph{3.2.1 - Swarmplot of WEEKLY mean, max and min req.
durations and req. load, 3 months of
data}\label{swarmplot-of-weekly-mean-max-and-min-req.-durations-and-req.-load-3-months-of-data}

    \textbf{Alter figure definitions:}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{255}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{marker\PYZus{}size\PYZus{}3\PYZus{}2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{14}

\PY{n}{mean\PYZus{}line\PYZus{}color\PYZus{}3\PYZus{}2\PYZus{}1} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}4d85bd}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{max\PYZus{}line\PYZus{}color\PYZus{}3\PYZus{}2\PYZus{}1} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}cb6318}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{min\PYZus{}line\PYZus{}color\PYZus{}3\PYZus{}2\PYZus{}1} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}f5e356}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{count\PYZus{}line\PYZus{}color\PYZus{}3\PYZus{}2\PYZus{}1} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}7caa2d}\PY{l+s+s1}{\PYZsq{}}

\PY{c+c1}{\PYZsh{} Set this to True if you would like the DataFrame to be deleted from memory after the figure is rendered:}
\PY{n}{clear\PYZus{}df\PYZus{}from\PYZus{}mem\PYZus{}3\PYZus{}2\PYZus{}1} \PY{o}{=} \PY{k+kc}{False}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{348}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{sns}\PY{o}{.}\PY{n}{set\PYZus{}style}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{darkgrid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{n}{fig}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{16}\PY{p}{,}\PY{l+m+mi}{9}\PY{p}{)}\PY{p}{)}

\PY{c+c1}{\PYZsh{} Good color schemes: https://www.schemecolor.com/bond\PYZhy{}unknown.php, https://www.canva.com/learn/100\PYZhy{}color\PYZhy{}combinations/ number 23}

\PY{n}{colors} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{color\PYZus{}palette}\PY{p}{(}\PY{p}{(}\PY{n}{min\PYZus{}line\PYZus{}color\PYZus{}3\PYZus{}2\PYZus{}1}\PY{p}{,} \PY{n}{max\PYZus{}line\PYZus{}color\PYZus{}3\PYZus{}2\PYZus{}1}\PY{p}{,} \PY{n}{mean\PYZus{}line\PYZus{}color\PYZus{}3\PYZus{}2\PYZus{}1}\PY{p}{,} \PY{n}{count\PYZus{}line\PYZus{}color\PYZus{}3\PYZus{}2\PYZus{}1}\PY{p}{)}\PY{p}{)}  \PY{c+c1}{\PYZsh{} MIN, MAX, MEAN, COUNT}

\PY{c+c1}{\PYZsh{} This graph can be plotted with x=\PYZsq{}Week\PYZsq{} because there are 3 entries for each week (as there should be),}
\PY{c+c1}{\PYZsh{} one for each dur. stat type, so we want 3 observations for each week...}
\PY{n}{sns}\PY{o}{.}\PY{n}{swarmplot}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{y}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Dur\PYZus{}Stat\PYZus{}Value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{hue}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Dur\PYZus{}Stat\PYZus{}Type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{data}\PY{o}{=}\PY{n}{lf\PYZus{}request\PYZus{}stats\PYZus{}3\PYZus{}mo\PYZus{}wk}\PY{p}{,} \PY{n}{dodge}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{edgecolor}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{linewidth}\PY{o}{=}\PY{o}{.}\PY{l+m+mi}{4}\PY{p}{,} \PY{n}{palette}\PY{o}{=}\PY{n}{colors}\PY{p}{,} \PY{n}{s}\PY{o}{=}\PY{n}{marker\PYZus{}size\PYZus{}3\PYZus{}2\PYZus{}1}\PY{p}{,} \PY{n}{ax}\PY{o}{=}\PY{n}{ax}\PY{p}{)}
\PY{c+c1}{\PYZsh{} sns.regplot(x=\PYZsq{}Week\PYZsq{}, y=\PYZsq{}Mean\PYZus{}Duration\PYZsq{}, data=dur\PYZus{}stats\PYZus{}3\PYZus{}mo\PYZus{}wk, color=\PYZsq{}\PYZsh{}4d85bd\PYZsq{}, scatter\PYZus{}kws=\PYZob{}\PYZsq{}s\PYZsq{}: 0\PYZcb{}, ax=ax)}

\PY{n}{fig}\PY{o}{.}\PY{n}{subplots\PYZus{}adjust}\PY{p}{(}\PY{n}{top}\PY{o}{=}\PY{l+m+mf}{0.94}\PY{p}{)}

\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}yscale}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{symlog}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}  \PY{c+c1}{\PYZsh{} Retain zero values}
\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}ylim}\PY{p}{(}\PY{n}{bottom}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.25}\PY{p}{)}

\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Request Duration Stats}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{20}\PY{p}{,} \PY{n}{labelpad}\PY{o}{=}\PY{l+m+mi}{15}\PY{p}{)}
\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{20}\PY{p}{,} \PY{n}{labelpad}\PY{o}{=}\PY{l+m+mi}{19}\PY{p}{)}
\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Min, Max, Mean, and Count of Request Durations by Week (3 mo.)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{loc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{center}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{23}\PY{p}{)}

\PY{n}{ax}\PY{o}{.}\PY{n}{tick\PYZus{}params}\PY{p}{(}\PY{n}{axis}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{which}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{major}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{labelsize}\PY{o}{=}\PY{l+m+mi}{15}\PY{p}{)}
\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xticklabels}\PY{p}{(}\PY{n}{lf\PYZus{}request\PYZus{}stats\PYZus{}3\PYZus{}mo\PYZus{}wk}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Week\PYZus{}Label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{rotation}\PY{o}{=}\PY{l+m+mi}{45}\PY{p}{)}

\PY{n}{fig}\PY{o}{.}\PY{n}{subplots\PYZus{}adjust}\PY{p}{(}\PY{n}{top}\PY{o}{=}\PY{l+m+mf}{0.76}\PY{p}{,} \PY{n}{bottom}\PY{o}{=}\PY{l+m+mf}{0.1}\PY{p}{,} \PY{n}{left}\PY{o}{=}\PY{l+m+mf}{0.125}\PY{p}{,} \PY{n}{right}\PY{o}{=}\PY{l+m+mf}{0.9}\PY{p}{,} \PY{n}{hspace}\PY{o}{=}\PY{l+m+mf}{0.2}\PY{p}{,} \PY{n}{wspace}\PY{o}{=}\PY{l+m+mf}{0.2}\PY{p}{)} \PY{c+c1}{\PYZsh{} This is magic code...}
\PY{n}{fig}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{borderpad}\PY{o}{=}\PY{l+m+mf}{0.8}\PY{p}{,} \PY{n}{labelspacing}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{15}\PY{p}{,} \PY{n}{shadow}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{markerscale}\PY{o}{=}\PY{l+m+mf}{1.5}\PY{p}{)}
\PY{n}{ax}\PY{o}{.}\PY{n}{get\PYZus{}legend}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{set\PYZus{}visible}\PY{p}{(}\PY{k+kc}{False}\PY{p}{)}

\PY{k}{if} \PY{p}{(}\PY{n}{clear\PYZus{}df\PYZus{}from\PYZus{}mem\PYZus{}3\PYZus{}2\PYZus{}1}\PY{p}{)}\PY{p}{:}
    \PY{k}{del} \PY{n}{lf\PYZus{}request\PYZus{}stats\PYZus{}3\PYZus{}mo\PYZus{}wk}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{datacell_request_time_final_files/datacell_request_time_final_130_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \paragraph{3.3 - DAILY stats over 3
months}\label{daily-stats-over-3-months}

    \emph{Developer NOTE:} Fine-tuning done... TO DO: -Apply month-naming
function and add Axes titles.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{320}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{prep\PYZus{}daily\PYZus{}data\PYZus{}3\PYZus{}3}\PY{p}{(}\PY{n}{start\PYZus{}month}\PY{p}{:} \PY{n+nb}{int}\PY{p}{,} \PY{n}{end\PYZus{}month}\PY{p}{:} \PY{n+nb}{int}\PY{p}{,} \PY{n}{year}\PY{p}{:} \PY{n+nb}{int}\PY{p}{,} \PY{n}{exclude\PYZus{}weekends}\PY{p}{:} \PY{n+nb}{bool}\PY{p}{)} \PY{o}{\PYZhy{}}\PY{o}{\PYZgt{}} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{:}
    
    \PY{n}{base\PYZus{}data\PYZus{}3\PYZus{}mo} \PY{o}{=} \PY{n}{prep\PYZus{}base\PYZus{}data\PYZus{}3}\PY{p}{(}\PY{n}{start\PYZus{}month}\PY{p}{,} \PY{n}{end\PYZus{}month}\PY{p}{,} \PY{n}{year}\PY{p}{,} \PY{n}{exclude\PYZus{}weekends}\PY{p}{)}
    
    \PY{c+c1}{\PYZsh{} Aggregate \PYZsq{}Duration\PYZsq{} for min, max, count:}
    \PY{n}{df\PYZus{}3\PYZus{}3} \PY{o}{=} \PY{n}{base\PYZus{}data\PYZus{}3\PYZus{}mo}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{n}{pd}\PY{o}{.}\PY{n}{Grouper}\PY{p}{(}\PY{n}{freq}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{D}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{agg}\PY{p}{(}
    \PY{n}{Min\PYZus{}Duration}\PY{o}{=}\PY{n}{pd}\PY{o}{.}\PY{n}{NamedAgg}\PY{p}{(}\PY{n}{column}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{aggfunc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{min}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
    \PY{n}{Max\PYZus{}Duration}\PY{o}{=}\PY{n}{pd}\PY{o}{.}\PY{n}{NamedAgg}\PY{p}{(}\PY{n}{column}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{aggfunc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
    \PY{n}{Mean\PYZus{}Duration}\PY{o}{=}\PY{n}{pd}\PY{o}{.}\PY{n}{NamedAgg}\PY{p}{(}\PY{n}{column}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{aggfunc}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{)}\PY{p}{,}
    \PY{n}{Count\PYZus{}Durations}\PY{o}{=}\PY{n}{pd}\PY{o}{.}\PY{n}{NamedAgg}\PY{p}{(}\PY{n}{column}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{aggfunc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{count}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
    \PY{n}{Day}\PY{o}{=}\PY{n}{pd}\PY{o}{.}\PY{n}{NamedAgg}\PY{p}{(}\PY{n}{column}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{aggfunc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
    \PY{n}{Month}\PY{o}{=}\PY{n}{pd}\PY{o}{.}\PY{n}{NamedAgg}\PY{p}{(}\PY{n}{column}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{aggfunc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
    \PY{n}{Year}\PY{o}{=}\PY{n}{pd}\PY{o}{.}\PY{n}{NamedAgg}\PY{p}{(}\PY{n}{column}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{aggfunc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{p}{)}
    
    \PY{n}{df\PYZus{}3\PYZus{}3}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
    
    \PY{c+c1}{\PYZsh{} Convert date columns to integers so that a) they take up less space and b) so that they work with \PYZdq{}place\PYZus{}month\PYZus{}names\PYZus{}on\PYZus{}axes()\PYZdq{}}
    \PY{n}{df\PYZus{}3\PYZus{}3}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]} \PY{o}{=} \PY{n}{df\PYZus{}3\PYZus{}3}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{int16}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    
    \PY{c+c1}{\PYZsh{} Add a \PYZdq{}Day\PYZus{}Label\PYZdq{} column that can be used as a label for the plot, describing the month day of the datapoint:}
    \PY{n}{df\PYZus{}3\PYZus{}3}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Day\PYZus{}Label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df\PYZus{}3\PYZus{}3}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{str}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n}{df\PYZus{}3\PYZus{}3}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{str}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n}{df\PYZus{}3\PYZus{}3}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{str}\PY{p}{)}

    \PY{n}{df\PYZus{}3\PYZus{}3}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{n}{by}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
    
    \PY{n}{df\PYZus{}3\PYZus{}3}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
    
\PY{c+c1}{\PYZsh{}     day = df\PYZus{}3\PYZus{}3[\PYZsq{}Day\PYZsq{}]}
\PY{c+c1}{\PYZsh{}     new\PYZus{}index = [index for index, val in enumerate(day)]}
\PY{c+c1}{\PYZsh{}     new\PYZus{}index\PYZus{}days = [val for index, val in enumerate(day)]}
    
    \PY{k}{return} \PY{n}{df\PYZus{}3\PYZus{}3}
\end{Verbatim}
\end{tcolorbox}

    \textbf{Load or reload data:}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{321}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} RUN THIS CELL TO RESET DATA:}
\PY{n}{daily\PYZus{}request\PYZus{}stats\PYZus{}3\PYZus{}mo} \PY{o}{=} \PY{n}{prep\PYZus{}daily\PYZus{}data\PYZus{}3\PYZus{}3}\PY{p}{(}
    \PY{n}{start\PYZus{}month}\PY{o}{=}\PY{l+m+mi}{6}\PY{p}{,}
    \PY{n}{end\PYZus{}month}\PY{o}{=}\PY{l+m+mi}{8}\PY{p}{,}
    \PY{n}{year}\PY{o}{=}\PY{l+m+mi}{2019}\PY{p}{,}
    \PY{n}{exclude\PYZus{}weekends}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \emph{Developer NOTE:} Was writing this to debug the problem with there
being gaps in the mean estimator range on the lineplot for plot 3.3.1:

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{318}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{day} \PY{o}{=} \PY{n}{daily\PYZus{}request\PYZus{}stats\PYZus{}3\PYZus{}mo}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\PY{n}{new\PYZus{}index} \PY{o}{=} \PY{p}{[}\PY{n}{index} \PY{k}{for} \PY{n}{index}\PY{p}{,} \PY{n}{val} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{day}\PY{p}{)}\PY{p}{]}
\PY{n}{vals} \PY{o}{=} \PY{p}{[}\PY{n}{val} \PY{k}{for} \PY{n}{index}\PY{p}{,} \PY{n}{val} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{day}\PY{p}{)}\PY{p}{]}
\PY{c+c1}{\PYZsh{} new\PYZus{}index\PYZus{}dict = \PYZob{}\PYZsq{}New\PYZus{}Index\PYZsq{}: new\PYZus{}index, \PYZsq{}Day\PYZsq{}: vals\PYZcb{}  \PYZsh{} Wrote this to possibly merge back into the dataframe..}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{new\PYZus{}index\PYZus{}dict}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
\{'New\_Index': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18,
19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38,
39, 40, 41, 42, 43, 44], 'Day': [3, 4, 5, 6, 7, 10, 11, 12, 13, 14, 17, 18, 19,
20, 21, 24, 25, 26, 27, 28, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 15, 16, 17, 18, 19,
22, 23, 24, 25, 26, 29, 30, 31, 1, 2]\}
    \end{Verbatim}

    View the DataFrame that will be plotted:

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{293}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{daily\PYZus{}request\PYZus{}stats\PYZus{}3\PYZus{}mo}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{293}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
   Min\_Duration  Max\_Duration  Mean\_Duration  Count\_Durations  Day  Month  \textbackslash{}
0           0.0         160.0       1.706644             4094    3      6
1           0.0         160.0       1.706644             4094    3      6
2           0.0         179.0       1.377971             2188    3      7
3           0.0         179.0       1.377971             2188    3      7
4           0.0         214.0       1.479659             6686    4      6

   Year Day\_Label  New\_Index
0  2019  2019/6/3          0
1  2019  2019/6/3         22
2  2019  2019/7/3          0
3  2019  2019/7/3         22
4  2019  2019/6/4          1
\end{Verbatim}
\end{tcolorbox}
        
    \subparagraph{3.3.1 - Daily stats over 3-months, in single
plot}\label{daily-stats-over-3-months-in-single-plot}

    \emph{Developer NOTE:} This graph was producing some strange output
where it would show a standard deviation from the mean but only for
discrete ranges of x-values, then the std. dev graphic would not show
up, then show again depending on the x-value. I figured out that because
I was plotting the 'Day' column on the x-axis, it was plotting each
unique DAY value, irrespective of what month/year that day was in. So
instead, I reindexed the DataFrame so that there was a unique integer
for each observation, then used this index as the x-value for the plot.
This also fixed the problem I had with the Day\_Label not matching the
the day, for obvious reasons. The graph was just bucketing every
observation on day "3", for example, into one x-point, which is why we
had standard devs. only sometimes.

    \textbf{Alter figure definitions:}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{262}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} marker\PYZus{}size\PYZus{}3\PYZus{}3\PYZus{}1 = 150}

\PY{n}{mean\PYZus{}line\PYZus{}color\PYZus{}3\PYZus{}3\PYZus{}1} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}FBBC05}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{max\PYZus{}line\PYZus{}color\PYZus{}3\PYZus{}3\PYZus{}1} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}EA4335}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{min\PYZus{}line\PYZus{}color\PYZus{}3\PYZus{}3\PYZus{}1} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}34A853}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{count\PYZus{}line\PYZus{}color\PYZus{}3\PYZus{}3\PYZus{}1} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}4285F4}\PY{l+s+s1}{\PYZsq{}}

\PY{c+c1}{\PYZsh{} Set this to True if you would like the DataFrame to be deleted from memory after the figure is rendered:}
\PY{n}{clear\PYZus{}df\PYZus{}from\PYZus{}mem\PYZus{}3\PYZus{}3\PYZus{}1} \PY{o}{=} \PY{k+kc}{False}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{340}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{from} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{ticker} \PY{k+kn}{import} \PY{n}{IndexFormatter}\PY{p}{,} \PY{n}{MultipleLocator}

\PY{n}{fig}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{15}\PY{p}{,}\PY{l+m+mi}{9}\PY{p}{)}\PY{p}{)}

\PY{n}{sns}\PY{o}{.}\PY{n}{lineplot}\PY{p}{(}\PY{n}{data}\PY{o}{=}\PY{n}{daily\PYZus{}request\PYZus{}stats\PYZus{}3\PYZus{}mo}\PY{p}{,} \PY{n}{x}\PY{o}{=}\PY{n}{daily\PYZus{}request\PYZus{}stats\PYZus{}3\PYZus{}mo}\PY{o}{.}\PY{n}{index}\PY{p}{,} \PY{n}{y}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mean\PYZus{}Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{estimator}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{n}{mean\PYZus{}line\PYZus{}color\PYZus{}3\PYZus{}3\PYZus{}1}\PY{p}{,} \PY{n}{ax}\PY{o}{=}\PY{n}{ax}\PY{p}{)}
\PY{n}{sns}\PY{o}{.}\PY{n}{lineplot}\PY{p}{(}\PY{n}{data}\PY{o}{=}\PY{n}{daily\PYZus{}request\PYZus{}stats\PYZus{}3\PYZus{}mo}\PY{p}{,} \PY{n}{x}\PY{o}{=}\PY{n}{daily\PYZus{}request\PYZus{}stats\PYZus{}3\PYZus{}mo}\PY{o}{.}\PY{n}{index}\PY{p}{,} \PY{n}{y}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Max\PYZus{}Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{estimator}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{n}{max\PYZus{}line\PYZus{}color\PYZus{}3\PYZus{}3\PYZus{}1}\PY{p}{,} \PY{n}{ax}\PY{o}{=}\PY{n}{ax}\PY{p}{)}
\PY{n}{sns}\PY{o}{.}\PY{n}{lineplot}\PY{p}{(}\PY{n}{data}\PY{o}{=}\PY{n}{daily\PYZus{}request\PYZus{}stats\PYZus{}3\PYZus{}mo}\PY{p}{,} \PY{n}{x}\PY{o}{=}\PY{n}{daily\PYZus{}request\PYZus{}stats\PYZus{}3\PYZus{}mo}\PY{o}{.}\PY{n}{index}\PY{p}{,} \PY{n}{y}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Min\PYZus{}Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{estimator}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{n}{min\PYZus{}line\PYZus{}color\PYZus{}3\PYZus{}3\PYZus{}1}\PY{p}{,} \PY{n}{ax}\PY{o}{=}\PY{n}{ax}\PY{p}{)}
\PY{n}{sns}\PY{o}{.}\PY{n}{lineplot}\PY{p}{(}\PY{n}{data}\PY{o}{=}\PY{n}{daily\PYZus{}request\PYZus{}stats\PYZus{}3\PYZus{}mo}\PY{p}{,} \PY{n}{x}\PY{o}{=}\PY{n}{daily\PYZus{}request\PYZus{}stats\PYZus{}3\PYZus{}mo}\PY{o}{.}\PY{n}{index}\PY{p}{,} \PY{n}{y}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Count\PYZus{}Durations}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{estimator}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{n}{count\PYZus{}line\PYZus{}color\PYZus{}3\PYZus{}3\PYZus{}1}\PY{p}{,} \PY{n}{ax}\PY{o}{=}\PY{n}{ax}\PY{p}{)}

\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Request Stats}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{20}\PY{p}{,} \PY{n}{labelpad}\PY{o}{=}\PY{l+m+mi}{15}\PY{p}{)}
\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{20}\PY{p}{,} \PY{n}{labelpad}\PY{o}{=}\PY{l+m+mi}{15}\PY{p}{)}

\PY{n}{ax}\PY{o}{.}\PY{n}{set}\PY{p}{(}\PY{n}{yscale}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{symlog}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}  \PY{c+c1}{\PYZsh{} Retain zero values}
\PY{c+c1}{\PYZsh{} ax.set\PYZus{}ylim(bottom=\PYZhy{}0.25)  \PYZsh{} 0 doesn\PYZsq{}t work... }

\PY{c+c1}{\PYZsh{} grid.set\PYZus{}titles(fontsize=200)}

\PY{c+c1}{\PYZsh{} grid.set\PYZus{}xticklabels(\PYZsq{}\PYZsq{})}

\PY{n}{fig}\PY{o}{.}\PY{n}{subplots\PYZus{}adjust}\PY{p}{(}\PY{n}{top}\PY{o}{=}\PY{l+m+mf}{0.8}\PY{p}{,} \PY{n}{left}\PY{o}{=}\PY{l+m+mf}{0.125}\PY{p}{,} \PY{n}{right}\PY{o}{=}\PY{l+m+mf}{0.997}\PY{p}{,} \PY{n}{hspace}\PY{o}{=}\PY{l+m+mf}{0.2}\PY{p}{)}  \PY{c+c1}{\PYZsh{} These are magic numbers, do not adjust.}
\PY{n}{fig}\PY{o}{.}\PY{n}{suptitle}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Daily Max, Min, Mean of Request Durations and Request Load (3 mo.)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{20}\PY{p}{)}

\PY{n}{fig}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{handles}\PY{o}{=}\PY{p}{(}\PY{n}{ax}\PY{o}{.}\PY{n}{lines}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{,} \PY{n}{ax}\PY{o}{.}\PY{n}{lines}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,} \PY{n}{ax}\PY{o}{.}\PY{n}{lines}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{ax}\PY{o}{.}\PY{n}{lines}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n}{labels}\PY{o}{=}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Request Load/Count}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Min Req. Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Max Req. Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mean Req. Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,} \PY{n}{borderpad}\PY{o}{=}\PY{l+m+mf}{0.8}\PY{p}{,} \PY{n}{labelspacing}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{15}\PY{p}{,} \PY{n}{loc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{upper right}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{} grid.axes[i].tick\PYZus{}params(axis=\PYZsq{}both\PYZsq{}, which=\PYZsq{}major\PYZsq{}, labelsize=15)}

\PY{c+c1}{\PYZsh{} day = daily\PYZus{}request\PYZus{}stats\PYZus{}3\PYZus{}mo[\PYZsq{}Day\PYZsq{}]}
\PY{c+c1}{\PYZsh{} new\PYZus{}index = [index for index, val in enumerate(day)]}
\PY{c+c1}{\PYZsh{} vals = [val for index, val in enumerate(day)]}
\PY{c+c1}{\PYZsh{} new\PYZus{}index\PYZus{}dict = \PYZob{}\PYZsq{}New\PYZus{}Index\PYZsq{}: new\PYZus{}index, \PYZsq{}Day\PYZsq{}: vals\PYZcb{}}
\PY{c+c1}{\PYZsh{} print(new\PYZus{}index)}

\PY{c+c1}{\PYZsh{} new\PYZus{}index\PYZus{}df = pd.DataFrame(new\PYZus{}index\PYZus{}dict)}

\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xticks}\PY{p}{(}\PY{n}{daily\PYZus{}request\PYZus{}stats\PYZus{}3\PYZus{}mo}\PY{o}{.}\PY{n}{index}\PY{p}{)}
\PY{c+c1}{\PYZsh{} ax.set\PYZus{}xticklabels(daily\PYZus{}request\PYZus{}stats\PYZus{}3\PYZus{}mo[\PYZsq{}Day\PYZus{}Label\PYZsq{}])}
\PY{n}{ax}\PY{o}{.}\PY{n}{xaxis}\PY{o}{.}\PY{n}{set\PYZus{}major\PYZus{}locator}\PY{p}{(}\PY{n}{MultipleLocator}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}  \PY{c+c1}{\PYZsh{} This sets the labels the display for every other day}
\PY{c+c1}{\PYZsh{} ax.xaxis.set\PYZus{}minor\PYZus{}locator(MultipleLocator(2))}
\PY{n}{ax}\PY{o}{.}\PY{n}{xaxis}\PY{o}{.}\PY{n}{set\PYZus{}major\PYZus{}formatter}\PY{p}{(}\PY{n}{IndexFormatter}\PY{p}{(}\PY{n}{daily\PYZus{}request\PYZus{}stats\PYZus{}3\PYZus{}mo}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Day\PYZus{}Label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}

\PY{n}{ax}\PY{o}{.}\PY{n}{tick\PYZus{}params}\PY{p}{(}\PY{n}{axis}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{x}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{labelsize}\PY{o}{=}\PY{l+m+mi}{18}\PY{p}{,} \PY{n}{rotation}\PY{o}{=}\PY{l+m+mi}{45}\PY{p}{)}
\PY{n}{ax}\PY{o}{.}\PY{n}{tick\PYZus{}params}\PY{p}{(}\PY{n}{axis}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{y}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{labelsize}\PY{o}{=}\PY{l+m+mi}{18}\PY{p}{)}

\PY{k}{if} \PY{p}{(}\PY{n}{clear\PYZus{}df\PYZus{}from\PYZus{}mem\PYZus{}3\PYZus{}3\PYZus{}1}\PY{p}{)}\PY{p}{:}
    \PY{k}{del} \PY{n}{daily\PYZus{}request\PYZus{}stats\PYZus{}3\PYZus{}mo}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{datacell_request_time_final_files/datacell_request_time_final_144_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subparagraph{3.3.2 - Daily stats over 3 months, with plot for each
month}\label{daily-stats-over-3-months-with-plot-for-each-month}

    \textbf{Alter figure definitions:}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{152}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} marker\PYZus{}size\PYZus{}3\PYZus{}3\PYZus{}2 = 150}

\PY{n}{mean\PYZus{}line\PYZus{}color\PYZus{}3\PYZus{}3\PYZus{}2} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}F7941D}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{max\PYZus{}line\PYZus{}color\PYZus{}3\PYZus{}3\PYZus{}2} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}DE3354}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{min\PYZus{}line\PYZus{}color\PYZus{}3\PYZus{}3\PYZus{}2} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}36B449}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{count\PYZus{}line\PYZus{}color\PYZus{}3\PYZus{}3\PYZus{}2} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}135A8E}\PY{l+s+s1}{\PYZsq{}}

\PY{c+c1}{\PYZsh{} Set this to True if you would like the DataFrame to be deleted from memory after the figure is rendered:}
\PY{n}{clear\PYZus{}df\PYZus{}from\PYZus{}mem\PYZus{}3\PYZus{}3\PYZus{}2} \PY{o}{=} \PY{k+kc}{False}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{341}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{grid} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{FacetGrid}\PY{p}{(}\PY{n}{row}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{data}\PY{o}{=}\PY{n}{daily\PYZus{}request\PYZus{}stats\PYZus{}3\PYZus{}mo}\PY{p}{,} \PY{n}{height}\PY{o}{=}\PY{l+m+mf}{3.4}\PY{p}{,} \PY{n}{aspect}\PY{o}{=}\PY{l+m+mf}{3.8}\PY{p}{,} \PY{n}{legend\PYZus{}out}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}

\PY{c+c1}{\PYZsh{} The only reason using \PYZsq{}Day\PYZsq{} isn\PYZsq{}t a problem here is that we are breaking the graph up into subplots for}
\PY{c+c1}{\PYZsh{} each month:}
\PY{n}{grid}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{n}{sns}\PY{o}{.}\PY{n}{lineplot}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mean\PYZus{}Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{n}{mean\PYZus{}line\PYZus{}color\PYZus{}3\PYZus{}3\PYZus{}2}\PY{p}{)}
\PY{n}{grid}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{n}{sns}\PY{o}{.}\PY{n}{lineplot}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Max\PYZus{}Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{n}{max\PYZus{}line\PYZus{}color\PYZus{}3\PYZus{}3\PYZus{}2}\PY{p}{)}
\PY{n}{grid}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{n}{sns}\PY{o}{.}\PY{n}{lineplot}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Min\PYZus{}Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{n}{min\PYZus{}line\PYZus{}color\PYZus{}3\PYZus{}3\PYZus{}2}\PY{p}{)}
\PY{n}{grid}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{n}{sns}\PY{o}{.}\PY{n}{lineplot}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Count\PYZus{}Durations}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{n}{count\PYZus{}line\PYZus{}color\PYZus{}3\PYZus{}3\PYZus{}2}\PY{p}{)}

\PY{n}{axes} \PY{o}{=} \PY{n}{grid}\PY{o}{.}\PY{n}{axes}\PY{o}{.}\PY{n}{flatten}\PY{p}{(}\PY{p}{)}

\PY{n}{grid}\PY{o}{.}\PY{n}{set\PYZus{}ylabels}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Request Data}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{15}\PY{p}{,} \PY{n}{labelpad}\PY{o}{=}\PY{l+m+mi}{15}\PY{p}{)}
\PY{n}{grid}\PY{o}{.}\PY{n}{set\PYZus{}xlabels}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{15}\PY{p}{,} \PY{n}{labelpad}\PY{o}{=}\PY{l+m+mi}{15}\PY{p}{)}

\PY{n}{place\PYZus{}month\PYZus{}names\PYZus{}on\PYZus{}axes}\PY{p}{(}\PY{n}{is\PYZus{}single\PYZus{}axes}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,} \PY{n}{axes\PYZus{}arr}\PY{o}{=}\PY{n}{axes}\PY{p}{,} \PY{n}{loc\PYZus{}str}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{left}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{font\PYZus{}size}\PY{o}{=}\PY{l+m+mi}{17}\PY{p}{)}

\PY{n}{grid}\PY{o}{.}\PY{n}{set}\PY{p}{(}\PY{n}{yscale}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{symlog}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}  \PY{c+c1}{\PYZsh{} Retain zero values}
\PY{c+c1}{\PYZsh{} ax.set\PYZus{}ylim(bottom=\PYZhy{}0.25)  \PYZsh{} 0 doesn\PYZsq{}t work... }

\PY{n}{grid}\PY{o}{.}\PY{n}{set\PYZus{}titles}\PY{p}{(}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{200}\PY{p}{)}

\PY{c+c1}{\PYZsh{} grid.set\PYZus{}xticklabels(\PYZsq{}\PYZsq{})}

\PY{n}{grid}\PY{o}{.}\PY{n}{fig}\PY{o}{.}\PY{n}{subplots\PYZus{}adjust}\PY{p}{(}\PY{n}{top}\PY{o}{=}\PY{l+m+mf}{0.85}\PY{p}{,} \PY{n}{left}\PY{o}{=}\PY{l+m+mf}{0.125}\PY{p}{,} \PY{n}{right}\PY{o}{=}\PY{l+m+mf}{0.997}\PY{p}{,} \PY{n}{hspace}\PY{o}{=}\PY{l+m+mf}{0.2}\PY{p}{)}  \PY{c+c1}{\PYZsh{} These are magic numbers, do not adjust.}
\PY{n}{grid}\PY{o}{.}\PY{n}{fig}\PY{o}{.}\PY{n}{suptitle}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Daily Max, Min and Mean of Req. Durations and Req. Load (3 mo.)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{20}\PY{p}{)}

\PY{n}{grid}\PY{o}{.}\PY{n}{fig}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{handles}\PY{o}{=}\PY{p}{(}\PY{n}{axes}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{lines}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{,} \PY{n}{axes}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{lines}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,} \PY{n}{axes}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{lines}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{axes}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{lines}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n}{labels}\PY{o}{=}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Request Load/Count}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Min Req. Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Max Req. Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mean Req. Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,} \PY{n}{borderpad}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{labelspacing}\PY{o}{=}\PY{l+m+mf}{0.8}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{13}\PY{p}{,} \PY{n}{loc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{upper right}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{} grid.axes[i].tick\PYZus{}params(axis=\PYZsq{}both\PYZsq{}, which=\PYZsq{}major\PYZsq{}, labelsize=15)}
\PY{c+c1}{\PYZsh{} ax.set\PYZus{}xticklabels(longform\PYZus{}dur\PYZus{}stats\PYZus{}3\PYZus{}mon\PYZus{}by\PYZus{}day[\PYZsq{}Day\PYZus{}Label\PYZsq{}])}

\PY{c+c1}{\PYZsh{} Settings that need to be applied to each axis:}
\PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{axes}\PY{p}{)}\PY{p}{)}\PY{p}{:}
    \PY{n}{axes}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{.}\PY{n}{tick\PYZus{}params}\PY{p}{(}\PY{n}{axis}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{which}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{major}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{labelsize}\PY{o}{=}\PY{l+m+mi}{14}\PY{p}{)}

\PY{c+c1}{\PYZsh{} Last call:}
\PY{c+c1}{\PYZsh{} grid.fig.tight\PYZus{}layout()}

\PY{c+c1}{\PYZsh{} ax.legend(borderpad=1, labelspacing=1, fontsize=18)}

\PY{k}{if} \PY{p}{(}\PY{n}{clear\PYZus{}df\PYZus{}from\PYZus{}mem\PYZus{}3\PYZus{}3\PYZus{}2}\PY{p}{)}\PY{p}{:}
    \PY{k}{del} \PY{n}{daily\PYZus{}request\PYZus{}stats\PYZus{}3\PYZus{}mo}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{datacell_request_time_final_files/datacell_request_time_final_148_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsection{4. Find relationships between min/max/mean/count of request
durations per day with a
"correlogram"}\label{find-relationships-between-minmaxmeancount-of-request-durations-per-day-with-a-correlogram}

    \emph{Developer NOTE:} Add a function that pulls the data which allows
the user to filter data IF WANTED (make a default that pulls all
historical data?).

    \emph{Developer NOTE:} Drop excess fields we don't need here:

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{85}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} Basis DataFrame:}
\PY{n}{dur\PYZus{}stats\PYZus{}only\PYZus{}3\PYZus{}mo\PYZus{}day} \PY{o}{=} \PY{n}{dur\PYZus{}stats\PYZus{}3\PYZus{}mo\PYZus{}day}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\PY{n}{dur\PYZus{}stats\PYZus{}only\PYZus{}3\PYZus{}mo\PYZus{}day}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{85}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
     Min\_Duration  Mean\_Duration  Count\_Durations  Max\_Duration
Day
2.0           0.0       0.264368             2088           9.0
3.0           0.0       0.330986             1136          40.0
4.0           0.0       0.252212              452           1.0
5.0           0.0       0.232639              288           1.0
6.0           0.0       0.252078              361           1.0
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} longform\PYZus{}dur\PYZus{}stats\PYZus{}3\PYZus{}mon\PYZus{}day = pd.melt(dur\PYZus{}stats\PYZus{}3\PYZus{}mon\PYZus{}by\PYZus{}day.reset\PYZus{}index(), value\PYZus{}vars=[\PYZsq{}Min\PYZus{}Duration\PYZsq{}, \PYZsq{}Max\PYZus{}Duration\PYZsq{}, \PYZsq{}Mean\PYZus{}Duration\PYZsq{}, \PYZsq{}Count\PYZus{}Durations\PYZsq{}], var\PYZus{}name=\PYZsq{}Dur\PYZus{}Stat\PYZus{}Type\PYZsq{}, value\PYZus{}name=\PYZsq{}Dur\PYZus{}Stat\PYZus{}Value\PYZsq{})}
\PY{c+c1}{\PYZsh{} longform\PYZus{}dur\PYZus{}stats\PYZus{}3\PYZus{}mon\PYZus{}day.dropna(inplace=True)}
\PY{c+c1}{\PYZsh{} longform\PYZus{}dur\PYZus{}stats\PYZus{}3\PYZus{}mon\PYZus{}day.head(2)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{89}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{sns}\PY{o}{.}\PY{n}{pairplot}\PY{p}{(}\PY{n}{data}\PY{o}{=}\PY{n}{dur\PYZus{}stats\PYZus{}only\PYZus{}3\PYZus{}mo\PYZus{}day}\PY{p}{,} \PY{n}{palette}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{husl}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{89}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
<seaborn.axisgrid.PairGrid at 0x13df8e90>
\end{Verbatim}
\end{tcolorbox}
        
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{datacell_request_time_final_files/datacell_request_time_final_154_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsection{5. Total health history}\label{total-health-history}

    \paragraph{5.1 - Total health history stats by
month}\label{total-health-history-stats-by-month}

    \emph{Developer NOTE:} This section is under construction. The goal is
to aggregate -all- the historical data by month in SQL then make a
figure with a subplot/Axes for each year, showing all historical stats
per month over the databases history.

Separate year and month from being in the same column in the DF...

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{179}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{sql} \PY{o}{=} \PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SELECT }\PY{l+s+s1}{\PYZsq{}}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ MAX(YEAR([StartTimeStamp]))}\PY{l+s+s1}{\PYZsq{}}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ ,MONTH(StartTimeStamp) as Month}\PY{l+s+s1}{\PYZsq{}}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ ,COUNT(datediff(second, [StartTimeStamp], [EndTimeStamp])) as Count\PYZus{}Durations}\PY{l+s+s1}{\PYZsq{}}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ ,MAX(datediff(second, [StartTimeStamp], [EndTimeStamp])) as Max\PYZus{}Duration}\PY{l+s+s1}{\PYZsq{}}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ ,MIN(datediff(second, [StartTimeStamp], [EndTimeStamp])) as Min\PYZus{}Duration}\PY{l+s+s1}{\PYZsq{}}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ ,AVG(datediff(second, [StartTimeStamp], [EndTimeStamp])) as Mean\PYZus{}Duration}\PY{l+s+s1}{\PYZsq{}}
        \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ FROM [test].[Request]}\PY{l+s+s1}{\PYZsq{}}
        \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ WHERE [StartTimeStamp] \PYZlt{} [EndTimeStamp]}\PY{l+s+s1}{\PYZsq{}}
        \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ GROUP BY MONTH(StartTimeStamp), YEAR(StartTimeStamp)}\PY{l+s+s1}{\PYZsq{}}
        \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ UNION ALL}\PY{l+s+s1}{\PYZsq{}}
        \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ SELECT}\PY{l+s+s1}{\PYZsq{}}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ MAX(YEAR([StartTimeStamp]))}\PY{l+s+s1}{\PYZsq{}}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ ,MONTH(StartTimeStamp) as Month}\PY{l+s+s1}{\PYZsq{}}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ ,COUNT(datediff(second, [StartTimeStamp], [EndTimeStamp])) as Count\PYZus{}Durations}\PY{l+s+s1}{\PYZsq{}}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ ,MAX(datediff(second, [StartTimeStamp], [EndTimeStamp])) as Max\PYZus{}Duration}\PY{l+s+s1}{\PYZsq{}}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ ,MIN(datediff(second, [StartTimeStamp], [EndTimeStamp])) as Min\PYZus{}Duration}\PY{l+s+s1}{\PYZsq{}}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ ,AVG(datediff(second, [StartTimeStamp], [EndTimeStamp])) as Mean\PYZus{}Duration}\PY{l+s+s1}{\PYZsq{}}
        \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ FROM [test].[Request\PYZus{}History]}\PY{l+s+s1}{\PYZsq{}}
        \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ WHERE [StartTimeStamp] \PYZlt{} [EndTimeStamp]}\PY{l+s+s1}{\PYZsq{}}
        \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ GROUP BY MONTH(StartTimeStamp), YEAR(StartTimeStamp)}\PY{l+s+s1}{\PYZsq{}}
    \PY{p}{)}

\PY{n}{monthly\PYZus{}requests\PYZus{}hist} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}sql}\PY{p}{(}\PY{n}{sql}\PY{p}{,} \PY{n}{reporting\PYZus{}conn}\PY{p}{,} \PY{n}{index\PYZus{}col}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{monthly\PYZus{}requests\PYZus{}hist}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\PY{n}{monthly\PYZus{}requests\PYZus{}hist}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{n}{by}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{180}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{monthly\PYZus{}requests\PYZus{}hist}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{180}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
    Month        Count\_Durations  Max\_Duration  Min\_Duration  Mean\_Duration
39      1  2017            72662           387             0              2
28      1  2015            14698           400             0              4
27      1  2018            91809           560             0              2
72      1  2019            96776           581             0              1
69      1  2016            40380           438             0              2
..    {\ldots}   {\ldots}              {\ldots}           {\ldots}           {\ldots}            {\ldots}
12     12  2013             5065           202             0             10
65     12  2017            66244           501             0              2
23     12  2014             9120           624             0              6
53     12  2018            71129           332             0              1
50     12  2015            30787           306             0              2

[74 rows x 6 columns]
\end{Verbatim}
\end{tcolorbox}
        
    \emph{Developer NOTE:} Below is code that does something similar, but in
pandas. It will probably not be used. Running this currently may cause
memory errors.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{164}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{prep\PYZus{}monthly\PYZus{}data\PYZus{}5\PYZus{}1}\PY{p}{(}\PY{n}{exclude\PYZus{}weekends}\PY{p}{:} \PY{n+nb}{bool}\PY{p}{)} \PY{o}{\PYZhy{}}\PY{o}{\PYZgt{}} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{:}
    
    \PY{n}{base\PYZus{}data\PYZus{}hist\PYZus{}w\PYZus{}dates} \PY{o}{=} \PY{n}{get\PYZus{}df\PYZus{}requests\PYZus{}with\PYZus{}date\PYZus{}cols\PYZus{}from\PYZus{}db}\PY{p}{(}\PY{l+m+mi}{2015}\PY{p}{,}\PY{l+m+mi}{2019}\PY{p}{)}
    
    \PY{k}{if} \PY{p}{(}\PY{n}{exclude\PYZus{}weekends}\PY{p}{)}\PY{p}{:}
        \PY{n}{get\PYZus{}df\PYZus{}no\PYZus{}weekends}\PY{p}{(}\PY{n}{base\PYZus{}data\PYZus{}hist\PYZus{}w\PYZus{}dates}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Weekday}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    
    \PY{c+c1}{\PYZsh{} Aggregate Duration for min, max and count over each week (using named aggregation, which drops all non\PYZhy{}aggregated, non\PYZhy{}index cols):}
    \PY{n}{month\PYZus{}aggs} \PY{o}{=} \PY{n}{base\PYZus{}data\PYZus{}hist\PYZus{}w\PYZus{}dates}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{n}{pd}\PY{o}{.}\PY{n}{Grouper}\PY{p}{(}\PY{n}{freq}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{agg}\PY{p}{(}
    \PY{n}{Min\PYZus{}Duration}\PY{o}{=}\PY{n}{pd}\PY{o}{.}\PY{n}{NamedAgg}\PY{p}{(}\PY{n}{column}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{aggfunc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{min}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
    \PY{n}{Max\PYZus{}Duration}\PY{o}{=}\PY{n}{pd}\PY{o}{.}\PY{n}{NamedAgg}\PY{p}{(}\PY{n}{column}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{aggfunc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
    \PY{n}{Mean\PYZus{}Duration}\PY{o}{=}\PY{n}{pd}\PY{o}{.}\PY{n}{NamedAgg}\PY{p}{(}\PY{n}{column}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{aggfunc}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{)}\PY{p}{,}
    \PY{n}{Count\PYZus{}Durations}\PY{o}{=}\PY{n}{pd}\PY{o}{.}\PY{n}{NamedAgg}\PY{p}{(}\PY{n}{column}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{aggfunc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{count}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
    \PY{n}{First\PYZus{}Day}\PY{o}{=}\PY{n}{pd}\PY{o}{.}\PY{n}{NamedAgg}\PY{p}{(}\PY{n}{column}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{aggfunc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{min}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
    \PY{n}{Last\PYZus{}Day}\PY{o}{=}\PY{n}{pd}\PY{o}{.}\PY{n}{NamedAgg}\PY{p}{(}\PY{n}{column}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{aggfunc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
    \PY{n}{Month}\PY{o}{=}\PY{n}{pd}\PY{o}{.}\PY{n}{NamedAgg}\PY{p}{(}\PY{n}{column}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{aggfunc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
    \PY{n}{Year}\PY{o}{=}\PY{n}{pd}\PY{o}{.}\PY{n}{NamedAgg}\PY{p}{(}\PY{n}{column}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{aggfunc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{c+c1}{\PYZsh{}     Weekday=pd.NamedAgg(column=\PYZsq{}Duration\PYZsq{}, aggfunc=np.first)}
    \PY{p}{)}
    \PY{n}{month\PYZus{}aggs}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
    
    \PY{c+c1}{\PYZsh{} Add the Month\PYZus{}Label for labeling the plot:}
    \PY{n}{month\PYZus{}aggs}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Month\PYZus{}Label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{month\PYZus{}aggs}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{int}\PY{p}{)}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{str}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n}{month\PYZus{}aggs}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{int}\PY{p}{)}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{str}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{days: }\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n}{month\PYZus{}aggs}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{First\PYZus{}Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{int}\PY{p}{)}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{str}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n}{month\PYZus{}aggs}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Last\PYZus{}Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{int}\PY{p}{)}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{str}\PY{p}{)}
    \PY{c+c1}{\PYZsh{}     month\PYZus{}aggs\PYZus{}historical[\PYZsq{}Year\PYZsq{}] = month\PYZus{}aggs\PYZus{}historical[\PYZsq{}Year\PYZsq{}].astype(str)[:4]}
    \PY{c+c1}{\PYZsh{} Drop columns that we only needed temporarily, to create the Week\PYZus{}Label above:}
    \PY{n}{month\PYZus{}aggs}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{First\PYZus{}Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Last\PYZus{}Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
    
    \PY{k}{return} \PY{n}{month\PYZus{}aggs}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} Bring in the data:}
\PY{n}{month\PYZus{}aggs\PYZus{}historical} \PY{o}{=} \PY{n}{prep\PYZus{}monthly\PYZus{}data\PYZus{}5\PYZus{}1}\PY{p}{(}
    \PY{n}{exclude\PYZus{}weekends}\PY{o}{=}\PY{k+kc}{True}
\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{month\PYZus{}aggs\PYZus{}historical}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \subparagraph{5.1.1 - Plot of all historical stats aggregated MONTHLY,
with subplots/Axes for each year, all
data}\label{plot-of-all-historical-stats-aggregated-monthly-with-subplotsaxes-for-each-year-all-data}

    \emph{Developer NOTE:} This code will be used with the data loaded
directly from SQL above, once bugs are fixed...

    \textbf{Figure definitions:}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{61}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{marker\PYZus{}size\PYZus{}5\PYZus{}1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{100}

\PY{n}{mean\PYZus{}line\PYZus{}color\PYZus{}5\PYZus{}1\PYZus{}1} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}ffaa00}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{min\PYZus{}line\PYZus{}color\PYZus{}5\PYZus{}1\PYZus{}1} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}54b536}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{max\PYZus{}line\PYZus{}color\PYZus{}5\PYZus{}1\PYZus{}1} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}bb311b}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{count\PYZus{}line\PYZus{}color\PYZus{}5\PYZus{}1\PYZus{}1} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}69c7ff}\PY{l+s+s1}{\PYZsq{}}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{mon\PYZus{}hist\PYZus{}grid} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{FacetGrid}\PY{p}{(}\PY{n}{row}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{data}\PY{o}{=}\PY{n}{monthly\PYZus{}requests\PYZus{}hist}\PY{p}{,} \PY{n}{height}\PY{o}{=}\PY{l+m+mf}{3.6}\PY{p}{,} \PY{n}{aspect}\PY{o}{=}\PY{l+m+mf}{3.7}\PY{p}{,} \PY{n}{legend\PYZus{}out}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}

\PY{n}{mon\PYZus{}hist\PYZus{}grid}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{n}{sns}\PY{o}{.}\PY{n}{lineplot}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mean\PYZus{}Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{n}{mean\PYZus{}line\PYZus{}color\PYZus{}5\PYZus{}1\PYZus{}1}\PY{p}{,} \PY{n}{estimator}\PY{o}{=}\PY{k+kc}{None}\PY{p}{)}
\PY{n}{mon\PYZus{}hist\PYZus{}grid}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{n}{sns}\PY{o}{.}\PY{n}{scatterplot}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mean\PYZus{}Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{n}{mean\PYZus{}line\PYZus{}color\PYZus{}5\PYZus{}1\PYZus{}1}\PY{p}{,} \PY{n}{s}\PY{o}{=}\PY{n}{marker\PYZus{}size\PYZus{}5\PYZus{}1\PYZus{}1}\PY{p}{)}

\PY{n}{mon\PYZus{}hist\PYZus{}grid}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{n}{sns}\PY{o}{.}\PY{n}{lineplot}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Min\PYZus{}Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{n}{min\PYZus{}line\PYZus{}color\PYZus{}5\PYZus{}1\PYZus{}1}\PY{p}{,} \PY{n}{estimator}\PY{o}{=}\PY{k+kc}{None}\PY{p}{)}
\PY{n}{mon\PYZus{}hist\PYZus{}grid}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{n}{sns}\PY{o}{.}\PY{n}{scatterplot}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Min\PYZus{}Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{n}{min\PYZus{}line\PYZus{}color\PYZus{}5\PYZus{}1\PYZus{}1}\PY{p}{,} \PY{n}{s}\PY{o}{=}\PY{n}{marker\PYZus{}size\PYZus{}5\PYZus{}1\PYZus{}1}\PY{p}{)}

\PY{n}{mon\PYZus{}hist\PYZus{}grid}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{n}{sns}\PY{o}{.}\PY{n}{lineplot}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Max\PYZus{}Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{n}{max\PYZus{}line\PYZus{}color\PYZus{}5\PYZus{}1\PYZus{}1}\PY{p}{,} \PY{n}{estimator}\PY{o}{=}\PY{k+kc}{None}\PY{p}{)}
\PY{n}{mon\PYZus{}hist\PYZus{}grid}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{n}{sns}\PY{o}{.}\PY{n}{scatterplot}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Max\PYZus{}Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{n}{max\PYZus{}line\PYZus{}color\PYZus{}5\PYZus{}1\PYZus{}1}\PY{p}{,} \PY{n}{s}\PY{o}{=}\PY{n}{marker\PYZus{}size\PYZus{}5\PYZus{}1\PYZus{}1}\PY{p}{)}

\PY{n}{mon\PYZus{}hist\PYZus{}grid}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{n}{sns}\PY{o}{.}\PY{n}{lineplot}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Count\PYZus{}Durations}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{n}{count\PYZus{}line\PYZus{}color\PYZus{}5\PYZus{}1\PYZus{}1}\PY{p}{,} \PY{n}{estimator}\PY{o}{=}\PY{k+kc}{None}\PY{p}{)}
\PY{n}{mon\PYZus{}hist\PYZus{}grid}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{n}{sns}\PY{o}{.}\PY{n}{scatterplot}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Count\PYZus{}Durations}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{n}{count\PYZus{}line\PYZus{}color\PYZus{}5\PYZus{}1\PYZus{}1}\PY{p}{,} \PY{n}{s}\PY{o}{=}\PY{n}{marker\PYZus{}size\PYZus{}5\PYZus{}1\PYZus{}1}\PY{p}{)}

\PY{n}{axes} \PY{o}{=} \PY{n}{mon\PYZus{}hist\PYZus{}grid}\PY{o}{.}\PY{n}{axes}\PY{o}{.}\PY{n}{flatten}\PY{p}{(}\PY{p}{)}

\PY{n}{mon\PYZus{}hist\PYZus{}grid}\PY{o}{.}\PY{n}{set\PYZus{}ylabels}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Request Duration Stats}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{15}\PY{p}{,} \PY{n}{labelpad}\PY{o}{=}\PY{l+m+mi}{15}\PY{p}{)}
\PY{n}{mon\PYZus{}hist\PYZus{}grid}\PY{o}{.}\PY{n}{set\PYZus{}xlabels}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{15}\PY{p}{,} \PY{n}{labelpad}\PY{o}{=}\PY{l+m+mi}{15}\PY{p}{)}

\PY{n}{set\PYZus{}year\PYZus{}name\PYZus{}axes\PYZus{}titles}\PY{p}{(}\PY{n}{axes}\PY{p}{,} \PY{n}{monthly\PYZus{}requests\PYZus{}hist}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{left}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Weekday}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{n}{mon\PYZus{}hist\PYZus{}grid}\PY{o}{.}\PY{n}{set}\PY{p}{(}\PY{n}{yscale}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{symlog}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}  \PY{c+c1}{\PYZsh{} Retain zero values}

\PY{n}{mon\PYZus{}hist\PYZus{}grid}\PY{o}{.}\PY{n}{set\PYZus{}titles}\PY{p}{(}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{200}\PY{p}{)}

\PY{c+c1}{\PYZsh{} grid.set\PYZus{}xticklabels(\PYZsq{}\PYZsq{})}

\PY{n}{mon\PYZus{}hist\PYZus{}grid}\PY{o}{.}\PY{n}{fig}\PY{o}{.}\PY{n}{subplots\PYZus{}adjust}\PY{p}{(}\PY{n}{top}\PY{o}{=}\PY{l+m+mf}{0.8}\PY{p}{,} \PY{n}{left}\PY{o}{=}\PY{l+m+mf}{0.125}\PY{p}{,} \PY{n}{right}\PY{o}{=}\PY{l+m+mf}{0.997}\PY{p}{,} \PY{n}{hspace}\PY{o}{=}\PY{l+m+mf}{0.2}\PY{p}{)}  \PY{c+c1}{\PYZsh{} These are magic numbers, do not adjust.}
\PY{n}{mon\PYZus{}hist\PYZus{}grid}\PY{o}{.}\PY{n}{fig}\PY{o}{.}\PY{n}{suptitle}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mean, Min, Max and Count of Request Durations by Month (to\PYZhy{}Date)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{20}\PY{p}{)}

\PY{n}{mon\PYZus{}hist\PYZus{}grid}\PY{o}{.}\PY{n}{fig}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{handles}\PY{o}{=}\PY{p}{(}\PY{n}{axes}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{lines}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{,} \PY{n}{axes}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{lines}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,} \PY{n}{axes}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{lines}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{axes}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{lines}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n}{labels}\PY{o}{=}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Request Load/Count}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Max Req. Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Min Req. Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mean Req. Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,} \PY{n}{borderpad}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{labelspacing}\PY{o}{=}\PY{l+m+mf}{0.8}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{13}\PY{p}{,} \PY{n}{loc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{upper right}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{} grid.axes[i].tick\PYZus{}params(axis=\PYZsq{}both\PYZsq{}, which=\PYZsq{}major\PYZsq{}, labelsize=15)}

\PY{c+c1}{\PYZsh{} Settings that need to be applied to each axis:}
\PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{axes}\PY{p}{)}\PY{p}{)}\PY{p}{:}
    \PY{n}{axes}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}xticklabels}\PY{p}{(}\PY{n}{monthly\PYZus{}requests\PYZus{}hist}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Month\PYZus{}Label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{rotation}\PY{o}{=}\PY{l+m+mi}{45}\PY{p}{)}
    \PY{n}{axes}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{.}\PY{n}{tick\PYZus{}params}\PY{p}{(}\PY{n}{axis}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{which}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{major}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{labelsize}\PY{o}{=}\PY{l+m+mi}{14}\PY{p}{)}
    \PY{n}{axes}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}ylim}\PY{p}{(}\PY{n}{bottom}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.5}\PY{p}{)}  \PY{c+c1}{\PYZsh{} 0 doesn\PYZsq{}t work... }
\end{Verbatim}
\end{tcolorbox}

    \paragraph{5.2 - Total health history stats by
week}\label{total-health-history-stats-by-week}

    \emph{Developer NOTE:} The following code was also done using all
historical data in a pandas DF, so it will not be used as it takes a ton
of memory.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{25}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import} \PY{n+nn}{seaborn} \PY{k}{as} \PY{n+nn}{sns}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{182}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{prep\PYZus{}weekly\PYZus{}data\PYZus{}5\PYZus{}2}\PY{p}{(}\PY{n}{exclude\PYZus{}weekends}\PY{p}{:} \PY{n+nb}{bool}\PY{p}{)} \PY{o}{\PYZhy{}}\PY{o}{\PYZgt{}} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{:}
    
    \PY{n}{base\PYZus{}data\PYZus{}hist\PYZus{}w\PYZus{}dates} \PY{o}{=} \PY{n}{get\PYZus{}df\PYZus{}requests\PYZus{}with\PYZus{}date\PYZus{}cols\PYZus{}from\PYZus{}db}\PY{p}{(}\PY{l+m+mi}{2015}\PY{p}{,}\PY{l+m+mi}{2019}\PY{p}{)}
    
    \PY{k}{if} \PY{p}{(}\PY{n}{exclude\PYZus{}weekends}\PY{p}{)}\PY{p}{:}
        \PY{n}{weekday\PYZus{}filter} \PY{o}{=} \PY{p}{(} \PY{p}{(}\PY{n}{base\PYZus{}data\PYZus{}hist\PYZus{}w\PYZus{}dates}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Weekday}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{!=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Saturday}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{o}{\PYZam{}} \PY{p}{(}\PY{n}{base\PYZus{}data\PYZus{}hist\PYZus{}w\PYZus{}dates}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Weekday}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{!=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sunday}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{p}{)}
        \PY{n}{base\PYZus{}data\PYZus{}hist\PYZus{}w\PYZus{}dates}\PY{o}{.}\PY{n}{where}\PY{p}{(}\PY{n}{weekday\PYZus{}filter}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
        \PY{n}{base\PYZus{}data\PYZus{}hist\PYZus{}w\PYZus{}dates}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
    
    \PY{c+c1}{\PYZsh{} Aggregate Duration for min, max and count over each week (using named aggregation, which drops all non\PYZhy{}aggregated, non\PYZhy{}index cols):}
    \PY{n}{week\PYZus{}aggs} \PY{o}{=} \PY{n}{base\PYZus{}data\PYZus{}hist\PYZus{}w\PYZus{}dates}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{n}{pd}\PY{o}{.}\PY{n}{Grouper}\PY{p}{(}\PY{n}{freq}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{W}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{agg}\PY{p}{(}
    \PY{n}{Min\PYZus{}Duration}\PY{o}{=}\PY{n}{pd}\PY{o}{.}\PY{n}{NamedAgg}\PY{p}{(}\PY{n}{column}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{aggfunc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{min}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
    \PY{n}{Max\PYZus{}Duration}\PY{o}{=}\PY{n}{pd}\PY{o}{.}\PY{n}{NamedAgg}\PY{p}{(}\PY{n}{column}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{aggfunc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
    \PY{n}{Mean\PYZus{}Duration}\PY{o}{=}\PY{n}{pd}\PY{o}{.}\PY{n}{NamedAgg}\PY{p}{(}\PY{n}{column}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{aggfunc}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{)}\PY{p}{,}
    \PY{n}{Count\PYZus{}Durations}\PY{o}{=}\PY{n}{pd}\PY{o}{.}\PY{n}{NamedAgg}\PY{p}{(}\PY{n}{column}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{aggfunc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{count}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
    \PY{n}{First\PYZus{}Day}\PY{o}{=}\PY{n}{pd}\PY{o}{.}\PY{n}{NamedAgg}\PY{p}{(}\PY{n}{column}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{aggfunc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{min}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
    \PY{n}{Last\PYZus{}Day}\PY{o}{=}\PY{n}{pd}\PY{o}{.}\PY{n}{NamedAgg}\PY{p}{(}\PY{n}{column}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{aggfunc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
    \PY{n}{Week}\PY{o}{=}\PY{n}{pd}\PY{o}{.}\PY{n}{NamedAgg}\PY{p}{(}\PY{n}{column}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{aggfunc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
    \PY{n}{Month}\PY{o}{=}\PY{n}{pd}\PY{o}{.}\PY{n}{NamedAgg}\PY{p}{(}\PY{n}{column}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{aggfunc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
    \PY{n}{Year}\PY{o}{=}\PY{n}{pd}\PY{o}{.}\PY{n}{NamedAgg}\PY{p}{(}\PY{n}{column}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{aggfunc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{c+c1}{\PYZsh{}     Weekday=pd.NamedAgg(column=\PYZsq{}Duration\PYZsq{}, aggfunc=np.first)}
    \PY{p}{)}
    \PY{n}{week\PYZus{}aggs}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
    
    \PY{c+c1}{\PYZsh{} Add the Month\PYZus{}Label for labeling the plot:}
    \PY{n}{week\PYZus{}aggs}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Week\PYZus{}Label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{week\PYZus{}aggs}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{int}\PY{p}{)}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{str}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n}{week\PYZus{}aggs}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{int}\PY{p}{)}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{str}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{days: }\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n}{week\PYZus{}aggs}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{First\PYZus{}Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{int}\PY{p}{)}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{str}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n}{week\PYZus{}aggs}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Last\PYZus{}Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{int}\PY{p}{)}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{str}\PY{p}{)}
    \PY{c+c1}{\PYZsh{}     month\PYZus{}aggs\PYZus{}historical[\PYZsq{}Year\PYZsq{}] = month\PYZus{}aggs\PYZus{}historical[\PYZsq{}Year\PYZsq{}].astype(str)[:4]}
    \PY{c+c1}{\PYZsh{} Drop columns that we only needed temporarily, to create the Week\PYZus{}Label above:}
    \PY{n}{week\PYZus{}aggs}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{First\PYZus{}Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Last\PYZus{}Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
    
    \PY{k}{return} \PY{n}{week\PYZus{}aggs}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} RUN THIS CELL TO RESET DATA:}
\PY{n}{wk\PYZus{}aggs\PYZus{}historical} \PY{o}{=} \PY{n}{prep\PYZus{}weekly\PYZus{}data\PYZus{}5\PYZus{}2}\PY{p}{(}
    \PY{n}{exclude\PYZus{}weekends}\PY{o}{=}\PY{k+kc}{True}
\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{42}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{wk\PYZus{}aggs\PYZus{}historical}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{42}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
                Min\_Duration  Max\_Duration  Mean\_Duration  Count\_Durations  \textbackslash{}
StartTimeStamp
2015-01-25               0.0           4.0       0.625000               32
2015-02-01               0.0          46.0       0.388060             1474
2015-02-08               0.0          40.0       0.277457             4325
2015-02-15               0.0          23.0       0.433790              438
2015-03-01              23.0          23.0      23.000000                1

                Week  Month    Year           Week\_Label
StartTimeStamp
2015-01-25       4.0    1.0  2015.0  2015/1\textbackslash{}ndays: 19-22
2015-02-01       5.0    1.0  2015.0  2015/1\textbackslash{}ndays: 26-30
2015-02-08       6.0    2.0  2015.0    2015/2\textbackslash{}ndays: 2-6
2015-02-15       7.0    2.0  2015.0   2015/2\textbackslash{}ndays: 9-11
2015-03-01       9.0    2.0  2015.0  2015/2\textbackslash{}ndays: 23-23
\end{Verbatim}
\end{tcolorbox}
        
    \subparagraph{5.2.1 - Plot of weekly stats,
historical}\label{plot-of-weekly-stats-historical}

    DO NOT RUN the figure source code below if you want to keep the figure.
The gives a picture of what we might want to do with the data in SQL to
make a similar visualization of historical data by week, but the current
code is buggy.

    \textbf{Plot definitions:}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{57}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{marker\PYZus{}size\PYZus{}5\PYZus{}2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{60}

\PY{n}{mean\PYZus{}line\PYZus{}color\PYZus{}5\PYZus{}2\PYZus{}1} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}ffaa00}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{min\PYZus{}line\PYZus{}color\PYZus{}5\PYZus{}2\PYZus{}1} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}54b536}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{max\PYZus{}line\PYZus{}color\PYZus{}5\PYZus{}2\PYZus{}1} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}bb311b}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{count\PYZus{}line\PYZus{}color\PYZus{}5\PYZus{}2\PYZus{}1} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}69c7ff}\PY{l+s+s1}{\PYZsq{}}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{60}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{sns}\PY{o}{.}\PY{n}{set}\PY{p}{(}\PY{n}{style}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{darkgrid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{n}{wk\PYZus{}hist\PYZus{}grid} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{FacetGrid}\PY{p}{(}\PY{n}{row}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{data}\PY{o}{=}\PY{n}{wk\PYZus{}aggs\PYZus{}historical}\PY{p}{,} \PY{n}{height}\PY{o}{=}\PY{l+m+mi}{4}\PY{p}{,} \PY{n}{aspect}\PY{o}{=}\PY{l+m+mf}{3.3}\PY{p}{,} \PY{n}{legend\PYZus{}out}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}

\PY{n}{wk\PYZus{}hist\PYZus{}grid}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{n}{sns}\PY{o}{.}\PY{n}{lineplot}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mean\PYZus{}Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{n}{mean\PYZus{}line\PYZus{}color\PYZus{}5\PYZus{}2\PYZus{}1}\PY{p}{,} \PY{n}{estimator}\PY{o}{=}\PY{k+kc}{None}\PY{p}{)}
\PY{n}{wk\PYZus{}hist\PYZus{}grid}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{n}{sns}\PY{o}{.}\PY{n}{scatterplot}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mean\PYZus{}Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{n}{mean\PYZus{}line\PYZus{}color\PYZus{}5\PYZus{}2\PYZus{}1}\PY{p}{,} \PY{n}{s}\PY{o}{=}\PY{n}{marker\PYZus{}size\PYZus{}5\PYZus{}2\PYZus{}1}\PY{p}{)}

\PY{n}{wk\PYZus{}hist\PYZus{}grid}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{n}{sns}\PY{o}{.}\PY{n}{lineplot}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Min\PYZus{}Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{n}{min\PYZus{}line\PYZus{}color\PYZus{}5\PYZus{}2\PYZus{}1}\PY{p}{,} \PY{n}{estimator}\PY{o}{=}\PY{k+kc}{None}\PY{p}{)}
\PY{n}{wk\PYZus{}hist\PYZus{}grid}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{n}{sns}\PY{o}{.}\PY{n}{scatterplot}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Min\PYZus{}Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{n}{min\PYZus{}line\PYZus{}color\PYZus{}5\PYZus{}2\PYZus{}1}\PY{p}{,} \PY{n}{s}\PY{o}{=}\PY{n}{marker\PYZus{}size\PYZus{}5\PYZus{}2\PYZus{}1}\PY{p}{)}

\PY{n}{wk\PYZus{}hist\PYZus{}grid}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{n}{sns}\PY{o}{.}\PY{n}{lineplot}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Max\PYZus{}Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{n}{max\PYZus{}line\PYZus{}color\PYZus{}5\PYZus{}2\PYZus{}1}\PY{p}{,} \PY{n}{estimator}\PY{o}{=}\PY{k+kc}{None}\PY{p}{)}
\PY{n}{wk\PYZus{}hist\PYZus{}grid}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{n}{sns}\PY{o}{.}\PY{n}{scatterplot}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Max\PYZus{}Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{n}{max\PYZus{}line\PYZus{}color\PYZus{}5\PYZus{}2\PYZus{}1}\PY{p}{,} \PY{n}{s}\PY{o}{=}\PY{n}{marker\PYZus{}size\PYZus{}5\PYZus{}2\PYZus{}1}\PY{p}{)}

\PY{n}{wk\PYZus{}hist\PYZus{}grid}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{n}{sns}\PY{o}{.}\PY{n}{lineplot}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Count\PYZus{}Durations}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{n}{count\PYZus{}line\PYZus{}color\PYZus{}5\PYZus{}2\PYZus{}1}\PY{p}{,} \PY{n}{estimator}\PY{o}{=}\PY{k+kc}{None}\PY{p}{)}
\PY{n}{wk\PYZus{}hist\PYZus{}grid}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{n}{sns}\PY{o}{.}\PY{n}{scatterplot}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Count\PYZus{}Durations}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{n}{count\PYZus{}line\PYZus{}color\PYZus{}5\PYZus{}2\PYZus{}1}\PY{p}{,} \PY{n}{s}\PY{o}{=}\PY{n}{marker\PYZus{}size\PYZus{}5\PYZus{}2\PYZus{}1}\PY{p}{)}

\PY{n}{axes} \PY{o}{=} \PY{n}{wk\PYZus{}hist\PYZus{}grid}\PY{o}{.}\PY{n}{axes}\PY{o}{.}\PY{n}{flatten}\PY{p}{(}\PY{p}{)}

\PY{n}{wk\PYZus{}hist\PYZus{}grid}\PY{o}{.}\PY{n}{set\PYZus{}ylabels}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Request Duration Stats}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{15}\PY{p}{,} \PY{n}{labelpad}\PY{o}{=}\PY{l+m+mi}{15}\PY{p}{)}
\PY{n}{wk\PYZus{}hist\PYZus{}grid}\PY{o}{.}\PY{n}{set\PYZus{}xlabels}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{15}\PY{p}{,} \PY{n}{labelpad}\PY{o}{=}\PY{l+m+mi}{15}\PY{p}{)}

\PY{n}{set\PYZus{}year\PYZus{}name\PYZus{}axes\PYZus{}titles}\PY{p}{(}\PY{n}{axes}\PY{p}{,} \PY{n}{wk\PYZus{}aggs\PYZus{}historical}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{left}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Weekday}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{n}{wk\PYZus{}hist\PYZus{}grid}\PY{o}{.}\PY{n}{set}\PY{p}{(}\PY{n}{yscale}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{symlog}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}  \PY{c+c1}{\PYZsh{} Retain zero values}

\PY{n}{wk\PYZus{}hist\PYZus{}grid}\PY{o}{.}\PY{n}{set\PYZus{}titles}\PY{p}{(}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{200}\PY{p}{)}

\PY{c+c1}{\PYZsh{} grid.set\PYZus{}xticklabels(\PYZsq{}\PYZsq{})}

\PY{n}{wk\PYZus{}hist\PYZus{}grid}\PY{o}{.}\PY{n}{fig}\PY{o}{.}\PY{n}{subplots\PYZus{}adjust}\PY{p}{(}\PY{n}{top}\PY{o}{=}\PY{l+m+mf}{0.8}\PY{p}{,} \PY{n}{left}\PY{o}{=}\PY{l+m+mf}{0.125}\PY{p}{,} \PY{n}{right}\PY{o}{=}\PY{l+m+mf}{0.997}\PY{p}{,} \PY{n}{hspace}\PY{o}{=}\PY{l+m+mf}{0.2}\PY{p}{)}  \PY{c+c1}{\PYZsh{} These are magic numbers, do not adjust.}
\PY{n}{wk\PYZus{}hist\PYZus{}grid}\PY{o}{.}\PY{n}{fig}\PY{o}{.}\PY{n}{suptitle}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mean, Min, Max and Count of Request Durations by Week (to\PYZhy{}Date)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{20}\PY{p}{)}

\PY{n}{wk\PYZus{}hist\PYZus{}grid}\PY{o}{.}\PY{n}{fig}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{handles}\PY{o}{=}\PY{p}{(}\PY{n}{axes}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{lines}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{,} \PY{n}{axes}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{lines}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,} \PY{n}{axes}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{lines}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{axes}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{lines}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n}{labels}\PY{o}{=}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Request Load/Count}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Max Req. Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Min Req. Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mean Req. Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,} \PY{n}{borderpad}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{labelspacing}\PY{o}{=}\PY{l+m+mf}{0.8}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{13}\PY{p}{,} \PY{n}{loc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{upper right}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{} grid.axes[i].tick\PYZus{}params(axis=\PYZsq{}both\PYZsq{}, which=\PYZsq{}major\PYZsq{}, labelsize=15)}

\PY{c+c1}{\PYZsh{} Settings that need to be applied to each axis:}
\PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{axes}\PY{p}{)}\PY{p}{)}\PY{p}{:}
    \PY{n}{axes}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}xticklabels}\PY{p}{(}\PY{n}{wk\PYZus{}aggs\PYZus{}historical}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Week\PYZus{}Label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{rotation}\PY{o}{=}\PY{l+m+mi}{45}\PY{p}{)}
    \PY{n}{axes}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{.}\PY{n}{tick\PYZus{}params}\PY{p}{(}\PY{n}{axis}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{which}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{major}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{labelsize}\PY{o}{=}\PY{l+m+mi}{14}\PY{p}{)}
    \PY{n}{axes}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}ylim}\PY{p}{(}\PY{n}{bottom}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.5}\PY{p}{)}  \PY{c+c1}{\PYZsh{} 0 doesn\PYZsq{}t work... }
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{datacell_request_time_final_files/datacell_request_time_final_179_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    

    % Add a bibliography block to the postdoc
    
    
    
\end{document}
